{"version":3,"file":"chunk-Db1vM16j.js","sources":["../../../../../node_modules/vike/dist/esm/utils/slice.js","../../../../../node_modules/vike/dist/esm/utils/parseUrl.js","../../../../../node_modules/vike/dist/esm/utils/objectAssign.js","../../../../../node_modules/vike/dist/esm/utils/objectReplace.js","../../../../../node_modules/vike/dist/esm/utils/sorter.js","../../../../../node_modules/vike/dist/esm/utils/isBrowser.js","../../../../../node_modules/vike/dist/esm/utils/isArrayOfStrings.js","../../../../../node_modules/vike/dist/esm/utils/isObjectOfStrings.js","../../../../../node_modules/vike/dist/esm/utils/hasProp.js","../../../../../node_modules/vike/dist/esm/utils/isPlainObject.js","../../../../../node_modules/vike/dist/esm/utils/compareString.js","../../../../../node_modules/vike/dist/esm/utils/isNullish.js","../../../../../node_modules/vike/dist/esm/utils/stringifyStringArray.js","../../../../../node_modules/vike/dist/esm/utils/isPropertyGetter.js","../../../../../node_modules/vike/dist/esm/utils/isPromise.js","../../../../../node_modules/vike/dist/esm/utils/getValuePrintable.js","../../../../../node_modules/vike/dist/esm/utils/escapeRegex.js","../../../../../node_modules/vike/dist/esm/utils/changeEnumerable.js","../../../../../node_modules/vike/dist/esm/utils/objectDefineProperty.js","../../../../../node_modules/vike/dist/esm/utils/isScriptFile.js","../../../../../node_modules/vike/dist/esm/utils/getPropAccessNotation.js","../../../../../node_modules/vike/dist/esm/utils/genPromise.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/getExportPath.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/getConfigDefinedAt.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/getConfigValueTyped.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/getConfigValueRuntime.js","../../../../../node_modules/vike/dist/esm/shared/addIs404ToPageProps.js","../../../../../node_modules/vike/dist/esm/shared/NOT_SERIALIZABLE.js","../../../../../node_modules/vike/dist/esm/shared/getProxyForPublicUsage.js","../../../../../node_modules/vike/dist/esm/shared/prepareGlobalContextForPublicUsage.js","../../../../../node_modules/vike/dist/esm/shared/preparePageContextForPublicUsage.js","../../../../../node_modules/vike/dist/esm/client/shared/normalizeClientSideUrl.js","../../../../../node_modules/vike/dist/esm/client/shared/getCurrentUrl.js","../../../../../node_modules/vike/dist/esm/utils/assertRoutingType.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/onLoad.js","../../../../../node_modules/vike/dist/esm/utils/isReact.js","../../../../../node_modules/vike/dist/esm/utils/redirectHard.js","../../../../../node_modules/vike/dist/esm/utils/sleep.js","../../../../../node_modules/vike/dist/esm/utils/throttle.js","../../../../../node_modules/vike/dist/esm/utils/onPageVisibilityChange.js","../../../../../node_modules/vike/dist/esm/utils/catchInfiniteLoop.js","../../../../../node_modules/vike/dist/esm/utils/deepEqual.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/utils.js","../../../../../node_modules/@brillout/json-serializer/dist/types.js","../../../../../node_modules/@brillout/json-serializer/dist/parse.js","../../../../../node_modules/vike/dist/esm/shared/htmlElementIds.js","../../../../../node_modules/vike/dist/esm/client/shared/getJsonSerializedInHtml.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/getAllPageIdFiles.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageServerSide.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/getPageContext/removeBuiltInOverrides.js","../../../../../node_modules/vike/dist/esm/utils/urlToFile.js","../../../../../node_modules/vike/dist/esm/shared/getPageContextRequestUrl.js","../../../../../node_modules/vike/dist/esm/shared/assertPageContextProvidedByUser.js","../../../../../node_modules/vike/dist/esm/shared/assertHookReturnedObject.js","../../../../../node_modules/vike/dist/esm/shared/assertOnBeforeRenderHookReturn.js","../../../../../node_modules/vike/dist/esm/utils/isObjectWithKeys.js","../../../../../node_modules/vike/dist/esm/utils/joinEnglish.js","../../../../../node_modules/vike/dist/esm/utils/debug.js","../../../../../node_modules/vike/dist/esm/shared/route/utils.js","../../../../../node_modules/vike/dist/esm/shared/route/execHookGuard.js","../../../../../node_modules/vike/dist/esm/shared/route/abort.js","../../../../../node_modules/vike/dist/esm/shared/misc/pageContextInitIsPassedToClient.js","../../../../../node_modules/vike/dist/esm/shared/misc/isServerSideError.js","../../../../../node_modules/vike/dist/esm/client/shared/preparePageContextForPublicUsageClientShared.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/preparePageContextForPublicUsageClient.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/getPageContextFromHooks.js","../../../../../node_modules/vike/dist/esm/shared/createPageContextShared.js","../../../../../node_modules/vike/dist/esm/shared/getPageContextUrlComputed.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/getBaseServer.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/assert_exports_old_design.js","../../../../../node_modules/vike/dist/esm/shared/determinePageIdOld.js","../../../../../node_modules/vike/dist/esm/shared/error-page.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/fileTypes.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/getPageFileObject.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/assertPlusFileExport.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/serialize/parsePageConfigsSerialized.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/parseVirtualFileExportsGlobalEntry.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/resolveVikeConfigPublic.js","../../../../../node_modules/vike/dist/esm/shared/createGlobalContextShared.js","../../../../../node_modules/vike/dist/esm/client/shared/getGlobalContextClientInternalShared.js","../../../../../node_modules/vike/dist/esm/shared/route/deduceRouteStringFromFilesystemPath.js","../../../../../node_modules/vike/dist/esm/shared/route/resolveRouteFunction.js","../../../../../node_modules/vike/dist/esm/shared/route/loadPageRoutes.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/getGlobalContextClientInternal.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/createPageContextClientSide.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/findPageConfig.js","../../../../../node_modules/vike/dist/esm/shared/page-configs/loadAndParseVirtualFilePageEntry.js","../../../../../node_modules/vike/dist/esm/client/shared/loadPageConfigsLazyClientSide.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/skipLink.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageClientSide/getExportNames.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageClientSide/analyzeExports.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageClientSide/determineClientEntry.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageClientSide.js","../../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzeClientSide.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/isClientSideRoutable.js","../../../../../node_modules/vike/dist/esm/shared/route/resolveRouteString.js","../../../../../node_modules/vike/dist/esm/shared/route/resolvePrecedence.js","../../../../../node_modules/vike/dist/esm/shared/route/execHookOnBeforeRoute.js","../../../../../node_modules/vike/dist/esm/shared/route/index.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/getPageContextCurrent.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/prefetch/getPrefetchSettings.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/prefetch.js","../../../../../node_modules/vike/dist/esm/client/shared/execHookOnRenderClient.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/history.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/setScrollPosition.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/scrollRestoration.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/logErrorClient.js","../../../../../node_modules/vike/dist/esm/client/runtime-client-routing/renderPageClientSide.js"],"sourcesContent":["import { assert } from './assert.js';\nexport { slice };\nfunction slice(thing, from, to) {\n    if (typeof thing === 'string') {\n        return sliceArray(thing.split(''), from, to).join('');\n    }\n    else {\n        return sliceArray(thing, from, to);\n    }\n}\nfunction sliceArray(list, from, to) {\n    const listSlice = [];\n    let start = from >= 0 ? from : list.length + from;\n    assert(start >= 0 && start <= list.length);\n    let end = to >= 0 ? to : list.length + to;\n    assert(end >= 0 && end <= list.length);\n    while (true) {\n        if (start === end) {\n            break;\n        }\n        if (start === list.length) {\n            start = 0;\n        }\n        if (start === end) {\n            break;\n        }\n        const el = list[start];\n        assert(el !== undefined);\n        listSlice.push(el);\n        start++;\n    }\n    return listSlice;\n}\n","// We don't use new URL() as it doesn't exactly do what we need, for example:\n//  - It loses the original URL parts (which we need to manipulate and recreate URLs)\n//  - It doesn't support the tauri:// protocol\n// Unit tests at ./parseUrl.spec.ts\nexport { parseUrl };\nexport { assertUsageUrlAbsolute };\nexport { assertUsageUrlPathAbsolute };\nexport { assertUsageUrlRedirectTarget };\nexport { isUrl };\nexport { isUri };\nexport { isUrlRedirectTarget };\nexport { isUrlRelative };\nexport { isUrlExternal };\nexport { isBaseServer };\nexport { assertUrlComponents };\nexport { createUrlFromComponents };\nimport { slice } from './slice.js';\nimport { assert, assertUsage } from './assert.js';\nimport pc from '@brillout/picocolors';\nfunction parseUrl(url, baseServer) {\n    assert(isUrl(url), url);\n    assert(baseServer.startsWith('/'));\n    // Hash\n    const { hashString: hashOriginal, withoutHash: urlWithoutHash } = extractHash(url);\n    assert(hashOriginal === null || hashOriginal.startsWith('#'));\n    const hash = hashOriginal === null ? '' : decodeSafe(hashOriginal.slice(1));\n    // Search\n    const { searchString: searchOriginal, withoutSearch: urlWithoutHashNorSearch } = extractSearch(urlWithoutHash);\n    assert(searchOriginal === null || searchOriginal.startsWith('?'));\n    let searchString = '';\n    if (searchOriginal !== null) {\n        searchString = searchOriginal;\n    }\n    else if (url.startsWith('#')) {\n        const baseURI = getBaseURI();\n        searchString = (baseURI && extractSearch(baseURI).searchString) || '';\n    }\n    const search = {};\n    const searchAll = {};\n    Array.from(new URLSearchParams(searchString)).forEach(([key, val]) => {\n        search[key] = val;\n        searchAll[key] = [...(searchAll.hasOwnProperty(key) ? searchAll[key] : []), val];\n    });\n    // Origin + pathname\n    let { protocol, origin, pathnameAbsoluteWithBase } = getPathnameAbsoluteWithBase(urlWithoutHashNorSearch, baseServer);\n    const pathnameOriginal = urlWithoutHashNorSearch.slice((origin || '').length);\n    assertUrlComponents(url, origin, pathnameOriginal, searchOriginal, hashOriginal);\n    // Base URL\n    let { pathname, isBaseMissing } = removeBaseServer(pathnameAbsoluteWithBase, baseServer);\n    // pageContext.urlParsed.href\n    const href = createUrlFromComponents(origin, pathname, searchOriginal, hashOriginal);\n    // pageContext.urlParsed.{hostname, port}\n    const host = !origin ? null : origin.slice(protocol.length);\n    const { hostname, port } = parseHost(host, url);\n    // decode after setting href\n    pathname = decodePathname(pathname);\n    /* Should it be `pathname` or `pathnameOriginal`? https://github.com/vikejs/vike/pull/2770\n    // pageContext.urlParsed.path\n    const path = pathname + (searchOriginal || '') + (hashOriginal || '')\n    */\n    assert(pathname.startsWith('/'));\n    return {\n        href,\n        protocol,\n        hostname,\n        port,\n        origin,\n        pathname,\n        pathnameOriginal: pathnameOriginal,\n        isBaseMissing,\n        search,\n        searchAll,\n        searchOriginal,\n        hash,\n        hashOriginal,\n    };\n}\nfunction extractHash(url) {\n    const [withoutHash, ...parts] = url.split('#');\n    const hashString = ['', ...parts].join('#') || null;\n    return { hashString, withoutHash: withoutHash };\n}\nfunction extractSearch(url) {\n    const [withoutSearch, ...parts] = url.split('?');\n    const searchString = ['', ...parts].join('?') || null;\n    return { searchString, withoutSearch: withoutSearch };\n}\nfunction decodeSafe(urlComponent) {\n    try {\n        return decodeURIComponent(urlComponent);\n    }\n    catch { }\n    try {\n        return decodeURI(urlComponent);\n    }\n    catch { }\n    return urlComponent;\n}\nfunction decodePathname(urlPathname) {\n    urlPathname = urlPathname.replace(/\\s+$/, '');\n    urlPathname = urlPathname\n        .split('/')\n        .map((dir) => decodeSafe(dir).split('/').join('%2F'))\n        .join('/');\n    return urlPathname;\n}\nfunction getPathnameAbsoluteWithBase(url, baseServer) {\n    // Search and hash already extracted\n    assert(!url.includes('?') && !url.includes('#'));\n    // url has origin\n    {\n        const { protocol, origin, pathname } = parseOrigin(url);\n        if (origin) {\n            return { protocol, origin, pathnameAbsoluteWithBase: pathname };\n        }\n        assert(pathname === url);\n    }\n    // url doesn't have origin\n    if (url.startsWith('/')) {\n        return { protocol: null, origin: null, pathnameAbsoluteWithBase: url };\n    }\n    else {\n        // url is a relative path\n        const baseURI = getBaseURI();\n        let base;\n        if (baseURI) {\n            base = parseOrigin(baseURI.split('?')[0].split('#')[0]).pathname;\n        }\n        else {\n            base = baseServer;\n        }\n        const pathnameAbsoluteWithBase = resolveUrlPathnameRelative(url, base);\n        return { protocol: null, origin: null, pathnameAbsoluteWithBase };\n    }\n}\nfunction getBaseURI() {\n    // In the browser, this is the Base URL of the current URL.\n    // Safe access `window?.document?.baseURI` for users who shim `window` in Node.js\n    const baseURI = typeof window !== 'undefined' ? window?.document?.baseURI : undefined;\n    return baseURI;\n}\nfunction parseOrigin(url) {\n    if (!isUrlWithWebProtocol(url)) {\n        return { pathname: url, origin: null, protocol: null };\n    }\n    else {\n        const { protocol, uriWithoutProtocol } = parseProtocol(url);\n        assert(protocol);\n        const [host, ...rest] = uriWithoutProtocol.split('/');\n        const origin = protocol + host;\n        const pathname = '/' + rest.join('/');\n        return { pathname, origin, protocol };\n    }\n}\nfunction parseHost(host, url) {\n    const ret = { hostname: null, port: null };\n    if (!host)\n        return ret;\n    // port\n    const parts = host.split(':');\n    if (parts.length > 1) {\n        const port = parseInt(parts.pop(), 10);\n        assert(port || port === 0, url);\n        ret.port = port;\n    }\n    // hostname\n    ret.hostname = parts.join(':');\n    return ret;\n}\nfunction parseProtocol(uri) {\n    const SEP = ':';\n    const [before, ...after] = uri.split(SEP);\n    if (after.length === 0 ||\n        // https://github.com/vikejs/vike/commit/886a99ff21e86a8ca699a25cee7edc184aa058e4#r143308934\n        // https://en.wikipedia.org/wiki/List_of_URI_schemes\n        // https://www.rfc-editor.org/rfc/rfc7595\n        !/^[a-z][a-z0-9\\+\\-]*$/i.test(before)) {\n        return { protocol: null, uriWithoutProtocol: uri };\n    }\n    let protocol = before + SEP;\n    let uriWithoutProtocol = after.join(SEP);\n    const SEP2 = '//';\n    if (uriWithoutProtocol.startsWith(SEP2)) {\n        protocol = protocol + SEP2;\n        uriWithoutProtocol = uriWithoutProtocol.slice(SEP2.length);\n    }\n    return { protocol, uriWithoutProtocol };\n}\nfunction isWebUrlProtocol(protocol) {\n    // Is there an alternative to having a blocklist?\n    // - If the blocklist becomes too big, maybe use a allowlist instead ['tauri://', 'file://', 'capacitor://', 'http://', 'https://']\n    const blocklist = [\n        // https://docs.ipfs.tech/how-to/address-ipfs-on-web\n        'ipfs://',\n        'ipns://',\n    ];\n    if (blocklist.includes(protocol))\n        return false;\n    return protocol.endsWith('://');\n}\n// Adapted from https://stackoverflow.com/questions/14780350/convert-relative-path-to-absolute-using-javascript/14780463#14780463\nfunction resolveUrlPathnameRelative(pathnameRelative, base) {\n    const stack = base.split('/');\n    const parts = pathnameRelative.split('/');\n    let baseRestoreTrailingSlash = base.endsWith('/');\n    if (pathnameRelative.startsWith('.')) {\n        // remove current file name\n        stack.pop();\n    }\n    for (const i in parts) {\n        const p = parts[i];\n        if (p == '' && i === '0')\n            continue;\n        if (p == '.')\n            continue;\n        if (p == '..')\n            stack.pop();\n        else {\n            baseRestoreTrailingSlash = false;\n            stack.push(p);\n        }\n    }\n    let pathnameAbsolute = stack.join('/');\n    if (baseRestoreTrailingSlash && !pathnameAbsolute.endsWith('/'))\n        pathnameAbsolute += '/';\n    if (!pathnameAbsolute.startsWith('/'))\n        pathnameAbsolute = '/' + pathnameAbsolute;\n    return pathnameAbsolute;\n}\nfunction removeBaseServer(pathnameAbsoluteWithBase, baseServer) {\n    assert(pathnameAbsoluteWithBase.startsWith('/'));\n    assert(isBaseServer(baseServer));\n    // Mutable\n    let urlPathname = pathnameAbsoluteWithBase;\n    assert(urlPathname.startsWith('/'));\n    assert(baseServer.startsWith('/'));\n    if (baseServer === '/') {\n        const pathname = pathnameAbsoluteWithBase;\n        return { pathname, isBaseMissing: false };\n    }\n    // Support `url === '/some-base-url' && baseServer === '/some-base-url/'`\n    let baseServerNormalized = baseServer;\n    if (baseServer.endsWith('/') && urlPathname === slice(baseServer, 0, -1)) {\n        baseServerNormalized = slice(baseServer, 0, -1);\n        assert(urlPathname === baseServerNormalized);\n    }\n    if (!urlPathname.startsWith(baseServerNormalized)) {\n        const pathname = pathnameAbsoluteWithBase;\n        return { pathname, isBaseMissing: true };\n    }\n    assert(urlPathname.startsWith('/') || urlPathname.startsWith('http'));\n    assert(urlPathname.startsWith(baseServerNormalized));\n    urlPathname = urlPathname.slice(baseServerNormalized.length);\n    if (!urlPathname.startsWith('/'))\n        urlPathname = '/' + urlPathname;\n    assert(urlPathname.startsWith('/'));\n    return { pathname: urlPathname, isBaseMissing: false };\n}\nfunction isBaseServer(baseServer) {\n    return baseServer.startsWith('/');\n}\nfunction assertUrlComponents(url, origin, pathnameOriginal, searchOriginal, hashOriginal) {\n    const urlRecreated = createUrlFromComponents(origin, pathnameOriginal, searchOriginal, hashOriginal);\n    assert(url === urlRecreated);\n}\nfunction createUrlFromComponents(origin, pathname, search, hash) {\n    const urlRecreated = `${origin || ''}${pathname}${search || ''}${hash || ''}`;\n    return urlRecreated;\n}\nfunction isUrl(url) {\n    // parseUrl() works with these URLs\n    return isUrlAbsolute(url) || isUrlRelative(url);\n}\nfunction isUrlRedirectTarget(url) {\n    return isUrlAbsolute(url) || isUri(url);\n}\nfunction isUrlAbsolute(url) {\n    return isUrlPathAbsolute(url) || isUrlWithWebProtocol(url);\n}\nfunction isUrlPathAbsolute(url) {\n    return url.startsWith('/');\n}\nfunction isUrlRelative(url) {\n    return ['.', '?', '#'].some((c) => url.startsWith(c)) || url === '';\n}\nfunction isUrlExternal(url) {\n    return !url.startsWith('/') && !isUrlRelative(url);\n}\n/*\nURL with protocol.\n\n  http://example.com\n  https://example.com\n  tauri://localhost\n  file://example.com\n  capacitor://localhost/assets/chunks/chunk-DJBYDrsP.js\n\n[Tauri](https://github.com/vikejs/vike/issues/808)\n[Electron (`file://`)](https://github.com/vikejs/vike/issues/1557)\n[Capacitor](https://github.com/vikejs/vike/issues/1706)\n */\nfunction isUrlWithWebProtocol(url) {\n    const { protocol } = parseProtocol(url);\n    return !!protocol && isWebUrlProtocol(protocol);\n}\n/*\nURIs that aren't URLs.\n\n  mailto:john@example.com\n\n  ipfs://bafybeiemxf5abjwjbikoz4mc3a3dla6ual3jsgpdr4cjr3oz3evfyavhwq/wiki/Vincent_van_Gogh.html\n\n  magnet:?xt=urn:btih:3a15e1ac49683d91b20c2ffc252ea612a6c01bd7&dn=The.Empire.Strikes.Back.1980.Remastered.1080p.BluRay.DDP.7.1.x265-EDGE2020.mkv&xl=3225443573&tr=udp://tracker.opentrackr.org:1337/announce&tr=udp://tracker.torrent.eu.org:451&tr=udp://open.stealth.si:80/announce&tr=udp://tracker.openbittorrent.com:6969&tr=udp://tracker.tiny-vps.com:6969/announce&tr=udp://open.demonii.com:1337\n\nWe need to treat URIs differently than URLs.\n - For example, we cannot parse URIs (their structure is unknown e.g. a `magnet:` URI is completely different than a `http://` URL).\n   - The protocols tauri:// file:// capacitor:// follow the same structure as http:// and https:// URLs.\n     - Thus we can parse them like http:// and https:// URLs.\n*/\nfunction isUri(uri) {\n    const { protocol } = parseProtocol(uri);\n    return !!protocol && !isWebUrlProtocol(protocol);\n}\nfunction assertUsageUrlAbsolute(url, errPrefix) {\n    assertUsage(isUrlAbsolute(url), getErrMsg(url, errPrefix, true));\n}\nfunction assertUsageUrlPathAbsolute(url, errPrefix) {\n    assertUsage(isUrlPathAbsolute(url), getErrMsg(url, errPrefix));\n}\nfunction assertUsageUrlRedirectTarget(url, errPrefix, isUnresolved) {\n    const errMsg = getErrMsg(url, errPrefix, true, isUnresolved);\n    assertUsage(isUrlRedirectTarget(url) || (isUnresolved && url === '*'), errMsg);\n}\nfunction getErrMsg(url, errPrefix, allowProtocol, allowUri) {\n    let errMsg = `${errPrefix} is ${pc.string(url)} but it should start with ${pc.string('/')}`;\n    if (allowProtocol)\n        errMsg += ` or a protocol (e.g. ${pc.string('http://')})`;\n    if (allowUri)\n        errMsg += `, or be ${pc.string('*')}`;\n    return errMsg;\n}\n","export { objectAssign };\nimport { assert } from './assert.js';\n// Same as Object.assign() but:\n//  - With type inference\n//  - Preserves property descriptors, which we need for preserving the getters of getPageContextUrlComputed()\nfunction objectAssign(obj, objAddendum, objAddendumCanBeOriginalObject) {\n    if (!objAddendum)\n        return;\n    if (!objAddendumCanBeOriginalObject)\n        assert(!objAddendum._isOriginalObject);\n    Object.defineProperties(obj, Object.getOwnPropertyDescriptors(objAddendum));\n}\n","export function objectReplace(objOld, objNew, except) {\n    Object.keys(objOld)\n        .filter((key) => !except?.includes(key))\n        .forEach((key) => delete objOld[key]);\n    Object.defineProperties(objOld, Object.getOwnPropertyDescriptors(objNew));\n}\n","import { assert } from './assert.js';\nexport { higherFirst };\nexport { lowerFirst };\nexport { makeFirst };\nexport { makeLast };\nexport { reverse };\n/**\n * ```js\n * let arr = [\n *   { price: 10 },\n *   { price: 1000 },\n *   { price: 100 }\n * ]\n * arr = arr.sort(higherFirst(el => el.price))\n * isEqual(arr, [\n *   { price: 1000 },\n *   { price: 100 },\n *   { price: 10 }\n * ])\n * ```\n */\nfunction higherFirst(getValue) {\n    return (element1, element2) => {\n        const val1 = getValue(element1);\n        const val2 = getValue(element2);\n        if (val1 === val2) {\n            return 0;\n        }\n        return val1 > val2 ? -1 : 1;\n    };\n}\n/**\n * ```js\n * let arr = [\n *   { price: 10 },\n *   { price: 1000 },\n *   { price: 100 }\n * ]\n * arr = arr.sort(lowerFirst(el => el.price))\n * isEqual(arr, [\n *   { price: 10 },\n *   { price: 100 },\n *   { price: 1000 }\n * ])\n * ```\n */\nfunction lowerFirst(getValue) {\n    return (element1, element2) => {\n        const val1 = getValue(element1);\n        const val2 = getValue(element2);\n        if (val1 === val2) {\n            return 0;\n        }\n        return val1 < val2 ? -1 : 1;\n    };\n}\n/**\n * ```js\n * let arr = [\n *  { name: 'iphone', isRocket: false },\n *  { name: 'starship', isRocket: true }\n * ]\n * arr = arr.sort(makeFirst(el => el.isRocket))\n * isEqual(arr, [\n *  { name: 'starship', isRocket: true },\n *  { name: 'iphone', isRocket: false }\n * ])\n * ```\n */\nfunction makeFirst(getValue) {\n    return (element1, element2) => {\n        const val1 = getValue(element1);\n        const val2 = getValue(element2);\n        assert([true, false, null].includes(val1));\n        assert([true, false, null].includes(val2));\n        if (val1 === val2) {\n            return 0;\n        }\n        if (val1 === true || val2 === false) {\n            return -1;\n        }\n        if (val2 === true || val1 === false) {\n            return 1;\n        }\n        assert(false);\n    };\n}\n/**\n * ```js\n * let arr = [\n *  { name: 'starship', isRocket: true },\n *  { name: 'iphone', isRocket: false }\n * ]\n * arr = arr.sort(makeLast(el => el.isRocket))\n * isEqual(arr, [\n *  { name: 'iphone', isRocket: false },\n *  { name: 'starship', isRocket: true }\n * ])\n * ```\n */\nfunction makeLast(getValue) {\n    return makeFirst((element) => {\n        const val = getValue(element);\n        if (val === null) {\n            return null;\n        }\n        else {\n            return !val;\n        }\n    });\n}\n/** Reverse order result. */\nfunction reverse(sortKey) {\n    return (-1 * sortKey);\n}\n","export function isBrowser() {\n    // Using `typeof window !== 'undefined'` alone is not enough because some users use https://www.npmjs.com/package/ssr-window\n    return typeof window !== 'undefined' && typeof window.scrollY === 'number';\n    // Alternatively, test whether environment is a *real* browser: https://github.com/brillout/picocolors/blob/d59a33a0fd52a8a33e4158884069192a89ce0113/picocolors.js#L87-L89\n}\n","export { isArrayOfStrings };\nimport { isArray } from './isArray.js';\nfunction isArrayOfStrings(val) {\n    return isArray(val) && val.every((v) => typeof v === 'string');\n}\n","export { isObjectOfStrings };\nimport { isObject } from './isObject.js';\nfunction isObjectOfStrings(val) {\n    return isObject(val) && Object.values(val).every((v) => typeof v === 'string');\n}\n","export { hasProp };\nimport { isCallable } from './isCallable.js';\nimport { isObject } from './isObject.js';\nimport { isArrayOfStrings } from './isArrayOfStrings.js';\nimport { isObjectOfStrings } from './isObjectOfStrings.js';\nimport { isArray } from './isArray.js';\nfunction hasProp(obj, prop, type) {\n    if (!isObject(obj))\n        return false;\n    if (!(prop in obj)) {\n        return type === 'undefined';\n    }\n    if (type === undefined) {\n        return true;\n    }\n    const propValue = obj[prop];\n    if (type === 'undefined') {\n        return propValue === undefined;\n    }\n    if (type === 'array') {\n        return isArray(propValue);\n    }\n    if (type === 'object') {\n        return isObject(propValue);\n    }\n    if (type === 'string[]') {\n        return isArrayOfStrings(propValue);\n    }\n    if (type === 'string{}') {\n        return isObjectOfStrings(propValue);\n    }\n    if (type === 'function') {\n        return isCallable(propValue);\n    }\n    if (isArray(type)) {\n        return typeof propValue === 'string' && type.includes(propValue);\n    }\n    if (type === 'null') {\n        return propValue === null;\n    }\n    if (type === 'true') {\n        return propValue === true;\n    }\n    if (type === 'false') {\n        return propValue === false;\n    }\n    return typeof propValue === type;\n}\n","export function isPlainObject(value) {\n    // Is object?\n    if (typeof value !== 'object' || value === null) {\n        return false;\n    }\n    // Support `Object.create(null)`\n    if (Object.getPrototypeOf(value) === null) {\n        return true;\n    }\n    // Is plain object?\n    return (\n    /* Doesn't work in Cloudflare Pages workers\n    value.constructor === Object\n    */\n    value.constructor.name === 'Object');\n}\n","export { compareString };\nfunction compareString(str1, str2) {\n    if (str1.toLowerCase() < str2.toLowerCase())\n        return -1;\n    if (str1.toLowerCase() > str2.toLowerCase())\n        return 1;\n    return 0;\n}\n","export function isNullish(val) {\n    return val === null || val === undefined;\n}\n// someArray.filter(isNotNullish)\nexport function isNotNullish(p) {\n    return !isNullish(p);\n}\n// objectFilter(obj).filter(isNotNullish_keyVal)\nexport function isNotNullish_keyVal(arg) {\n    return !isNullish(arg[1]);\n}\n","export { stringifyStringArray };\nfunction stringifyStringArray(stringList) {\n    return '[' + stringList.map((str) => \"'\" + str + \"'\").join(', ') + ']';\n}\n","export function isPropertyGetter(obj, prop) {\n    const descriptor = Object.getOwnPropertyDescriptor(obj, prop);\n    return !!descriptor && !('value' in descriptor) && !!descriptor.get;\n}\n","import { isCallable } from './isCallable.js';\nexport function isPromise(val) {\n    return typeof val === 'object' && val !== null && 'then' in val && isCallable(val.then);\n}\n","export function getValuePrintable(value) {\n    if ([null, undefined].includes(value))\n        return String(value);\n    if (['boolean', 'number', 'string'].includes(typeof value))\n        return JSON.stringify(value);\n    return null;\n}\n","export function escapeRegex(str) {\n    // https://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript/3561711#3561711\n    return str.replace(/[/\\-\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n}\n","/** Change enumerability of an object property. */\nexport function changeEnumerable(obj, prop, enumerable) {\n    const descriptor = Object.getOwnPropertyDescriptor(obj, prop);\n    Object.defineProperty(obj, prop, { ...descriptor, enumerable });\n}\n","// Same as Object.defineProperty() but with type inference\nexport function objectDefineProperty(obj, prop, { get, ...args }) {\n    Object.defineProperty(obj, prop, { ...args, get });\n}\n","export { isScriptFile };\nexport { isPlainScriptFile };\nexport { isTemplateFile };\nexport { scriptFileExtensionList };\nexport { scriptFileExtensionPattern };\n// We can't use a RegExp:\n//  - Needs to work with Micromatch: https://github.com/micromatch/micromatch because:\n//    - Vite's `import.meta.glob()` uses Micromatch\n//  - We need this to be a allowlist because:\n//   - A pattern `*([a-zA-Z0-9]` doesn't work.\n//     - Because of ReScript: `.res` are ReScript source files which need to be ignored. (The ReScript compiler generates `.js` files alongside `.res` files.)\n//   - Block listing doesn't work.\n//     - We cannot implement a blocklist with a glob pattern.\n//     - A post `import.meta.glob()` blocklist filtering doesn't work because Vite would still process the files (e.g. including them in the bundle).\n// prettier-ignore\n// biome-ignore format:\nconst extJs = [\n    'js',\n    'cjs',\n    'mjs',\n];\n// prettier-ignore\n// biome-ignore format:\nconst extTs = [\n    'ts',\n    'cts',\n    'mts',\n];\nconst extJsOrTs = [...extJs, ...extTs];\n// prettier-ignore\n// biome-ignore format:\nconst extJsx = [\n    'jsx',\n    'cjsx',\n    'mjsx',\n];\n// prettier-ignore\n// biome-ignore format:\nconst extTsx = [\n    'tsx',\n    'ctsx',\n    'mtsx'\n];\nconst extJsxOrTsx = [...extJsx, ...extTsx];\n// prettier-ignore\n// biome-ignore format:\nconst extTemplates = [\n    'vue',\n    'svelte',\n    'marko',\n    'md',\n    'mdx'\n];\nconst scriptFileExtensionList = [...extJsOrTs, ...extJsxOrTsx, ...extTemplates];\nconst scriptFileExtensionPattern = '(' + scriptFileExtensionList.join('|') + ')';\nfunction isScriptFile(filePath) {\n    return scriptFileExtensionList.some((ext) => filePath.endsWith('.' + ext));\n}\nfunction isPlainScriptFile(filePath) {\n    return extJsOrTs.some((ext) => filePath.endsWith('.' + ext));\n}\nfunction isTemplateFile(filePath) {\n    return extTemplates.some((ext) => filePath.endsWith('.' + ext));\n}\n","export function getPropAccessNotation(key) {\n    return typeof key === 'string' && isKeyDotNotationCompatible(key) ? `.${key}` : `[${JSON.stringify(key)}]`;\n}\nfunction isKeyDotNotationCompatible(key) {\n    return /^[a-z0-9\\$_]+$/i.test(key);\n}\n","export { genPromise };\n// Simple implementation without timeout: https://github.com/vikejs/vike/blob/2e59b922e7e0f227d26018dc2b74877c9b0f581b/vike/utils/genPromise.ts\nimport { assert, assertWarning } from './assert.js';\nconst timeoutSecondsDefault = 25;\nfunction genPromise({ timeout: timeoutSeconds = timeoutSecondsDefault, } = {}) {\n    let resolve;\n    let reject;\n    let finished = false;\n    const promise_internal = new Promise((resolve_, reject_) => {\n        resolve = (...args) => {\n            finished = true;\n            timeoutClear();\n            return resolve_(...args);\n        };\n        reject = (...args) => {\n            finished = true;\n            timeoutClear();\n            return reject_(...args);\n        };\n    });\n    const timeoutClear = () => timeouts.forEach((t) => clearTimeout(t));\n    const timeouts = [];\n    let promise;\n    if (!timeoutSeconds) {\n        promise = promise_internal;\n    }\n    else {\n        promise = new Proxy(promise_internal, {\n            get(target, prop) {\n                if (prop === 'then' && !finished) {\n                    const err = new Error(`Promise hasn't resolved after ${timeoutSeconds} seconds`);\n                    timeouts.push(setTimeout(() => {\n                        assert(err.stack);\n                        assertWarning(false, removeStackErrorPrefix(err.stack), { onlyOnce: false });\n                    }, timeoutSeconds * 1000));\n                }\n                const value = Reflect.get(target, prop);\n                return typeof value === 'function' ? value.bind(target) : value;\n            },\n        });\n    }\n    return { promise, resolve, reject };\n}\nfunction removeStackErrorPrefix(errStack) {\n    const errorPrefix = 'Error: ';\n    if (errStack.startsWith(errorPrefix))\n        errStack = errStack.slice(errorPrefix.length);\n    return errStack;\n}\n","export { getExportPath };\nimport { assert } from '../utils.js';\nfunction getExportPath(fileExportPathToShowToUser, configName) {\n    if (!fileExportPathToShowToUser)\n        return null;\n    let [exportName, ...exportObjectPath] = fileExportPathToShowToUser;\n    if (!exportName)\n        return null;\n    if (exportObjectPath.length === 0 && ['*', 'default', configName].includes(exportName))\n        return null;\n    assert(exportName !== '*');\n    let prefix = '';\n    let suffix = '';\n    if (exportName === 'default') {\n        prefix = 'export default';\n    }\n    else {\n        prefix = 'export';\n        exportObjectPath = [exportName, ...exportObjectPath];\n    }\n    exportObjectPath.forEach((prop) => {\n        prefix = `${prefix} { ${prop}`;\n        suffix = ` }${suffix}`;\n    });\n    const exportPath = prefix + suffix;\n    return exportPath;\n}\n","export { getConfigDefinedAt };\nexport { getConfigDefinedAtOptional };\nexport { getDefinedAtString };\nexport { getDefinedByString };\nimport { assert, checkType, isArray } from '../utils.js';\nimport pc from '@brillout/picocolors';\nimport { getExportPath } from './getExportPath.js';\nfunction getConfigDefinedAt(sentenceBegin, configName, definedAtData) {\n    return `${begin(sentenceBegin, configName)} at ${getDefinedAtString(definedAtData, configName)}`;\n}\nfunction getConfigDefinedAtOptional(sentenceBegin, configName, definedAtData) {\n    if (!definedAtData) {\n        return `${begin(sentenceBegin, configName)} internally`;\n    }\n    else {\n        return `${begin(sentenceBegin, configName)} at ${getDefinedAtString(definedAtData, configName)}`;\n    }\n}\nfunction begin(sentenceBegin, configName) {\n    return `${sentenceBegin} ${pc.cyan(configName)} defined`;\n}\nfunction getDefinedAtString(definedAtData, configName) {\n    let files;\n    if (isArray(definedAtData)) {\n        files = definedAtData;\n    }\n    else {\n        files = [definedAtData];\n    }\n    assert(files.length >= 1);\n    const definedAtString = files\n        .map((definedAt) => {\n        if (definedAt.definedBy)\n            return getDefinedByString(definedAt, configName);\n        const { filePathToShowToUser, fileExportPathToShowToUser } = definedAt;\n        const exportPath = getExportPath(fileExportPathToShowToUser, configName);\n        if (exportPath) {\n            return `${filePathToShowToUser} > ${pc.cyan(exportPath)}`;\n        }\n        else {\n            return filePathToShowToUser;\n        }\n    })\n        .join(' / ');\n    return definedAtString;\n}\nfunction getDefinedByString(definedAt, configName) {\n    if (definedAt.definedBy === 'api') {\n        return `API call ${pc.cyan(`${definedAt.operation}({ vikeConfig: { ${configName} } })`)}`;\n    }\n    const { definedBy } = definedAt;\n    if (definedBy === 'cli') {\n        return `CLI option ${pc.cyan(`--${configName}`)}`;\n    }\n    if (definedBy === 'env') {\n        return `environment variable ${pc.cyan(`VIKE_CONFIG=\"{${configName}}\"`)}`;\n    }\n    checkType(definedBy);\n    assert(false);\n}\n","export { getConfigValueTyped };\nimport { assert, assertUsage, getValuePrintable } from '../utils.js';\nimport pc from '@brillout/picocolors';\nimport { getConfigDefinedAtOptional } from './getConfigDefinedAt.js';\nfunction getConfigValueTyped(configValue, configName, type) {\n    /* [NULL_HANDLING] Do we really need this? This doesn't seem to make sense, let's eventually (re)move this.\n    // Enable users to suppress global config values by setting the local config value to null\n    if (configValue.value === null) return null\n    */\n    const { value, definedAtData } = configValue;\n    if (type)\n        assertConfigValueType(value, type, configName, definedAtData);\n    return configValue;\n}\nfunction assertConfigValueType(value, type, configName, definedAtData) {\n    assert(value !== null);\n    const typeActual = typeof value;\n    if (typeActual === type)\n        return;\n    const valuePrintable = getValuePrintable(value);\n    const problem = valuePrintable !== null\n        ? `value ${pc.cyan(valuePrintable)}`\n        : `type ${pc.cyan(typeActual)}`;\n    const configDefinedAt = getConfigDefinedAtOptional('Config', configName, definedAtData);\n    const errMsg = `${configDefinedAt} has an invalid ${problem}: it should be a ${pc.cyan(type)} instead`;\n    assertUsage(false, errMsg);\n}\n","export { getConfigValueRuntime };\nimport { getConfigValueTyped } from './getConfigValueTyped.js';\nfunction getConfigValueRuntime(pageConfig, configName, type) {\n    const configValue = pageConfig.configValues[configName];\n    if (!configValue)\n        return null;\n    return getConfigValueTyped(configValue, configName, type);\n}\n","export { addIs404ToPageProps };\nimport { assertWarning, isObject } from './utils.js';\nfunction addIs404ToPageProps(pageContext) {\n    addIs404(pageContext);\n}\nfunction addIs404(pageContext) {\n    if (pageContext.is404 === undefined || pageContext.is404 === null)\n        return;\n    const pageProps = pageContext.pageProps || {};\n    if (!isObject(pageProps)) {\n        assertWarning(false, 'pageContext.pageProps should be an object', { showStackTrace: true, onlyOnce: true });\n        return;\n    }\n    pageProps.is404 = pageProps.is404 || pageContext.is404;\n    pageContext.pageProps = pageProps;\n}\n","export const NOT_SERIALIZABLE = '__VIKE__NOT_SERIALIZABLE__';\n","export { getProxyForPublicUsage };\n// We use a proxy instead of property getters.\n// - The issue with property getters is that they can't be `writable: true` but we do want the user to be able to modify the value of internal properties.\n//   ```console\n//   TypeError: Invalid property descriptor. Cannot both specify accessors and a value or writable attribute, #<Object>\n//   ```\n// - Previous implementation using property getters: https://github.com/vikejs/vike/blob/4dbb354b0bcec04e862041fc9183fc4691bb8711/vike/utils/makePublicCopy.ts\n// Show warning when user is accessing internal `_` properties.\nimport { NOT_SERIALIZABLE } from './NOT_SERIALIZABLE.js';\nimport { assert, assertUsage, assertWarning, getPropAccessNotation, isBrowser } from './utils.js';\nfunction getProxyForPublicUsage(obj, objName, skipOnInternalProp, fallback) {\n    return new Proxy(obj, {\n        get: (_, prop) => getProp(prop, obj, objName, skipOnInternalProp, fallback),\n    });\n}\nfunction getProp(prop, obj, objName, skipOnInternalProp, fallback) {\n    const propStr = String(prop);\n    if (prop === '_isProxyObject')\n        return true;\n    if (prop === 'dangerouslyUseInternals')\n        return obj;\n    if (!skipOnInternalProp) {\n        if (!globalThis.__VIKE__IS_CLIENT)\n            onInternalProp(propStr, objName);\n    }\n    if (fallback && !(prop in obj)) {\n        // Rudimentary flat pageContext implementation https://github.com/vikejs/vike/issues/1268\n        // Failed full-fledged implementation: https://github.com/vikejs/vike/pull/2458\n        return fallback(prop);\n    }\n    const val = obj[prop];\n    onNotSerializable(propStr, val, objName);\n    return val;\n}\nfunction onNotSerializable(propStr, val, objName) {\n    if (val !== NOT_SERIALIZABLE)\n        return;\n    const propName = getPropAccessNotation(propStr);\n    assert(isBrowser());\n    assertUsage(false, `Can't access ${objName}${propName} on the client side. Because it can't be serialized, see server logs.`);\n}\nfunction onInternalProp(propStr, objName) {\n    // We must skip it on the client-side because of the reactivity mechanism of UI frameworks like Solid.\n    assert(!isBrowser());\n    // TO-DO/soon/proxy: remove this and only warn on built-in access instead\n    if (propStr === '_configFromHook')\n        return;\n    if (propStr.startsWith('_')) {\n        assertWarning(false, `Using internal ${objName}.${propStr} — https://vike.dev/warning/internals`, {\n            onlyOnce: true,\n            showStackTrace: true,\n        });\n    }\n}\n","export { prepareGlobalContextForPublicUsage };\nimport { getProxyForPublicUsage } from './getProxyForPublicUsage.js';\nimport { assert } from './utils.js';\nfunction prepareGlobalContextForPublicUsage(globalContext) {\n    assert(globalContext._isOriginalObject); // ensure we preserve the original object reference\n    const globalContextPublic = getProxyForPublicUsage(globalContext, 'globalContext');\n    return globalContextPublic;\n}\n","export { preparePageContextForPublicUsage };\nexport { assertPropertyGetters };\nimport { assert, assertWarning, compareString, isPropertyGetter } from './utils.js';\nimport { addIs404ToPageProps } from './addIs404ToPageProps.js';\nimport { prepareGlobalContextForPublicUsage, } from './prepareGlobalContextForPublicUsage.js';\nimport { getProxyForPublicUsage } from './getProxyForPublicUsage.js';\nfunction preparePageContextForPublicUsage(pageContext) {\n    assert(!pageContext._isProxyObject);\n    assert(!pageContext.globalContext); // pageContext.globalContext should only be available to users — Vike itself should use pageContext._globalContext instead\n    assert(pageContext._isOriginalObject); // ensure we preserve the original object reference\n    addIs404ToPageProps(pageContext);\n    // TO-DO/next-major-release: remove\n    if (!('_pageId' in pageContext)) {\n        Object.defineProperty(pageContext, '_pageId', {\n            get() {\n                assertWarning(false, 'pageContext._pageId has been renamed to pageContext.pageId', {\n                    showStackTrace: true,\n                    onlyOnce: true,\n                });\n                return pageContext.pageId;\n            },\n            enumerable: false,\n        });\n    }\n    // For a more readable `console.log(pageContext)` output\n    sortPageContext(pageContext);\n    const globalContextPublic = prepareGlobalContextForPublicUsage(pageContext._globalContext);\n    const pageContextPublic = getProxyForPublicUsage(pageContext, 'pageContext', \n    // We must skip it in the client-side because of the reactivity mechanism of UI frameworks like Solid.\n    // - TO-DO/soon/proxy: double check whether that's true\n    true, (prop) => {\n        if (prop === 'globalContext') {\n            return globalContextPublic;\n        }\n        if (prop in globalContextPublic) {\n            return globalContextPublic[prop];\n        }\n    });\n    return pageContextPublic;\n}\n// Sort `pageContext` keys alphabetically, in order to make reading the `console.log(pageContext)` output easier\nfunction sortPageContext(pageContext) {\n    let descriptors = Object.getOwnPropertyDescriptors(pageContext);\n    for (const key of Object.keys(pageContext))\n        delete pageContext[key];\n    descriptors = Object.fromEntries(Object.entries(descriptors).sort(([key1], [key2]) => compareString(key1, key2)));\n    Object.defineProperties(pageContext, descriptors);\n}\nfunction assertPropertyGetters(pageContext) {\n    /*\n    If the isPropertyGetter() assertions fail then it's most likely because Object.assign() was used instead of `objectAssign()`:\n    ```js\n    const PageContextUrlComputed = getPageContextUrlComputed(pageContext)\n  \n    // ❌ Breaks the property descriptors/getters of pageContext defined by getPageContextUrlComputed() such as pageContext.urlPathname\n    Object.assign(pageContext, pageContextUrlComputed)\n  \n    // ❌ Also breaks property descriptors/getters\n    const pageContext = { ...pageContextUrlComputed }\n  \n    // ✅ Preserves property descriptors/getters (see objectAssign() implementation)\n    objectAssign(pageContext, pageContextUrlComputed)\n    ```\n    */\n    ;\n    [\n        'urlPathname',\n        // TO-DO/next-major-release: remove\n        'urlParsed',\n        // TO-DO/next-major-release: remove\n        'url',\n        // TO-DO/next-major-release: remove\n        'pageExports',\n    ].forEach((prop) => {\n        if (pageContext.prop)\n            assert(isPropertyGetter(pageContext, prop));\n    });\n}\n","export { normalizeClientSideUrl };\nimport { assert, parseUrl } from './utils.js';\n/** Resolves relative URLs */\nfunction normalizeClientSideUrl(url, options) {\n    // This function doesn't work for `url === '#some-hash'` because `searchOriginal` will be missing: if window.location.href has a search string then it's going to be missing in the returned `urlCurrent` value because `parseUrl(url)` returns `searchOriginal: null` since there isn't any search string in `url`.\n    // - Maybe `const { searchOriginal } = parseUrl(window.location.href)` can be a fix. (Let's check how `normalizeClientSideUrl()` is being used.)\n    assert(!url.startsWith('#'));\n    const { searchOriginal, hashOriginal, pathname } = parseUrl(url, '/');\n    let urlCurrent = `${pathname}${searchOriginal || ''}`;\n    if (!options?.withoutHash)\n        urlCurrent += hashOriginal || '';\n    assert(urlCurrent.startsWith('/'));\n    return urlCurrent;\n}\n","export { getCurrentUrl };\nimport { normalizeClientSideUrl } from './normalizeClientSideUrl.js';\nfunction getCurrentUrl(options) {\n    return normalizeClientSideUrl(window.location.href, options);\n}\n","export { assertClientRouting };\nexport { assertServerRouting };\nexport { checkIfClientRouting };\nimport { assertUsage, assertWarning } from './assert.js';\nimport { getGlobalObject } from './getGlobalObject.js';\nimport { isBrowser } from './isBrowser.js';\nimport pc from '@brillout/picocolors';\nconst state = getGlobalObject('utils/assertRouterType.ts', {});\nfunction assertClientRouting() {\n    assertNoContradiction(checkIfClientRouting());\n    state.isClientRouting = true;\n}\nfunction checkIfClientRouting() {\n    return state.isClientRouting !== false;\n}\nfunction assertServerRouting() {\n    assertNoContradiction(state.isClientRouting !== true);\n    state.isClientRouting = false;\n}\nfunction assertNoContradiction(noContradiction) {\n    // If an assertion fails because of a wrong usage, then we assume that the user is trying to import from 'vike/client/router' while not setting `clientRouting` to `true`. Note that 'vike/client' only exports the type `PageContextBuiltInClient` and that the package.json#exports entry 'vike/client' will eventually be removed.\n    assertUsage(isBrowser(), `${pc.cyan(\"import { something } from 'vike/client/router'\")} is forbidden on the server-side`, { showStackTrace: true });\n    assertWarning(noContradiction, \"You shouldn't `import { something } from 'vike/client/router'` when using Server Routing. The 'vike/client/router' utilities work only with Client Routing. In particular, don't `import { navigate }` nor `import { prefetch }` as they unnecessarily bloat your client-side bundle sizes.\", { showStackTrace: true, onlyOnce: true });\n}\n","export { onLoad };\nimport { assertIsBrowser } from '../../utils/assertIsBrowser.js';\nimport { assertClientRouting } from '../../utils/assertRoutingType.js';\nfunction onLoad() {\n    assertIsBrowser();\n    // Ensure we don't bloat the Server Routing runtime with Client Routing utils\n    assertClientRouting();\n}\n","// There doesn't seem to be a reliable way to detect React:\n//  - https://stackoverflow.com/questions/73156433/detect-with-javascript-whether-the-website-is-using-react\nexport function isReact() {\n    // Heuristic using values set by React (Dev Tools)\n    // - `window.__REACT_DEVTOOLS_GLOBAL_HOOK__` is an internal API for React Dev Tools\n    //   - https://stackoverflow.com/questions/46807826/how-does-react-developer-tools-determine-that-the-webpage-is-using-react/46808361#46808361\n    //   - In principle, `window.__REACT_DEVTOOLS_GLOBAL_HOOK__` should exist only if React Dev Tools is installed. (Although it seems that it's sometimes defined even when React Dev Tools isn't installed; I don't know why.)\n    // - We use `isReact1`/`isReact2` merely to validate `isReact3` and `isReact4`. Because `isReact1`/`isReact2` can be false negatives:\n    //   - React populates `__REACT_DEVTOOLS_GLOBAL_HOOK__.renderers` fairly late => false negative early in the rendering phase\n    //   - `window.__REACT_DEVTOOLS_GLOBAL_HOOK__` is `undefined` if React Dev Tools isn't installed => false negative\n    const isReact1 = !!window.__REACT_DEVTOOLS_GLOBAL_HOOK__?.renderers?.size;\n    const isReact2 = !!window.__REACT_DEVTOOLS_GLOBAL_HOOK__?.rendererInterfaces?.size;\n    // Heuristic using values set by `@vitejs/plugin-react`\n    const isReact3 = !!window.__vite_plugin_react_preamble_installed__;\n    /* Also set by Preact Vite plugin `@preact/preset-vite`\n    const isReact4 = !!(window as any).$RefreshReg$\n    */\n    // console.log({ isReact1, isReact2, isReact3 })\n    return isReact1 || isReact2 || isReact3;\n}\n","export function redirectHard(url) {\n    window.location.href = url;\n}\n","export function sleep(milliseconds) {\n    return new Promise((r) => setTimeout(r, milliseconds));\n}\n","export { throttle };\nfunction throttle(func, waitTime) {\n    let isQueued = false;\n    return () => {\n        if (!isQueued) {\n            isQueued = true;\n            setTimeout(() => {\n                isQueued = false;\n                func();\n            }, waitTime);\n        }\n    };\n}\n","export { onPageHide };\nexport { onPageShow };\nfunction onPageHide(listener) {\n    window.addEventListener('visibilitychange', () => {\n        if (document.visibilityState === 'hidden') {\n            listener();\n        }\n    });\n}\nfunction onPageShow(listener) {\n    window.addEventListener('visibilitychange', () => {\n        if (document.visibilityState === 'visible') {\n            listener();\n        }\n    });\n}\n","export { catchInfiniteLoop };\nimport { assertUsage, assertWarning } from './assert.js';\nconst trackers = {};\nfunction catchInfiniteLoop(functionName, maxNumberOfCalls = 100, withinSeconds = 5) {\n    // Init\n    const now = new Date();\n    let tracker = (trackers[functionName] ?? (trackers[functionName] = createTracker(now)));\n    // Reset\n    const elapsedTime = now.getTime() - tracker.start.getTime();\n    if (elapsedTime > withinSeconds * 1000)\n        tracker = trackers[functionName] = createTracker(now);\n    // Count\n    tracker.count++;\n    // Error\n    const msg = `[Infinite Loop] Rendering ${tracker.count} times within ${withinSeconds} seconds [${functionName}]`;\n    if (tracker.count > maxNumberOfCalls) {\n        assertUsage(false, msg);\n    }\n    // Warning, at 50% threshold\n    if (!tracker.warned && tracker.count > maxNumberOfCalls * 0.5) {\n        // Warning is shown upon 10 calls a second, on average during 5 seconds, given the default parameters\n        assertWarning(false, msg, { onlyOnce: false, showStackTrace: true });\n        tracker.warned = true;\n    }\n}\nfunction createTracker(now) {\n    const tracker = {\n        count: 0,\n        start: now,\n    };\n    return tracker;\n}\n","// https://stackoverflow.com/questions/201183/how-to-determine-equality-for-two-javascript-objects/32922084#32922084\nexport function deepEqual(x, y) {\n    const ok = Object.keys, tx = typeof x, ty = typeof y;\n    return x && y && tx === 'object' && tx === ty\n        ? ok(x).length === ok(y).length && ok(x).every((key) => deepEqual(x[key], y[key]))\n        : x === y;\n}\n","// Utils needed by Vike's client runtime (with Client Routing)\n// We call onLoad() here so that it's called even when only a subset of the runtime is loaded. (Making the assert() calls inside onLoad() a lot stronger.)\nimport { onLoad } from './onLoad.js';\nonLoad();\nexport * from '../../utils/assert.js';\nexport * from '../../utils/assertSingleInstance.js';\nexport * from '../../utils/getGlobalObject.js';\nexport * from '../../utils/hasProp.js';\nexport * from '../../utils/isBrowser.js';\nexport * from '../../utils/isCallable.js';\nexport * from '../../utils/isObject.js';\nexport * from '../../utils/isPlainObject.js';\nexport * from '../../utils/isReact.js';\nexport * from '../../utils/objectAssign.js';\nexport * from '../../utils/parseUrl.js';\nexport * from '../../utils/PromiseType.js';\nexport * from '../../utils/redirectHard.js';\nexport * from '../../utils/sleep.js';\nexport * from '../../utils/slice.js';\nexport * from '../../utils/throttle.js';\nexport * from '../../utils/assertRoutingType.js';\nexport * from '../../utils/onPageVisibilityChange.js';\nexport * from '../../utils/updateType.js';\nexport * from '../../utils/PROJECT_VERSION.js';\nexport * from '../../utils/genPromise.js';\nexport * from '../../utils/catchInfiniteLoop.js';\nexport * from '../../utils/changeEnumerable.js';\nexport * from '../../utils/deepEqual.js';\nexport * from '../../utils/cast.js';\n","export { types };\nconst types = [\n    ts({\n        is: (val) => val === undefined,\n        match: (str) => str === '!undefined',\n        serialize: () => '!undefined',\n        deserialize: () => undefined,\n    }),\n    ts({\n        is: (val) => val === Infinity,\n        match: (str) => str === '!Infinity',\n        serialize: () => '!Infinity',\n        deserialize: () => Infinity,\n    }),\n    ts({\n        is: (val) => val === -Infinity,\n        match: (str) => str === '!-Infinity',\n        serialize: () => '!-Infinity',\n        deserialize: () => -Infinity,\n    }),\n    ts({\n        is: (val) => typeof val === 'number' && isNaN(val),\n        match: (str) => str === '!NaN',\n        serialize: () => '!NaN',\n        deserialize: () => NaN,\n    }),\n    ts({\n        is: (val) => val instanceof Date,\n        match: (str) => str.startsWith('!Date:'),\n        serialize: (val) => '!Date:' + val.toISOString(),\n        deserialize: (str) => new Date(str.slice('!Date:'.length)),\n    }),\n    ts({\n        is: (val) => typeof val === 'bigint',\n        match: (str) => str.startsWith('!BigInt:'),\n        serialize: (val) => '!BigInt:' + val.toString(),\n        deserialize: (str) => {\n            if (typeof BigInt === 'undefined') {\n                throw new Error('Your JavaScript environement does not support BigInt. Consider adding a polyfill.');\n            }\n            return BigInt(str.slice('!BigInt:'.length));\n        },\n    }),\n    ts({\n        is: (val) => val instanceof RegExp,\n        match: (str) => str.startsWith('!RegExp:'),\n        serialize: (val) => '!RegExp:' + val.toString(),\n        deserialize: (str) => {\n            str = str.slice('!RegExp:'.length);\n            // const args: string[] = str.match(/\\/(.*?)\\/([gimy])?$/)!\n            const args = str.match(/\\/(.*)\\/(.*)?/);\n            const pattern = args[1];\n            const flags = args[2];\n            return new RegExp(pattern, flags);\n        },\n    }),\n    ts({\n        is: (val) => val instanceof Map,\n        match: (str) => str.startsWith('!Map:'),\n        serialize: (val, serializer) => '!Map:' + serializer(Array.from(val.entries())),\n        deserialize: (str, parser) => new Map(parser(str.slice('!Map:'.length))),\n    }),\n    ts({\n        is: (val) => val instanceof Set,\n        match: (str) => str.startsWith('!Set:'),\n        serialize: (val, serializer) => '!Set:' + serializer(Array.from(val.values())),\n        deserialize: (str, parser) => new Set(parser(str.slice('!Set:'.length))),\n    }),\n    // Avoid collisions with the special strings defined above\n    ts({\n        is: (val) => typeof val === 'string' && val.startsWith('!'),\n        match: (str) => str.startsWith('!'),\n        serialize: (val) => '!' + val,\n        deserialize: (str) => str.slice(1),\n    }),\n];\n// Type check\nfunction ts(t) {\n    return t;\n}\n","export { parse };\n// Used by Vike: https://github.com/vikejs/vike/blob/b4ba6b70e6bdc2e1f460c0d2e4c3faae5d0a733c/vike/shared/page-configs/serialize/parseConfigValuesSerialized.ts#L13\nexport { parseTransform };\nimport { types } from './types.js';\nfunction parse(str, options = {}) {\n    // We don't use the reviver option in `JSON.parse(str, reviver)` because it doesn't support `undefined` values\n    const value = JSON.parse(str);\n    return parseTransform(value, options);\n}\nfunction parseTransform(value, options = {}) {\n    if (typeof value === 'string') {\n        return reviver(value, options);\n    }\n    if (\n    // Also matches arrays\n    typeof value === 'object' &&\n        value !== null) {\n        Object.entries(value).forEach(([key, val]) => {\n            ;\n            value[key] = parseTransform(val, options);\n        });\n    }\n    return value;\n}\nfunction reviver(value, options) {\n    const parser = (str) => parse(str, options);\n    {\n        const res = options.reviver?.(\n        // TO-DO/eventually: provide key if some user needs it\n        undefined, value, parser);\n        if (res) {\n            if (typeof res.replacement !== 'string') {\n                return res.replacement;\n            }\n            else {\n                value = res.replacement;\n                if (res.resolved)\n                    return value;\n            }\n        }\n    }\n    for (const { match, deserialize } of types) {\n        if (match(value)) {\n            return deserialize(value, parser);\n        }\n    }\n    return value;\n}\n","export const htmlElementId_pageContext = 'vike_pageContext';\nexport const htmlElementId_globalContext = 'vike_globalContext';\n","export { getPageContextSerializedInHtml };\nexport { getGlobalContextSerializedInHtml };\nimport { parse } from '@brillout/json-serializer/parse';\nimport { hasProp, assert, assertUsage } from './utils.js';\nimport { htmlElementId_globalContext, htmlElementId_pageContext } from '../../shared/htmlElementIds.js';\n// elements should exist because:\n// 1. <script id=\"vike_pageContext\" type=\"application/json\"> appears before the <script> that loads Vike's client runtime (which includes this file)\n// 2. <script id=\"vike_pageContext\" type=\"application/json\"> is neither async nor defer\n// See https://github.com/vikejs/vike/pull/1271\nfunction getPageContextSerializedInHtml() {\n    const pageContextSerializedInHtml = findAndParseJson(htmlElementId_pageContext);\n    assert(hasProp(pageContextSerializedInHtml, 'pageId', 'string'));\n    assert(hasProp(pageContextSerializedInHtml, 'routeParams', 'string{}'));\n    return pageContextSerializedInHtml;\n}\nfunction getGlobalContextSerializedInHtml() {\n    const globalContextSerializedInHtml = findAndParseJson(htmlElementId_globalContext);\n    return globalContextSerializedInHtml;\n}\nfunction findAndParseJson(id) {\n    const elem = document.getElementById(id);\n    assertUsage(elem, \n    // It seems like it can be missing when HTML is malformed: https://github.com/vikejs/vike/issues/913\n    `Couldn't find #${id} (which Vike automatically injects in the HTML): make sure it exists (i.e. don't remove it and make sure your HTML isn't malformed)`);\n    const jsonStr = elem.textContent;\n    assert(jsonStr);\n    const json = parse(jsonStr, {\n        // Prevent Google from crawling URLs in JSON:\n        // - https://github.com/vikejs/vike/pull/2603\n        // - https://github.com/brillout/json-serializer/blob/38edbb9945de4938da1e65d6285ce1dd123a45ef/test/main.spec.ts#L44-L95\n        reviver(_key, value) {\n            if (typeof value === 'string') {\n                return { replacement: value.replaceAll('\\\\/', '/'), resolved: false };\n            }\n        },\n    });\n    return json;\n}\n","// TO-DO/next-major-release: remove this file\nexport { getPageFilesClientSide };\nexport { getPageFilesServerSide };\nimport { assert, assertUsage, isNotNullish } from '../utils.js';\nfunction getPageFilesClientSide(pageFilesAll, pageId) {\n    return determine(pageFilesAll, pageId, true);\n}\nfunction getPageFilesServerSide(pageFilesAll, pageId) {\n    return determine(pageFilesAll, pageId, false);\n}\nfunction determine(pageFilesAll, pageId, envIsClient) {\n    const env = envIsClient ? 'CLIENT_ONLY' : 'SERVER_ONLY';\n    const pageFilesRelevant = pageFilesAll\n        .filter((p) => p.isRelevant(pageId) && p.fileType !== '.page.route')\n        .sort(getPageFilesSorter(envIsClient, pageId));\n    // Load the `.page.js` files specific to `pageId`\n    const getPageIdFile = (iso) => {\n        const files = pageFilesRelevant.filter((p) => p.pageId === pageId && p.isEnv(iso ? 'CLIENT_AND_SERVER' : env));\n        assertUsage(files.length <= 1, `Merge the following files into a single file: ${files.map((p) => p.filePath).join(' ')}`);\n        const pageIdFile = files[0];\n        assert(pageIdFile === undefined || !pageIdFile.isDefaultPageFile);\n        return pageIdFile;\n    };\n    const pageIdFileEnv = getPageIdFile(false);\n    const pageIdFileIso = getPageIdFile(true);\n    // A page can have only one renderer. In other words: Multiple `renderer/` overwrite each other.\n    // Load only load renderer (`/renderer/_default.*`)\n    const getRendererFile = (iso) => pageFilesRelevant.filter((p) => p.isRendererPageFile && p.isEnv(iso ? 'CLIENT_AND_SERVER' : env))[0];\n    const rendererFileEnv = getRendererFile(false);\n    const rendererFileIso = getRendererFile(true);\n    // A page can load multiple `_default.page.*` files of the same `fileType`. In other words: non-renderer `_default.page.*` files are cumulative.\n    // The exception being HTML-only pages because we pick a single page file as client entry. We handle that use case at `renderPage()`.\n    const defaultFilesNonRenderer = pageFilesRelevant.filter((p) => p.isDefaultPageFile && !p.isRendererPageFile && (p.isEnv(env) || p.isEnv('CLIENT_AND_SERVER')));\n    // Ordered by `pageContext.exports` precedence\n    const pageFiles = [pageIdFileEnv, pageIdFileIso, ...defaultFilesNonRenderer, rendererFileEnv, rendererFileIso].filter(isNotNullish);\n    return pageFiles;\n}\nfunction getPageFilesSorter(envIsClient, pageId) {\n    const env = envIsClient ? 'CLIENT_ONLY' : 'SERVER_ONLY';\n    const e1First = -1;\n    const e2First = +1;\n    const noOrder = 0;\n    return (e1, e2) => {\n        // `.page.js` files specific to `pageId` first\n        if (!e1.isDefaultPageFile && e2.isDefaultPageFile) {\n            return e1First;\n        }\n        if (!e2.isDefaultPageFile && e1.isDefaultPageFile) {\n            return e2First;\n        }\n        // Non-renderer `_default.page.*` before `renderer/**/_default.page.*`\n        {\n            const e1_isRenderer = e1.isRendererPageFile;\n            const e2_isRenderer = e2.isRendererPageFile;\n            if (!e1_isRenderer && e2_isRenderer) {\n                return e1First;\n            }\n            if (!e2_isRenderer && e1_isRenderer) {\n                return e2First;\n            }\n            assert(e1_isRenderer === e2_isRenderer);\n        }\n        // Filesystem nearest first\n        {\n            const e1_distance = getPathDistance(pageId, e1.filePath);\n            const e2_distance = getPathDistance(pageId, e2.filePath);\n            if (e1_distance < e2_distance) {\n                return e1First;\n            }\n            if (e2_distance < e1_distance) {\n                return e2First;\n            }\n            assert(e1_distance === e2_distance);\n        }\n        // `.page.server.js`/`.page.client.js` before `.page.js`\n        {\n            if (e1.isEnv(env) && e2.isEnv('CLIENT_AND_SERVER')) {\n                return e1First;\n            }\n            if (e2.isEnv(env) && e1.isEnv('CLIENT_AND_SERVER')) {\n                return e2First;\n            }\n        }\n        return noOrder;\n    };\n}\nfunction getPathDistance(pathA, pathB) {\n    // Index of first different character\n    let idx = 0;\n    for (; idx < pathA.length && idx < pathB.length; idx++) {\n        if (pathA[idx] !== pathB[idx])\n            break;\n    }\n    const pathAWithoutCommon = pathA.slice(idx);\n    const pathBWithoutCommon = pathB.slice(idx);\n    const distanceA = pathAWithoutCommon.split('/').length;\n    const distanceB = pathBWithoutCommon.split('/').length;\n    const distance = distanceA + distanceB;\n    return distance;\n}\n","export { analyzePageServerSide };\nimport { assert } from '../utils.js';\nimport { getPageFilesServerSide } from './getAllPageIdFiles.js';\nasync function analyzePageServerSide(pageFilesAll, pageId) {\n    const pageFilesServerSide = getPageFilesServerSide(pageFilesAll, pageId);\n    const pageFilesServerSideOnly = pageFilesServerSide.filter((p) => p.fileType === '.page.server');\n    await Promise.all(pageFilesServerSideOnly.map(async (p) => {\n        // In production, `exportNames` are preload\n        if (p.exportNames) {\n            return;\n        }\n        assert(p.loadExportNames, pageId);\n        await p.loadExportNames();\n    }));\n    const hasOnBeforeRenderServerSideOnlyHook = pageFilesServerSideOnly.some(({ exportNames }) => {\n        assert(exportNames);\n        return exportNames.includes('onBeforeRender');\n    });\n    return { hasOnBeforeRenderServerSideOnlyHook };\n}\n","export { removeBuiltInOverrides };\nimport { assert, assertWarning } from '../utils.js';\nconst BUILT_IN_CLIENT_ROUTER = ['urlPathname', 'urlParsed'];\nconst BUILT_IN_CLIENT = ['Page', 'pageExports', 'exports'];\nfunction removeBuiltInOverrides(pageContext) {\n    const alreadySet = [...BUILT_IN_CLIENT, ...BUILT_IN_CLIENT_ROUTER];\n    alreadySet.forEach((prop) => {\n        if (prop in pageContext) {\n            // We need to cast `BUILT_IN_CLIENT` to `string[]`\n            //  - https://stackoverflow.com/questions/56565528/typescript-const-assertions-how-to-use-array-prototype-includes\n            //  - https://stackoverflow.com/questions/57646355/check-if-string-is-included-in-readonlyarray-in-typescript\n            if (BUILT_IN_CLIENT_ROUTER.includes(prop)) {\n                assert(prop.startsWith('url'));\n                assertWarning(false, `pageContext.${prop} is already available in the browser when using Client Routing; adding '${prop}' to passToClient has no effect`, { onlyOnce: true });\n            }\n            else {\n                assertWarning(false, `pageContext.${prop} is a built-in that cannot be overridden; adding '${prop}' to passToClient has no effect`, { onlyOnce: true });\n            }\n            delete pageContext[prop];\n        }\n    });\n}\n","export { urlToFile };\nexport { baseServer };\nimport { assert } from './assert.js';\nimport { parseUrl } from './parseUrl.js';\nimport { slice } from './slice.js';\n// - When doing a `.pageContext.json` HTTP request, the base URL should be preserved. (The server-side will handle the base URL.)\n// - While pre-rendering there is no base URL\nconst baseServer = '/';\nfunction urlToFile(url, fileExtension, doNotCreateExtraDirectory) {\n    const { pathnameOriginal, searchOriginal, hashOriginal } = parseUrl(url, baseServer);\n    if (url.startsWith('/')) {\n        assert(url === `${pathnameOriginal}${searchOriginal || ''}${hashOriginal || ''}`, { url });\n    }\n    const hasTrailingSlash = pathnameOriginal.endsWith('/');\n    let pathnameModified;\n    if (doNotCreateExtraDirectory && pathnameOriginal !== '/') {\n        if (hasTrailingSlash) {\n            pathnameModified = slice(pathnameOriginal, 0, -1);\n        }\n        else {\n            pathnameModified = pathnameOriginal;\n        }\n        assert(!pathnameModified.endsWith('/'), { url });\n        assert(pathnameModified !== '');\n    }\n    else {\n        pathnameModified = pathnameOriginal + (hasTrailingSlash ? '' : '/') + 'index';\n    }\n    assert(pathnameModified);\n    pathnameModified = pathnameModified + fileExtension;\n    const fileUrl = `${pathnameModified}${searchOriginal || ''}${hashOriginal || ''}`;\n    return fileUrl;\n}\n","export { getPageContextRequestUrl };\nexport { pageContextJsonFileExtension };\nexport { doNotCreateExtraDirectory };\n// This module isn't loaded by the client-side of Server Routing => we don't include `urlToFile` to `./utils.ts`\nimport { urlToFile } from '../utils/urlToFile.js';\nconst pageContextJsonFileExtension = '.pageContext.json';\n// `/some-base-url/index.pageContext.json` instead of `/some-base-url.pageContext.json` in order to comply to common reverse proxy setups, see https://github.com/vikejs/vike/issues/443\nconst doNotCreateExtraDirectory = false;\n// See also node/renderPage/handlePageContextRequestUrl.ts\nfunction getPageContextRequestUrl(url) {\n    const pageContextRequestUrl = urlToFile(url, pageContextJsonFileExtension, doNotCreateExtraDirectory);\n    return pageContextRequestUrl;\n}\n","export { assertPageContextProvidedByUser };\nimport { assert, assertUsage, assertWarning, isObject } from './utils.js';\nimport pc from '@brillout/picocolors';\nfunction assertPageContextProvidedByUser(pageContextProvidedByUser, { hookName, hookFilePath, }) {\n    if (pageContextProvidedByUser === undefined || pageContextProvidedByUser === null)\n        return;\n    assert(!hookName.endsWith(')'));\n    const errPrefix = `The ${pc.cyan('pageContext')} object provided by the ${hookName}() hook defined by ${hookFilePath}`;\n    assertUsage(isObject(pageContextProvidedByUser), `${errPrefix} should be an object (but it's ${pc.cyan(`typeof pageContext === ${JSON.stringify(typeof pageContextProvidedByUser)}`)} instead)`);\n    assertUsage(!('isPageContext' in pageContextProvidedByUser), `${errPrefix} shouldn't be the whole ${pc.cyan('pageContext')} object, see https://vike.dev/pageContext-manipulation#do-not-return-entire-pagecontext`);\n    // In principle, it's possible to use onBeforeRoute()` to override and define the whole routing.\n    // Is that a good idea to allow users to do this? Beyond deep integration with Vue Router or React Router, is there a use case for this?\n    assertWarning(!('pageId' in pageContextProvidedByUser), `${errPrefix} sets ${pc.cyan('pageContext.pageId')} which means that Vike's routing is overridden. This is an experimental feature: make sure to contact a vike maintainer before using this.`, { onlyOnce: true });\n    assertUsage(!('is404' in pageContextProvidedByUser), `${errPrefix} sets ${pc.cyan('pageContext.is404')} which is forbidden, use ${pc.cyan('throw render()')} instead, see https://vike.dev/render`);\n}\n","export { assertHookReturnedObject };\nimport { assert, assertUsage, stringifyStringArray } from './utils.js';\nfunction assertHookReturnedObject(obj, keysExpected, errPrefix) {\n    assert(!errPrefix.endsWith(' '));\n    const keysUnknown = [];\n    const keys = Object.keys(obj);\n    for (const key of keys) {\n        if (!keysExpected.includes(key)) {\n            keysUnknown.push(key);\n        }\n    }\n    assertUsage(keysUnknown.length === 0, [\n        errPrefix,\n        'returned an object with following unknown keys:',\n        stringifyStringArray(keysUnknown) + '.',\n        'Only following keys are allowed:',\n        stringifyStringArray(keysExpected) + '.',\n    ].join(' '));\n}\n","export { assertOnBeforeRenderHookReturn };\nimport { assertUsage, isPlainObject } from './utils.js';\nimport { assertPageContextProvidedByUser } from './assertPageContextProvidedByUser.js';\nimport { assertHookReturnedObject } from './assertHookReturnedObject.js';\nimport pc from '@brillout/picocolors';\nfunction assertOnBeforeRenderHookReturn(hookReturnValue, hookFilePath) {\n    if (hookReturnValue === undefined || hookReturnValue === null) {\n        return;\n    }\n    const errPrefix = `The onBeforeRender() hook defined by ${hookFilePath}`;\n    assertUsage(isPlainObject(hookReturnValue), `${errPrefix} should return a plain JavaScript object, ${pc.cyan('undefined')}, or ${pc.cyan('null')}`);\n    assertHookReturnedObject(hookReturnValue, ['pageContext'], errPrefix);\n    if (hookReturnValue.pageContext) {\n        assertPageContextProvidedByUser(hookReturnValue['pageContext'], { hookName: 'onBeforeRender', hookFilePath });\n    }\n}\n","import { isPlainObject } from './isPlainObject.js';\nexport { isObjectWithKeys };\nfunction isObjectWithKeys(obj, keys) {\n    if (!isPlainObject(obj)) {\n        return false;\n    }\n    for (const key of Object.keys(obj)) {\n        if (!keys.includes(key)) {\n            return false;\n        }\n    }\n    return true;\n}\n","export { joinEnglish };\nimport { assert } from './assert.js';\n// https://stackoverflow.com/questions/53879088/join-an-array-by-commas-and-and/53879103#53879103\nfunction joinEnglish(arr, conjunction, colorizer = (s) => s) {\n    assert(arr.length > 0);\n    if (arr.length === 1)\n        return colorizer(arr[0]);\n    const firsts = arr.slice(0, arr.length - 1);\n    const last = arr[arr.length - 1];\n    const lastComma = arr.length > 2 ? ',' : '';\n    return firsts.map(colorizer).join(', ') + `${lastComma} ${conjunction} ` + colorizer(last);\n}\n","export { debug };\nexport { createDebugger };\nexport { isDebug };\nexport { isDebugActivated };\nimport { isCallable } from './isCallable.js';\nimport { objectAssign } from './objectAssign.js';\nimport { assert, assertUsage } from './assert.js';\nimport { getTerminalWidth } from './getTerminalWidth.js';\nimport pc from '@brillout/picocolors';\nimport { isArray } from './isArray.js';\nimport { isObject } from './isObject.js';\n// Assert tree-shaking (ensure this module is loaded on the client-side only if debug is enabled).\nassert(!globalThis.__VIKE__IS_CLIENT ||\n    globalThis.__VIKE__IS_DEBUG ||\n    // Vite doesn't do tree-shaking in dev (maybe it will with Rolldown?)\n    import.meta.env.DEV);\nconst flags = [\n    'vike',\n    'vike:crawl',\n    'vike:error',\n    'vike:esbuild-resolve',\n    'vike:pluginExtractAssets',\n    'vike:pluginExtractExportNames',\n    'vike:glob',\n    'vike:globalContext',\n    'vike:log',\n    'vike:optimizeDeps',\n    'vike:outDir',\n    'vike:pageFiles',\n    'vike:pointer-imports',\n    'vike:requireResolve',\n    'vike:routing',\n    'vike:setup',\n    'vike:stream',\n    'vike:virtualFiles',\n    'vike:vite-rpc',\n];\nconst flagsSkipWildcard = ['vike:log'];\n// We purposely read process.env.DEBUG early, in order to avoid users from the temptation to set process.env.DEBUG with JavaScript, since reading & writing process.env.DEBUG dynamically leads to inconsistencies such as https://github.com/vikejs/vike/issues/2239\nconst DEBUG = getDEBUG() ?? '';\nif (isDebug())\n    Error.stackTraceLimit = Infinity;\nassertFlagsActivated();\nfunction createDebugger(flag, optionsGlobal) {\n    assert(flags.includes(flag));\n    const debugWithOptions = (optionsLocal) => {\n        return (...msgs) => {\n            const options = { ...optionsGlobal, ...optionsLocal };\n            debug_(flag, options, ...msgs);\n        };\n    };\n    const debug = (...msgs) => debugWithOptions({})(...msgs);\n    objectAssign(debug, { options: debugWithOptions, isActivated: isDebugActivated(flag) });\n    return debug;\n}\nfunction debug(flag, ...msgs) {\n    return debug_(flag, {}, ...msgs);\n}\nfunction debug_(flag, options, ...msgs) {\n    if (!isDebugActivated(flag))\n        return;\n    let [msgFirst, ...msgsRest] = msgs;\n    const padding = ' '.repeat(flag.length + 1);\n    msgFirst = formatMsg(msgFirst, options, padding, 'FIRST');\n    msgsRest = msgsRest.map((msg, i) => {\n        const position = i === msgsRest.length - 1 ? 'LAST' : 'MIDDLE';\n        return formatMsg(msg, options, padding, position);\n    });\n    let logFirst;\n    let logsRest;\n    const noNewLine = msgsRest.length <= 1 &&\n        [msgFirst, ...msgsRest].every((m) => (typeof m === 'string' ? !m.includes('\\n') : !isObject(m)));\n    if (noNewLine) {\n        logFirst = [msgFirst, ...msgsRest].map((m) => (typeof m !== 'string' ? m : m.trim()));\n        logsRest = [];\n    }\n    else {\n        logFirst = [msgFirst];\n        logsRest = msgsRest;\n    }\n    console.log('\\x1b[1m%s\\x1b[0m', flag, ...logFirst);\n    logsRest.forEach((msg) => {\n        console.log(msg);\n    });\n}\nfunction isDebugActivated(flag) {\n    assert(flags.includes(flag));\n    const { flagsActivated, isAll } = getFlagsActivated();\n    const isActivated = flagsActivated.includes(flag) || (isAll && !flagsSkipWildcard.includes(flag));\n    return isActivated;\n}\nfunction formatMsg(info, options, padding, position) {\n    if (info === undefined) {\n        return undefined;\n    }\n    let str = position === 'FIRST' ? '' : padding;\n    if (typeof info === 'string') {\n        str += info;\n    }\n    else if (isArray(info)) {\n        if (info.length === 0) {\n            str += options.serialization?.emptyArray ?? '[]';\n        }\n        else {\n            str += info.map(strUnknown).join('\\n');\n        }\n    }\n    else {\n        str += strUnknown(info);\n    }\n    str = pad(str, padding);\n    if (position !== 'LAST' && position !== 'FIRST') {\n        str += '\\n';\n    }\n    return str;\n}\nfunction pad(str, padding) {\n    const terminalWidth = getTerminalWidth();\n    const lines = [];\n    str.split('\\n').forEach((line) => {\n        if (!terminalWidth) {\n            lines.push(line);\n        }\n        else {\n            chunk(line, terminalWidth - padding.length).forEach((chunk) => {\n                lines.push(chunk);\n            });\n        }\n    });\n    return lines.join('\\n' + padding);\n}\nfunction chunk(str, size) {\n    if (str.length <= size) {\n        return [str];\n    }\n    const chunks = str.match(new RegExp('.{1,' + size + '}', 'g'));\n    assert(chunks);\n    return chunks;\n}\nfunction strUnknown(thing) {\n    return typeof thing === 'string' ? thing : strObj(thing);\n}\nfunction strObj(obj, newLines = true) {\n    return JSON.stringify(obj, replaceFunctionSerializer, newLines ? 2 : undefined);\n}\nfunction replaceFunctionSerializer(_key, value) {\n    if (isCallable(value)) {\n        return value.toString().split(/\\s+/).join(' ');\n    }\n    return value;\n}\nfunction assertFlagsActivated() {\n    const { flagsActivated } = getFlagsActivated();\n    flagsActivated.forEach((flag) => {\n        assertUsage(flags.includes(flag), `Unknown DEBUG flag ${pc.cyan(flag)}. Valid flags:\\n${flags.map((f) => `  ${pc.cyan(f)}`).join('\\n')}`);\n    });\n}\nfunction getFlagsActivated() {\n    const flagsActivated = DEBUG.match(/\\bvike:[a-zA-Z-]+/g) ?? [];\n    const isAll = DEBUG.includes('vike:*');\n    const isGlobal = /\\bvike\\b([^:]|$)/.test(DEBUG);\n    return { flagsActivated, isAll, isGlobal };\n}\nfunction isDebug() {\n    const { flagsActivated, isAll, isGlobal } = getFlagsActivated();\n    return isAll || flagsActivated.length > 0 || isGlobal;\n}\nfunction getDEBUG() {\n    let DEBUG;\n    // ssr.noExternal\n    /* // Full implementation:\n       // - https://github.com/vikejs/vike/commit/7637564a98f43e23834bcae2f7ada8d941958a34\n       // - https://github.com/vikejs/vike/pull/2718\n       // - We don't implement this yet because it crashes @cloudflare/vite-plugin\n    if (import.meta.env) {\n      return import.meta.env.DEBUG\n    }\n    //*/\n    // ssr.external\n    // - `process` can be undefined in edge workers\n    // - We want bundlers to be able to statically replace `process.env.*`\n    try {\n        DEBUG = process.env.DEBUG;\n    }\n    catch { }\n    return DEBUG;\n}\n","// Utils needed by:\n//  - runtime of server\n//  - runtime of client (Client Routing)\n// Ensure we don't bloat runtime of Server Routing with the utils down below\nimport { assertClientRouting } from '../../utils/assertRoutingType.js';\nimport { isBrowser } from '../../utils/isBrowser.js';\nif (isBrowser()) {\n    assertClientRouting();\n}\nexport * from '../../utils/assert.js';\nexport * from '../../utils/hasProp.js';\nexport * from '../../utils/isObjectWithKeys.js';\nexport * from '../../utils/sorter.js';\nexport * from '../../utils/isPromise.js';\nexport * from '../../utils/isPlainObject.js';\nexport * from '../../utils/objectAssign.js';\nexport * from '../../utils/slice.js';\nexport * from '../../utils/unique.js';\nexport * from '../../utils/isBrowser.js';\nexport * from '../../utils/parseUrl.js';\nexport * from '../../utils/checkType.js';\nexport * from '../../utils/joinEnglish.js';\nexport * from '../../utils/truncateString.js';\nexport * from '../../utils/isCallable.js';\nexport * from '../../utils/debug.js';\n","export { execHookGuard };\nimport { getHookFromPageContext, getHookTimeoutDefault } from '../hooks/getHook.js';\nimport { assert, assertUsage, isCallable } from './utils.js';\nimport { execHookDirectSingle } from '../hooks/execHook.js';\nconst errIntro = 'The guard() hook defined by';\nasync function execHookGuard(pageContext, prepareForPublicUsage) {\n    let hook;\n    if (pageContext._globalContext._pageFilesAll.length > 0) {\n        // TO-DO/next-major-release: remove\n        // V0.4 design\n        assert(pageContext._globalContext._pageConfigs.length === 0);\n        hook = findPageGuard(pageContext.pageId, pageContext._globalContext._pageFilesAll);\n    }\n    else {\n        // V1 design\n        hook = getHookFromPageContext(pageContext, 'guard');\n    }\n    if (!hook)\n        return;\n    await execHookDirectSingle(hook, pageContext, prepareForPublicUsage);\n}\nfunction findPageGuard(pageId, pageFilesAll) {\n    const pageRouteFile = pageFilesAll.find((p) => p.pageId === pageId && p.fileType === '.page.route');\n    if (!pageRouteFile)\n        return null;\n    const { filePath, fileExports } = pageRouteFile;\n    assert(fileExports); // loadPageRoutes() should already have been called\n    const hookFn = fileExports.guard;\n    if (!hookFn)\n        return null;\n    const hookFilePath = filePath;\n    const hookTimeout = getHookTimeoutDefault('guard');\n    assertUsage(isCallable(hookFn), `${errIntro} ${hookFilePath} should be a function`);\n    return { hookFn, hookName: 'guard', hookFilePath, hookTimeout };\n}\n","export { redirect };\nexport { render };\nexport { RenderErrorPage };\nexport { isAbortError };\nexport { isAbortPageContext };\nexport { logAbortErrorHandled };\nexport { getPageContextFromAllRewrites };\nexport { AbortRender };\nexport { assertNoInfiniteAbortLoop };\nimport { isUserHookError } from '../hooks/execHook.js';\nimport { assert, assertInfo, assertUsage, assertUsageUrlPathAbsolute, assertUsageUrlRedirectTarget, assertWarning, checkType, hasProp, isBrowser, joinEnglish, objectAssign, truncateString, } from './utils.js';\nimport pc from '@brillout/picocolors';\n/**\n * Abort the rendering of the current page, and redirect the user to another URL instead.\n *\n * https://vike.dev/redirect\n *\n * @param url The URL to redirect to.\n * @param statusCode By default a temporary redirection (`302`) is performed. For permanent redirections (`301`), use `config.redirects` https://vike.dev/redirects instead or, alternatively, set the `statusCode` argument to `301`.\n */\nfunction redirect(url, statusCode) {\n    const abortCaller = 'throw redirect()';\n    assertUsageUrlRedirectTarget(url, getErrPrefix(abortCaller));\n    const args = [JSON.stringify(url)];\n    if (!statusCode) {\n        statusCode = 302;\n    }\n    else {\n        if (\n        // Tree-shaking to save client-side KBs\n        !globalThis.__VIKE__IS_CLIENT ||\n            globalThis.__VIKE__IS_DEV ||\n            globalThis.__VIKE__IS_DEBUG) {\n            assertStatusCode(statusCode, [301, 302], 'redirect');\n        }\n        args.push(String(statusCode));\n    }\n    const pageContextAbort = {};\n    objectAssign(pageContextAbort, {\n        _abortCaller: abortCaller,\n        _abortCall: `redirect(${args.join(', ')})`,\n        _urlRedirect: {\n            url,\n            statusCode,\n        },\n    });\n    return AbortRender(pageContextAbort);\n}\nfunction render(urlOrStatusCode, abortReason) {\n    const args = [typeof urlOrStatusCode === 'number' ? String(urlOrStatusCode) : JSON.stringify(urlOrStatusCode)];\n    if (abortReason !== undefined)\n        args.push(truncateString(JSON.stringify(abortReason), 30));\n    const abortCaller = 'throw render()';\n    const abortCall = `render(${args.join(', ')})`;\n    return render_(urlOrStatusCode, abortReason, abortCall, abortCaller);\n}\nfunction render_(urlOrStatusCode, abortReason, abortCall, abortCaller, pageContextAddendum) {\n    const pageContextAbort = {\n        abortReason,\n        _abortCaller: abortCaller,\n        _abortCall: abortCall,\n    };\n    if (pageContextAddendum) {\n        assert(pageContextAddendum._isLegacyRenderErrorPage === true);\n        objectAssign(pageContextAbort, pageContextAddendum);\n    }\n    if (typeof urlOrStatusCode === 'string') {\n        const url = urlOrStatusCode;\n        assertUsageUrlPathAbsolute(url, getErrPrefix(abortCaller));\n        objectAssign(pageContextAbort, {\n            _urlRewrite: url,\n        });\n        return AbortRender(pageContextAbort);\n    }\n    else {\n        if (\n        // Tree-shaking to save client-side KBs\n        !globalThis.__VIKE__IS_CLIENT ||\n            globalThis.__VIKE__IS_DEV ||\n            globalThis.__VIKE__IS_DEBUG) {\n            assertStatusCode(urlOrStatusCode, [401, 403, 404, 410, 429, 500, 503], 'render');\n        }\n        const abortStatusCode = urlOrStatusCode;\n        objectAssign(pageContextAbort, {\n            abortStatusCode,\n            is404: abortStatusCode === 404,\n        });\n        return AbortRender(pageContextAbort);\n    }\n}\nfunction AbortRender(pageContextAbort) {\n    const err = new Error('AbortRender');\n    objectAssign(err, { _pageContextAbort: pageContextAbort, [stamp]: true });\n    checkType(err);\n    return err;\n}\n// TO-DO/next-major-release: remove\n/**\n * @deprecated Use `throw render()` or `throw redirect()` instead, see https://vike.dev/render'\n */\nfunction RenderErrorPage({ pageContext = {} } = {}) {\n    assertWarning(false, `${pc.cyan('throw RenderErrorPage()')} is deprecated and will be removed in the next major release. Use ${pc.cyan('throw render()')} or ${pc.cyan('throw redirect()')} instead, see https://vike.dev/render`, { onlyOnce: false });\n    let abortStatusCode = 404;\n    let abortReason = 'Page Not Found';\n    if (pageContext.is404 === false || pageContext.pageProps?.is404 === false) {\n        abortStatusCode = 500;\n        abortReason = 'Something went wrong';\n    }\n    objectAssign(pageContext, { _isLegacyRenderErrorPage: true });\n    return render_(abortStatusCode, abortReason, 'RenderErrorPage()', 'throw RenderErrorPage()', pageContext);\n}\nconst stamp = '_isAbortError';\nfunction isAbortError(thing) {\n    return typeof thing === 'object' && thing !== null && stamp in thing;\n}\nfunction isAbortPageContext(pageContext) {\n    if (!(pageContext._urlRewrite || pageContext._urlRedirect || pageContext.abortStatusCode)) {\n        return false;\n    }\n    assert(hasProp(pageContext, '_abortCall', 'string'));\n    /* Isn't needed and is missing on the client-side\n    assert(hasProp(pageContext, '_abortCaller', 'string'))\n    */\n    checkType(pageContext);\n    return true;\n}\nfunction logAbortErrorHandled(err, isProduction, pageContext) {\n    if (isProduction)\n        return;\n    const urlCurrent = pageContext._urlRewrite ?? pageContext.urlOriginal;\n    assert(urlCurrent);\n    const abortCall = err._pageContextAbort._abortCall;\n    assert(abortCall);\n    const hookLoc = isUserHookError(err);\n    let thrownBy = '';\n    if (hookLoc) {\n        thrownBy = ` by ${pc.cyan(`${hookLoc.hookName}()`)} hook defined at ${hookLoc.hookFilePath}`;\n    }\n    else {\n        // hookLoc is missing when serializing abort errors from server to client\n    }\n    assertInfo(false, `${pc.cyan(abortCall)} thrown${thrownBy} while rendering ${pc.cyan(urlCurrent)}`, {\n        onlyOnce: false,\n    });\n}\nfunction assertStatusCode(statusCode, expected, caller) {\n    assert(!globalThis.__VIKE__IS_CLIENT || globalThis.__VIKE__IS_DEV || globalThis.__VIKE__IS_DEBUG); // assert tree-shaking\n    // double check vike:pluginReplaceConstantsGlobalThis\n    if (globalThis.__VIKE__IS_CLIENT) {\n        assert(isBrowser());\n        assert(typeof globalThis.__VIKE__IS_DEV === 'boolean');\n        assert(typeof globalThis.__VIKE__IS_CLIENT === 'boolean');\n        assert(import.meta.env.SSR === false);\n        assert(import.meta.env.DEV === globalThis.__VIKE__IS_DEV);\n    }\n    else {\n        assert(!isBrowser());\n        if (import.meta.env) {\n            assert(typeof globalThis.__VIKE__IS_DEV === 'boolean');\n            assert(typeof globalThis.__VIKE__IS_CLIENT === 'boolean');\n            assert(import.meta.env.SSR === true);\n            assert(import.meta.env.DEV === globalThis.__VIKE__IS_DEV);\n        }\n        else {\n            // import.meta.env isn't defined when 'vike' is ssr.external\n        }\n    }\n    const expectedEnglish = joinEnglish(expected.map((s) => pc.bold(String(s))), 'or');\n    const statusCodeWithColor = pc.bold(String(statusCode));\n    if (statusCode === 400) {\n        assert(!expected.includes(statusCode));\n        assertWarning(false, `We recommend against using the status code ${statusCodeWithColor} passed to ${caller}() — we recommend using ${pc.bold('404')} instead, see https://github.com/vikejs/vike/issues/1008#issuecomment-3270894445`, { onlyOnce: true, showStackTrace: true });\n    }\n    else {\n        assertWarning(expected.includes(statusCode), `Unexpected status code ${statusCodeWithColor} passed to ${caller}() — we recommend using ${expectedEnglish} instead. (Or reach out at https://github.com/vikejs/vike/issues/1008 if you believe ${statusCodeWithColor} should be added.)`, { onlyOnce: true, showStackTrace: true });\n    }\n}\nfunction getPageContextFromAllRewrites(pageContextsFromRewrite) {\n    assertNoInfiniteLoop(pageContextsFromRewrite);\n    const pageContextFromAllRewrites = { _urlRewrite: null };\n    pageContextsFromRewrite.forEach((pageContextFromRewrite) => {\n        Object.assign(pageContextFromAllRewrites, pageContextFromRewrite);\n    });\n    return pageContextFromAllRewrites;\n}\nfunction assertNoInfiniteLoop(pageContextsFromRewrite) {\n    const urlRewrites = [];\n    pageContextsFromRewrite.forEach((pageContext) => {\n        const urlRewrite = pageContext._urlRewrite;\n        {\n            const idx = urlRewrites.indexOf(urlRewrite);\n            if (idx !== -1) {\n                const loop = [...urlRewrites.slice(idx), urlRewrite].map((url) => `render('${url}')`).join(' => ');\n                assertUsage(false, `Infinite loop of render() calls: ${loop}`);\n            }\n        }\n        urlRewrites.push(urlRewrite);\n    });\n}\nfunction assertNoInfiniteAbortLoop(rewriteCount, redirectCount) {\n    const abortCalls = [\n        // prettier-ignore\n        // biome-ignore format:\n        rewriteCount > 0 && pc.cyan(\"throw render('/some-url')\"),\n        redirectCount > 0 && pc.cyan(\"throw redirect('/some-url')\"),\n    ]\n        .filter(Boolean)\n        .join(' and ');\n    assertUsage(rewriteCount + redirectCount <= 7, `Maximum chain length of 7 ${abortCalls} exceeded. Did you define an infinite loop of ${abortCalls}?`);\n}\nfunction getErrPrefix(abortCaller) {\n    return `URL passed to ${pc.code(abortCaller)}`;\n}\n","export const pageContextInitIsPassedToClient = '_pageContextInitIsPassedToClient';\n","export const isServerSideError = '_isServerSideError';\n","export { preparePageContextForPublicUsageClientShared };\nexport { preparePageContextForPublicUsageClientMinimal };\nimport { objectAssign } from '../runtime-server-routing/utils.js';\nimport { assertPropertyGetters, preparePageContextForPublicUsage, } from '../../shared/preparePageContextForPublicUsage.js';\nfunction preparePageContextForPublicUsageClientShared(pageContext) {\n    // TO-DO/soon/proxy: use proxy\n    const Page = pageContext.config?.Page ||\n        // TO-DO/next-major-release: remove\n        pageContext.exports?.Page;\n    objectAssign(pageContext, { Page });\n    // TO-DO/next-major-release: after we remove supportVueReactiviy() we can call this later inside the agnostic preparePageContextForPublicUsage()\n    assertPropertyGetters(pageContext);\n    // TO-DO/next-major-release: remove\n    // - Requires https://github.com/vikejs/vike-vue/issues/198\n    // - Last time I tried to remove it (https://github.com/vikejs/vike/commit/705fd23598d9d69bf46a52c8550216cd7117ce71) the tests were failing as expected: only the Vue integrations that used shallowReactive() failed.\n    supportVueReactiviy(pageContext);\n    return preparePageContextForPublicUsageClientMinimal(pageContext);\n}\nfunction preparePageContextForPublicUsageClientMinimal(pageContext) {\n    const pageContextPublic = preparePageContextForPublicUsage(pageContext);\n    return pageContextPublic;\n}\n// With Vue + Client Routing, the `pageContext` is made reactive:\n// ```js\n// import { reactive } from 'vue'\n// // See /examples/vue-full/renderer/createVueApp.ts\n// const pageContextReactive = reactive(pageContext)\n// ```\nfunction supportVueReactiviy(pageContext) {\n    resolveGetters(pageContext);\n}\n// Remove property descriptor getters because they break Vue's reactivity.\n// E.g. resolve the `pageContext.urlPathname` getter.\nfunction resolveGetters(pageContext) {\n    Object.entries(pageContext).forEach(([key, val]) => {\n        delete pageContext[key];\n        pageContext[key] = val;\n    });\n}\n","export { preparePageContextForPublicUsageClient };\nimport { preparePageContextForPublicUsageClientShared } from '../shared/preparePageContextForPublicUsageClientShared.js';\nfunction preparePageContextForPublicUsageClient(pageContext) {\n    return preparePageContextForPublicUsageClientShared(pageContext);\n}\n","export { getPageContextFromHooks_isHydration };\nexport { getPageContextFromHooks_serialized };\nexport { getPageContextFromServerHooks };\nexport { getPageContextFromClientHooks };\nexport { setPageContextInitIsPassedToClient };\nexport { execHookClient };\nimport { assert, assertUsage, hasProp, objectAssign, getProjectError, redirectHard, isObject, getGlobalObject, } from './utils.js';\nimport { parse } from '@brillout/json-serializer/parse';\nimport { getPageContextSerializedInHtml } from '../shared/getJsonSerializedInHtml.js';\nimport { analyzePageServerSide } from '../../shared/getPageFiles/analyzePageServerSide.js';\nimport { removeBuiltInOverrides } from './getPageContext/removeBuiltInOverrides.js';\nimport { getPageContextRequestUrl } from '../../shared/getPageContextRequestUrl.js';\nimport { getPageConfig } from '../../shared/page-configs/helpers.js';\nimport { getConfigValueRuntime } from '../../shared/page-configs/getConfigValueRuntime.js';\nimport { assertOnBeforeRenderHookReturn } from '../../shared/assertOnBeforeRenderHookReturn.js';\nimport { execHookGuard } from '../../shared/route/execHookGuard.js';\nimport { AbortRender, isAbortPageContext } from '../../shared/route/abort.js';\nimport { pageContextInitIsPassedToClient } from '../../shared/misc/pageContextInitIsPassedToClient.js';\nimport { isServerSideError } from '../../shared/misc/isServerSideError.js';\nimport { execHook } from '../../shared/hooks/execHook.js';\nimport { preparePageContextForPublicUsageClient, } from './preparePageContextForPublicUsageClient.js';\nconst globalObject = getGlobalObject('runtime-client-routing/getPageContextFromHooks.ts', {});\n// TO-DO/eventually: rename\nfunction getPageContextFromHooks_serialized() {\n    const pageContextSerialized = getPageContextSerializedInHtml();\n    processPageContextFromServer(pageContextSerialized);\n    objectAssign(pageContextSerialized, {\n        _hasPageContextFromServer: true,\n    });\n    return pageContextSerialized;\n}\n// TO-DO/eventually: rename\nasync function getPageContextFromHooks_isHydration(pageContext) {\n    for (const hookName of ['data', 'onBeforeRender']) {\n        // TO-DO/soon/cumulative-hooks: filter & execute all client-only hooks\n        // - The client-side needs to know what hooks are client-only\n        //   - Possible implementation: new computed prop `clientOnlyHooks: string[]` (list of hook ids) and add `hookId` to serialized config values\n        if (hookClientOnlyExists(hookName, pageContext)) {\n            await execHookDataLike(hookName, pageContext);\n        }\n    }\n    return pageContext;\n}\nasync function getPageContextFromServerHooks(pageContext, isErrorPage) {\n    const pageContextFromServerHooks = {\n        _hasPageContextFromServer: false,\n    };\n    // If pageContextInit has some client data or if one of the hooks guard(), data() or onBeforeRender() is server-side\n    // only, then we need to fetch pageContext from the server.\n    // We do it before executing any client-side hook, because it contains pageContextInit which may be needed for guard() / data() / onBeforeRender(), for example pageContextInit.user is crucial for guard()\n    if (\n    // For the error page, we cannot fetch pageContext from the server because the pageContext JSON request is based on the URL\n    !isErrorPage &&\n        // true if pageContextInit has some client data or at least one of the data() and onBeforeRender() hooks is server-side only:\n        (await hasPageContextServer(pageContext))) {\n        const res = await fetchPageContextFromServer(pageContext);\n        if ('is404ServerSideRouted' in res)\n            return { is404ServerSideRouted: true };\n        const { pageContextFromServer } = res;\n        pageContextFromServerHooks._hasPageContextFromServer = true;\n        // Already handled\n        assert(!(isServerSideError in pageContextFromServer));\n        assert(!('serverSideError' in pageContextFromServer));\n        objectAssign(pageContextFromServerHooks, pageContextFromServer);\n    }\n    // We cannot return the whole pageContext because this function is used for prefetching `pageContext` (which requires a partial pageContext to be merged with the future pageContext created upon rendering the page in the future).\n    return { pageContextFromServerHooks };\n}\nasync function getPageContextFromClientHooks(pageContext, isErrorPage) {\n    let dataHookExecuted = false;\n    // At this point, we need to call the client-side guard(), data() and onBeforeRender() hooks, if they exist on client\n    // env. However if we have fetched pageContext from the server, some of them might have run already on the\n    // server-side, so we run only the client-only ones in this case.\n    // Note: for the error page, we also execute the client-side data() and onBeforeRender() hooks, but maybe we\n    // shouldn't? The server-side does it as well (but maybe it shouldn't).\n    for (const hookName of ['guard', 'data', 'onBeforeRender']) {\n        if (hookName === 'guard') {\n            if (!isErrorPage &&\n                // We don't need to call guard() on the client-side if we fetch pageContext from the server side. (Because the `${url}.pageContext.json` HTTP request will already trigger the routing and guard() hook on the server-side.)\n                !pageContext._hasPageContextFromServer) {\n                // Should we really call the guard() hook on the client-side? Shouldn't we make the guard() hook a server-side\n                // only hook? Or maybe make its env configurable like data() and onBeforeRender()?\n                await execHookGuard(pageContext, (pageContext) => preparePageContextForPublicUsageClient(pageContext));\n            }\n        }\n        else {\n            // TO-DO/soon/cumulative-hooks: filter & execute all client-only hooks (see other TO-DO/soon/cumulative-hooks entries)\n            if (hookClientOnlyExists(hookName, pageContext) || !pageContext._hasPageContextFromServer) {\n                if (hookName === 'data')\n                    dataHookExecuted = true;\n                // This won't do anything if no hook has been defined or if the hook's env.client is false.\n                await execHookDataLike(hookName, pageContext);\n            }\n        }\n    }\n    // Execute +onData\n    const dataHookEnv = getHookEnv('data', pageContext);\n    if ((dataHookExecuted && dataHookEnv.client) || (pageContext._hasPageContextFromServer && dataHookEnv.server)) {\n        await execHookClient('onData', pageContext);\n    }\n    const pageContextFromClientHooks = pageContext;\n    return pageContextFromClientHooks;\n}\nasync function execHookClient(hookName, pageContext) {\n    return await execHook(hookName, pageContext, (p) => preparePageContextForPublicUsageClient(p));\n}\nasync function execHookDataLike(hookName, pageContext) {\n    let pageContextFromHook;\n    if (hookName === 'data') {\n        pageContextFromHook = await execHookData(pageContext);\n    }\n    else {\n        pageContextFromHook = await execHookOnBeforeRender(pageContext);\n    }\n    Object.assign(pageContext, pageContextFromHook);\n}\nasync function execHookData(pageContext) {\n    const res = await execHookClient('data', pageContext);\n    const hook = res[0]; // TO-DO/soon/cumulative-hooks: support cumulative\n    if (!hook)\n        return;\n    const { hookReturn } = hook;\n    const pageContextAddendum = { data: hookReturn };\n    return pageContextAddendum;\n}\nasync function execHookOnBeforeRender(pageContext) {\n    const res = await execHookClient('onBeforeRender', pageContext);\n    const hook = res[0]; // TO-DO/soon/cumulative-hooks: support cumulative\n    if (!hook)\n        return;\n    const { hookReturn, hookFilePath } = hook;\n    const pageContextFromHook = {};\n    assertOnBeforeRenderHookReturn(hookReturn, hookFilePath);\n    // Note: hookReturn looks like { pageContext: { ... } }\n    const pageContextFromOnBeforeRender = hookReturn?.pageContext;\n    if (pageContextFromOnBeforeRender) {\n        objectAssign(pageContextFromHook, pageContextFromOnBeforeRender);\n    }\n    return pageContextFromHook;\n}\n// Workaround for the fact that the client-side cannot known whether a pageContext JSON request is needed in order to fetch pageContextInit data passed to the client.\n//  - The workaround is reliable as long as the user sets additional pageContextInit to undefined instead of not defining the property:\n//    ```diff\n//    - // Breaks the workaround:\n//    - const pageContextInit = { urlOriginal: req.url }\n//    - if (user) pageContextInit.user = user\n//    + // Makes the workaround reliable:\n//    + const pageContextInit = { urlOriginal: req.url, user }\n//    ```\n// - We can show a warning to users when the pageContextInit keys aren't always the same. (We didn't implement the waning yet because it would require a new doc page https://vike.dev/pageContextInit#avoid-conditional-properties\n// - Workaround cannot be made completely reliable because the workaround assumes that passToClient is always the same, but the user may set a different passToClient value for another page\n// - Alternatively, we could define a new config `alwaysFetchPageContextFromServer: boolean`\nfunction setPageContextInitIsPassedToClient(pageContext) {\n    if (pageContext[pageContextInitIsPassedToClient]) {\n        globalObject.pageContextInitIsPassedToClient = true;\n    }\n}\n// TO-DO/next-major-release: make it sync\nasync function hasPageContextServer(pageContext) {\n    if (isOldDesign(pageContext)) {\n        const { hasOnBeforeRenderServerSideOnlyHook } = await analyzePageServerSide(pageContext._pageFilesAll, pageContext.pageId);\n        // data() hooks didn't exist in the V0.4 design\n        return hasOnBeforeRenderServerSideOnlyHook;\n    }\n    return !!globalObject.pageContextInitIsPassedToClient || hasServerOnlyHook(pageContext);\n}\nfunction hasServerOnlyHook(pageContext) {\n    if (isOldDesign(pageContext))\n        return false;\n    const pageConfig = getPageConfig(pageContext.pageId, pageContext._globalContext._pageConfigs);\n    const val = getConfigValueRuntime(pageConfig, `hasServerOnlyHook`)?.value;\n    assert(val === true || val === false);\n    return val;\n}\nfunction hookClientOnlyExists(hookName, pageContext) {\n    const hookEnv = getHookEnv(hookName, pageContext);\n    return !!hookEnv.client && !hookEnv.server;\n}\nfunction getHookEnv(hookName, pageContext) {\n    if (isOldDesign(pageContext)) {\n        // Client-only onBeforeRender() or data() hooks were never supported for the V0.4 design\n        return { client: false, server: true };\n    }\n    const pageConfig = getPageConfig(pageContext.pageId, pageContext._globalContext._pageConfigs);\n    // No runtime validation to save client-side KBs\n    const hookEnv = (getConfigValueRuntime(pageConfig, `${hookName}Env`)?.value ?? {});\n    return hookEnv;\n}\nasync function fetchPageContextFromServer(pageContext) {\n    let pageContextUrl = getPageContextRequestUrl(pageContext._urlRewrite ?? pageContext.urlOriginal);\n    /* TO-DO/soon/once: pass & use previousUrl\n    pageContextUrl = modifyUrlSameOrigin(pageContextUrl, { search: { _vike: JSON.stringify({ previousUrl: pageContext.previousPageContext.urlOriginal }) } })\n    */\n    const response = await fetch(pageContextUrl);\n    {\n        const contentType = response.headers.get('content-type');\n        const contentTypeCorrect = 'application/json';\n        const isCorrect = contentType && contentType.includes(contentTypeCorrect);\n        // Static hosts + page doesn't exist\n        if (!isCorrect && response.status === 404) {\n            redirectHard(pageContext.urlOriginal);\n            return { is404ServerSideRouted: true };\n        }\n        assertUsage(isCorrect, `Wrong Content-Type for ${pageContextUrl}: it should be ${contentTypeCorrect} but it's ${contentType} instead. Make sure to properly use pageContext.httpResponse.headers, see https://vike.dev/renderPage`);\n    }\n    const responseText = await response.text();\n    const pageContextFromServer = parse(responseText);\n    assert(isObject(pageContextFromServer));\n    if (isAbortPageContext(pageContextFromServer)) {\n        throw AbortRender(pageContextFromServer);\n    }\n    // Is there a reason for having two different properties? Can't we use only one property? I guess/think the isServerSideError property was an attempt (a bad idea really) for rendering the error page even though an error occurred on the server-side (which is a bad idea because the added complexity is non-negligible while the added value is minuscule since the error page usually doesn't have any (meaningful / server-side) hooks).\n    if ('serverSideError' in pageContextFromServer || isServerSideError in pageContextFromServer) {\n        throw getProjectError(`pageContext couldn't be fetched because an error occurred on the server-side`);\n    }\n    processPageContextFromServer(pageContextFromServer);\n    return { pageContextFromServer };\n}\nfunction processPageContextFromServer(pageContext) {\n    assertUsage(!('urlOriginal' in pageContext), \"Adding 'urlOriginal' to passToClient is forbidden\");\n    assert(hasProp(pageContext, 'pageId', 'string'));\n    removeBuiltInOverrides(pageContext);\n}\n// TO-DO/next-major-release: remove\nfunction isOldDesign(pageContext) {\n    return pageContext._globalContext._pageConfigs.length === 0;\n}\n","export { createPageContextShared };\nexport { createPageContextObject };\nimport { changeEnumerable, objectAssign } from './utils.js';\nfunction createPageContextShared(pageContextCreated, globalConfigPublic) {\n    objectAssign(pageContextCreated, globalConfigPublic);\n    return pageContextCreated;\n}\nfunction createPageContextObject() {\n    const pageContext = {\n        _isOriginalObject: true,\n        isPageContext: true,\n    };\n    changeEnumerable(pageContext, '_isOriginalObject', false);\n    return pageContext;\n}\n","export { getPageContextUrlComputed };\n// =====================\n// File determining the URL logic.\n// URLs need to be computed, because the user can modify the URL e.g. with onBeforeRoute() for i18n.\n// =====================\nimport { objectDefineProperty } from '../utils/objectDefineProperty.js';\nimport { assertPropertyGetters } from './preparePageContextForPublicUsage.js';\nimport { assert, parseUrl, assertWarning, isBrowser, changeEnumerable } from './utils.js';\nfunction getPageContextUrlComputed(pageContext) {\n    assert(typeof pageContext.urlOriginal === 'string');\n    assertPropertyGetters(pageContext);\n    const pageContextUrlComputed = {};\n    objectDefineProperty(pageContextUrlComputed, 'urlPathname', {\n        get: urlPathnameGetter,\n        enumerable: true,\n        configurable: true,\n    });\n    objectDefineProperty(pageContextUrlComputed, 'url', {\n        get: urlGetter,\n        enumerable: false,\n        configurable: true,\n    });\n    objectDefineProperty(pageContextUrlComputed, 'urlParsed', {\n        get: urlParsedGetter,\n        enumerable: true,\n        configurable: true,\n    });\n    return pageContextUrlComputed;\n}\nfunction getUrlParsed(pageContext) {\n    // Example of i18n app using `throw render()`:\n    //  1. User goes to '/fr-FR/admin'.\n    //  2. The first onBeforeRoute() call accesses pageContext.urlPathname (its value is '/fr-FR/admin': the pathname of pageContext.urlOriginal, since both pageContext.urlLogical and pageContext._urlRewrite are undefined) and sets pageContext.urlLogical to '/admin'.\n    //  3. A guard() hooks accesses pageContext.urlPathname (its value is '/admin': the pathname of pageContext.urlLogical) and calls `throw render('/fr-FR/login')`\n    //  4. Vike create a new pageContext object (pageContext.urlLogical is erased) and sets pageContext._urlRewrite to '/fr-FR/login'. (While pageContext.urlOriginal is still '/fr-FR/admin'.)\n    //  5. The second onBeforeRoute() call accesses pageContext.urlPathname (its value is '/fr-FR/login': the pathname of pageContext._urlRewrite, since pageContext.urlLogical is undefined) and sets pageContext.urlLogical to '/login'.\n    //  6. The value of pageContext.urlPathname is now '/login': the pathname of `pageContext.urlLogical`. (While pageContext.urlOriginal is still '/fr-FR/admin'.)\n    // Reproduction: https://github.com/vikejs/vike/discussions/1436#discussioncomment-8142023\n    // Determine logical URL\n    const assertUrlResolved = (src) => assert(typeof urlResolved === 'string', \n    // TO-DO/eventually: remove debug logs, see:\n    // - https://github.com/vikejs/vike/issues/2138#issuecomment-2631713411\n    // - https://github.com/vikejs/vike/commit/5c7810f3080ab62536950f26e019bb2a3a517082\n    { src, urlResolved });\n    let urlResolved;\n    let isBaseToBeRemoved;\n    if (pageContext.urlLogical) {\n        // Set by onBeforeRoute()\n        urlResolved = pageContext.urlLogical;\n        isBaseToBeRemoved = false;\n        assertUrlResolved(1);\n    }\n    else if (pageContext._urlRewrite) {\n        // Set by `throw render()`\n        urlResolved = pageContext._urlRewrite;\n        isBaseToBeRemoved = false;\n        assertUrlResolved(2);\n    }\n    else {\n        // Set by renderPage()\n        urlResolved = pageContext.urlOriginal;\n        isBaseToBeRemoved = true;\n        assertUrlResolved(3);\n    }\n    assertUrlResolved(4);\n    // Remove .pageContext.json\n    let urlHandler = pageContext._urlHandler;\n    if (!urlHandler)\n        urlHandler = (url) => url;\n    urlResolved = urlHandler(urlResolved);\n    // Remove Base URL.\n    // - We assume there isn't any Base URL to the URLs set by the user at `throw render()` and onBeforeRoute()\n    //   - This makes sense because the Base URL is merely a setting: ideally the user should write code that doesn't know anything about it (so that the user can remove/add/change Base URL without having to modify any code).\n    // - pageContext.urlOriginal is the URL of the HTTP request and thus contains the Base URL.\n    const baseServer = !isBaseToBeRemoved ? '/' : pageContext._baseServer;\n    // Parse URL\n    return parseUrl(urlResolved, baseServer);\n}\nfunction urlPathnameGetter() {\n    const { pathname } = getUrlParsed(this);\n    const urlPathname = pathname;\n    assert(urlPathname.startsWith('/'));\n    return urlPathname;\n}\nfunction urlGetter() {\n    // TO-DO/next-major-release: remove\n    assertWarning(false, '`pageContext.url` is outdated. Use `pageContext.urlPathname`, `pageContext.urlParsed`, or `pageContext.urlOriginal` instead. (See https://vike.dev/migration/0.4.23 for more information.)', { onlyOnce: true, showStackTrace: true });\n    return urlPathnameGetter.call(this);\n}\nfunction urlParsedGetter() {\n    const { \n    // remove isBaseMissing as it isn't part of UrlPublic\n    isBaseMissing: _, ...urlParsed } = getUrlParsed(this);\n    const hashIsAvailable = isBrowser();\n    const warnHashNotAvailable = (prop) => {\n        assertWarning(hashIsAvailable, `pageContext.urlParsed.${prop} isn't available on the server-side (HTTP requests don't include the URL hash)`, { onlyOnce: true, showStackTrace: true });\n    };\n    const urlParsedEnhanced = {\n        ...urlParsed,\n        get hash() {\n            warnHashNotAvailable('hash');\n            return urlParsed.hash;\n        },\n        get hashOriginal() {\n            warnHashNotAvailable('hashOriginal');\n            return urlParsed.hashOriginal;\n        },\n        // TO-DO/next-major-release: remove\n        get hashString() {\n            assertWarning(false, 'pageContext.urlParsed.hashString has been renamed to pageContext.urlParsed.hashOriginal', {\n                onlyOnce: true,\n                showStackTrace: true,\n            });\n            warnHashNotAvailable('hashString');\n            return urlParsed.hashOriginal;\n        },\n        // TO-DO/next-major-release: remove\n        get searchString() {\n            assertWarning(false, 'pageContext.urlParsed.searchString has been renamed to pageContext.urlParsed.searchOriginal', { onlyOnce: true, showStackTrace: true });\n            return urlParsed.searchOriginal;\n        },\n    };\n    changeEnumerable(urlParsedEnhanced, 'hashString', false);\n    changeEnumerable(urlParsedEnhanced, 'searchString', false);\n    if (!hashIsAvailable) {\n        changeEnumerable(urlParsedEnhanced, 'hash', false);\n        changeEnumerable(urlParsedEnhanced, 'hashOriginal', false);\n    }\n    return urlParsedEnhanced;\n}\n","export { getBaseServer };\nimport { assert } from '../runtime-server-routing/utils.js';\nfunction getBaseServer() {\n    const baseServer = import.meta.env.BASE_SERVER;\n    assert(isBaseServer(baseServer));\n    return baseServer;\n}\n// We don't use isBaseServer() defined in utils/parseUrl.ts to avoid loading the whole file in the browser\nfunction isBaseServer(baseServer) {\n    return baseServer.startsWith('/');\n}\n","// TO-DO/next-major-release: remove this\nexport { assertDefaultExports };\nexport { assertExportValues };\nexport { forbiddenDefaultExports };\nimport { assert, assertUsage } from '../utils.js';\nconst enforceTrue = ['clientRouting'];\nfunction assertExportValues(pageFile) {\n    enforceTrue.forEach((exportName) => {\n        assert(pageFile.fileExports);\n        if (!(exportName in pageFile.fileExports))\n            return;\n        const explainer = `The value of \\`${exportName}\\` is only allowed to be \\`true\\`.`;\n        assertUsage(pageFile.fileExports[exportName] !== false, `${pageFile.filePath} has \\`export { ${exportName} }\\` with the value \\`false\\` which is prohibited: remove \\`export { ${exportName} }\\` instead. (${explainer})`);\n        assertUsage(pageFile.fileExports[exportName] === true, `${pageFile.filePath} has \\`export { ${exportName} }\\` with a forbidden value. ${explainer}`);\n    });\n}\n// Forbid exports such as `export default { render }`, because only `export { render }` can be statically analyzed by `es-module-lexer`.\nconst forbiddenDefaultExports = ['render', 'clientRouting', 'prerender', 'doNotPrerender'];\nfunction assertDefaultExports(defaultExportName, filePath) {\n    assertUsage(!forbiddenDefaultExports.includes(defaultExportName), `${filePath} has \\`export default { ${defaultExportName} }\\` which is prohibited, use \\`export { ${defaultExportName} }\\` instead.`);\n}\n","export { determinePageIdOld };\nimport { slice, assert } from './utils.js';\n// TO-DO/next-major-release: remove\nfunction determinePageIdOld(filePath) {\n    const pageSuffix = '.page.';\n    const pageId = slice(filePath.split(pageSuffix), 0, -1).join(pageSuffix);\n    assert(!pageId.includes('\\\\'));\n    return pageId;\n}\n","export { getErrorPageId };\nexport { isErrorPageId };\nexport { isErrorPage };\n// TO-DO/next-major-release: consider loading this file only for Client Routing\nimport { assert, assertUsage, unique } from './utils.js';\nfunction getErrorPageId(pageFilesAll, pageConfigs) {\n    if (pageConfigs.length > 0) {\n        const errorPageConfigs = pageConfigs.filter((p) => p.isErrorPage);\n        if (errorPageConfigs.length === 0)\n            return null;\n        assertUsage(errorPageConfigs.length === 1, 'Only one error page can be defined');\n        return errorPageConfigs[0].pageId;\n    }\n    // TO-DO/next-major-release: remove\n    const errorPageIds = unique(pageFilesAll.map(({ pageId }) => pageId).filter((pageId) => isErrorPageId(pageId, false)));\n    assertUsage(errorPageIds.length <= 1, `Only one _error.page.js is allowed, but found several: ${errorPageIds.join(' ')}`);\n    if (errorPageIds.length > 0) {\n        const errorPageId = errorPageIds[0];\n        assert(errorPageId);\n        return errorPageId;\n    }\n    return null;\n}\n// TO-DO/next-major-release: remove\nfunction isErrorPageId(pageId, _isV1Design) {\n    assert(!pageId.includes('\\\\'));\n    return pageId.includes('/_error');\n}\nfunction isErrorPage(pageId, pageConfigs) {\n    if (pageConfigs.length > 0) {\n        const pageConfig = pageConfigs.find((p) => p.pageId === pageId);\n        assert(pageConfig);\n        return !!pageConfig.isErrorPage;\n    }\n    else {\n        return isErrorPageId(pageId, false);\n    }\n}\n","// TO-DO/next-major-release: remove\nexport { fileTypes };\nexport { isValidFileType };\nexport { determineFileType };\nimport { assert } from '../utils.js';\nimport { isScriptFile } from '../../utils/isScriptFile.js';\nconst fileTypes = [\n    '.page',\n    '.page.server',\n    '.page.route',\n    '.page.client',\n    // New type `.page.css`/`.page.server.css`/`.page.client.css` for `extensions[number].pageFileDist`.\n    //  - Extensions using `pageFileDist` are expected to use a bundler that generates a `.css` colocated next to the original `.page.js` file (e.g. `/renderer/_default.page.server.css` for `/renderer/_default.page.server.js`.\n    //  - Since these `.page.css` files Bundlers We can therefore expect that there isn't any `.page.server.sass`/...\n    '.css',\n];\nfunction isValidFileType(filePath) {\n    return ['.js', '.mjs', '.cjs', '.css'].some((ext) => filePath.endsWith(ext));\n}\nfunction determineFileType(filePath) {\n    {\n        const isCSS = filePath.endsWith('.css');\n        if (isCSS) {\n            /* This assert() is skipped to reduce client-side bundle size\n            assert(isImportPathNpmPackage(filePath), filePath) // `.css` page files are only supported for npm packages\n            */\n            return '.css';\n        }\n    }\n    assert(isScriptFile(filePath), filePath);\n    const fileName = filePath.split('/').slice(-1)[0];\n    const parts = fileName.split('.');\n    const suffix1 = parts.slice(-3)[0];\n    const suffix2 = parts.slice(-2)[0];\n    if (suffix2 === 'page') {\n        return '.page';\n    }\n    assert(suffix1 === 'page', filePath);\n    if (suffix2 === 'server') {\n        return '.page.server';\n    }\n    if (suffix2 === 'client') {\n        return '.page.client';\n    }\n    if (suffix2 === 'route') {\n        return '.page.route';\n    }\n    assert(false, filePath);\n}\n","// TO-DO/next-major-release: remove\nexport { getPageFileObject };\nimport { determinePageIdOld } from '../determinePageIdOld.js';\nimport { isErrorPageId } from '../error-page.js';\nimport { assert, slice } from '../utils.js';\nimport { determineFileType } from './fileTypes.js';\nfunction getPageFileObject(filePath) {\n    const isRelevant = (pageId) => pageFile.pageId === pageId ||\n        (pageFile.isDefaultPageFile &&\n            (isRendererFilePath(pageFile.filePath) || isAncestorDefaultPage(pageId, pageFile.filePath)));\n    const fileType = determineFileType(filePath);\n    const isEnv = (env) => {\n        assert(fileType !== '.page.route'); // We can't determine `.page.route.js`\n        if (env === 'CLIENT_ONLY') {\n            return fileType === '.page.client' || fileType === '.css';\n        }\n        if (env === 'SERVER_ONLY') {\n            return fileType === '.page.server';\n        }\n        if (env === 'CLIENT_AND_SERVER') {\n            return fileType === '.page';\n        }\n        assert(false);\n    };\n    const pageFile = {\n        filePath,\n        fileType,\n        isEnv,\n        isRelevant,\n        isDefaultPageFile: isDefaultFilePath(filePath),\n        isRendererPageFile: fileType !== '.css' && isDefaultFilePath(filePath) && isRendererFilePath(filePath),\n        isErrorPageFile: isErrorPageId(filePath, false),\n        pageId: determinePageIdOld(filePath),\n    };\n    return pageFile;\n}\nfunction isDefaultFilePath(filePath) {\n    if (isErrorPageId(filePath, false)) {\n        return false;\n    }\n    return filePath.includes('/_default');\n}\nfunction isRendererFilePath(filePath) {\n    return filePath.includes('/renderer/');\n}\nfunction isAncestorDefaultPage(pageId, defaultPageFilePath) {\n    assert(!pageId.endsWith('/'));\n    assert(!defaultPageFilePath.endsWith('/'));\n    assert(isDefaultFilePath(defaultPageFilePath));\n    const defaultPageDir = slice(defaultPageFilePath.split('/'), 0, -1)\n        .filter((filePathSegment) => filePathSegment !== '_default')\n        .join('/');\n    return pageId.startsWith(defaultPageDir);\n}\n","export { assertPlusFileExport };\nimport { assert, assertUsage, assertWarning } from '../utils.js';\nimport pc from '@brillout/picocolors';\nconst SIDE_EXPORTS_TOLERATE = [\n    // vite-plugin-solid adds `export { $$registrations }`\n    '$$registrations',\n    // @vitejs/plugin-vue adds `export { _rerender_only }`\n    '_rerender_only',\n];\n// Tolerate `export { frontmatter }` in .mdx files\nconst SIDE_EXPORTS_DO_NOT_CHECK = ['.md', '.mdx'];\nfunction assertPlusFileExport(fileExports, filePathToShowToUser, configName) {\n    const exportNames = Object.keys(fileExports);\n    const isValid = (exportName) => exportName === 'default' || exportName === configName;\n    // Error upon missing/ambiguous export\n    const exportNamesValid = exportNames.filter(isValid);\n    const exportDefault = pc.code('export default');\n    const exportNamed = pc.code(`export { ${configName} }`);\n    if (exportNamesValid.length === 0) {\n        assertUsage(false, `${filePathToShowToUser} should define ${exportNamed} or ${exportDefault}`);\n    }\n    if (exportNamesValid.length === 2) {\n        assertUsage(false, `${filePathToShowToUser} is ambiguous: remove ${exportDefault} or ${exportNamed}`);\n    }\n    assert(exportNamesValid.length === 1);\n    // Warn upon side exports\n    const exportNamesInvalid = exportNames\n        .filter((e) => !isValid(e))\n        .filter((exportName) => !SIDE_EXPORTS_TOLERATE.includes(exportName));\n    if (!SIDE_EXPORTS_DO_NOT_CHECK.some((ext) => filePathToShowToUser.endsWith(ext))) {\n        exportNamesInvalid.forEach((exportInvalid) => {\n            assertWarning(false, `${filePathToShowToUser} unexpected ${pc.cyan(`export { ${exportInvalid} }`)}, see https://vike.dev/no-side-exports`, {\n                onlyOnce: true,\n            });\n        });\n    }\n}\n","export { parsePageConfigsSerialized };\nexport { parseConfigValuesSerialized };\nimport { assert, assertUsage, isCallable } from '../../utils.js';\nimport { getConfigDefinedAt } from '../getConfigDefinedAt.js';\nimport { parseTransform } from '@brillout/json-serializer/parse';\nimport { assertPlusFileExport } from '../assertPlusFileExport.js';\nfunction parsePageConfigsSerialized(pageConfigsSerialized, pageConfigGlobalSerialized) {\n    // pageConfigs\n    const pageConfigs = pageConfigsSerialized.map((pageConfigSerialized) => {\n        const configValues = parseConfigValuesSerialized(pageConfigSerialized.configValuesSerialized);\n        assertRouteConfigValue(configValues);\n        const pageConfig = { ...pageConfigSerialized, configValues };\n        return pageConfig;\n    });\n    // pageConfigsGlobal\n    const pageConfigGlobal = { configValues: {} };\n    {\n        const configValues = parseConfigValuesSerialized(pageConfigGlobalSerialized.configValuesSerialized);\n        Object.assign(pageConfigGlobal.configValues, configValues);\n    }\n    return { pageConfigs, pageConfigGlobal };\n}\nfunction assertRouteConfigValue(configValues) {\n    const configName = 'route';\n    const configValue = configValues[configName];\n    if (!configValue)\n        return;\n    const { value, definedAtData } = configValue;\n    const configValueType = typeof value;\n    assert(definedAtData);\n    const configDefinedAt = getConfigDefinedAt('Config', configName, definedAtData);\n    assertUsage(configValueType === 'string' || isCallable(value), `${configDefinedAt} has an invalid type '${configValueType}': it should be a string or a function instead, see https://vike.dev/route`);\n    /* We don't use assertRouteString() in order to avoid unnecessarily bloating the client-side bundle when using Server Routing:\n    * - When using Server Routing, this file is loaded => loading assertRouteString() would bloat the client bundle.\n    * - assertRouteString() is already called on the server-side\n    * - When using Server Routing, client-side validation is superfluous as Route Strings only need to be validated on the server-side\n   if (typeof configValue === 'string') {\n     assertRouteString(configValue, `${configElement.configDefinedAt} defines an`)\n   }\n   */\n}\nfunction parseConfigValuesSerialized(configValuesSerialized) {\n    const configValues = {};\n    Object.entries(configValuesSerialized).forEach(([configName, configValueSeriliazed]) => {\n        let configValue;\n        if (configValueSeriliazed.type === 'cumulative') {\n            const { valueSerialized, ...common } = configValueSeriliazed;\n            const value = valueSerialized.map((valueSerializedElement, i) => {\n                const { value, sideExports } = parseValueSerialized(valueSerializedElement, configName, () => {\n                    const definedAtFile = configValueSeriliazed.definedAtData[i];\n                    assert(definedAtFile);\n                    return definedAtFile;\n                });\n                addSideExports(sideExports);\n                return value;\n            });\n            configValue = { value, ...common };\n        }\n        else {\n            const { valueSerialized, ...common } = configValueSeriliazed;\n            const { value, sideExports } = parseValueSerialized(valueSerialized, configName, () => {\n                assert(configValueSeriliazed.type !== 'computed');\n                const { definedAtData } = configValueSeriliazed;\n                const definedAtFile = Array.isArray(definedAtData) ? definedAtData[0] : definedAtData;\n                return definedAtFile;\n            });\n            addSideExports(sideExports);\n            configValue = { value, ...common };\n        }\n        configValues[configName] = configValue;\n    });\n    return configValues;\n    function addSideExports(sideExports) {\n        sideExports.forEach((sideExport) => {\n            const { configName, configValue } = sideExport;\n            if (!configValues[configName]) {\n                configValues[configName] = configValue;\n            }\n            else {\n                // Side-exports have lower precedence.\n                // We can't avoid side-export conflicts upstream. (We cannot know about side-exports at build-time.)\n            }\n        });\n    }\n}\nfunction parseValueSerialized(valueSerialized, configName, getDefinedAtFile) {\n    if (valueSerialized.type === 'js-serialized') {\n        let { value } = valueSerialized;\n        value = parseTransform(value);\n        return { value, sideExports: [] };\n    }\n    if (valueSerialized.type === 'pointer-import') {\n        const { value } = valueSerialized;\n        return { value, sideExports: [] };\n    }\n    if (valueSerialized.type === 'plus-file') {\n        const definedAtFile = getDefinedAtFile();\n        const { exportValues } = valueSerialized;\n        assert(!definedAtFile.definedBy);\n        assertPlusFileExport(exportValues, definedAtFile.filePathToShowToUser, configName);\n        let value;\n        let valueWasFound = false;\n        const sideExports = [];\n        Object.entries(exportValues).forEach(([exportName, exportValue]) => {\n            const isSideExport = exportName !== 'default' && exportName !== configName;\n            if (!isSideExport) {\n                value = exportValue;\n                // Already asserted by assertPlusFileExport() call above.\n                assert(!valueWasFound);\n                valueWasFound = true;\n            }\n            else {\n                sideExports.push({\n                    configName: exportName,\n                    configValue: {\n                        type: 'standard', // We don't support side exports for cumulative values. We could support it but it isn't trivial.\n                        value: exportValue,\n                        definedAtData: {\n                            filePathToShowToUser: definedAtFile.filePathToShowToUser,\n                            fileExportPathToShowToUser: [exportName],\n                        },\n                    },\n                });\n            }\n        });\n        // Already asserted by assertPlusFileExport() call above.\n        assert(valueWasFound);\n        return { value, sideExports };\n    }\n    assert(false);\n}\n/* [NULL_HANDLING] Do we really need this?\nfunction assertIsNotNull(configValue: unknown, configName: string, filePathToShowToUser: string) {\n  assert(!filePathToShowToUser.includes('+config.'))\n  // Re-use this for:\n  //  - upcoming config.requestPageContextOnNavigation\n  //  - for cumulative values in the future: we don't need this for now because, currently, cumulative values are never imported.\n  assertUsage(\n    configValue !== null,\n    `Set ${pc.cyan(configName)} to ${pc.cyan('null')} in a +config.js file instead of ${filePathToShowToUser}`\n  )\n}\n*/\n","export { parseVirtualFileExportsGlobalEntry };\n// TO-DO/next-major-release: remove old design code, and remove all assertions.\nimport { assert, hasProp, isCallable, isObject, cast, isArray } from '../utils.js';\nimport { assertExportValues } from './assert_exports_old_design.js';\nimport { getPageFileObject } from './getPageFileObject.js';\nimport { fileTypes } from './fileTypes.js';\nimport { parsePageConfigsSerialized } from '../page-configs/serialize/parsePageConfigsSerialized.js';\nfunction parseVirtualFileExportsGlobalEntry(virtualFileExportsGlobalEntry) {\n    assert(hasProp(virtualFileExportsGlobalEntry, 'pageFilesLazy', 'object'));\n    assert(hasProp(virtualFileExportsGlobalEntry, 'pageFilesEager', 'object'));\n    assert(hasProp(virtualFileExportsGlobalEntry, 'pageFilesExportNamesLazy', 'object'));\n    assert(hasProp(virtualFileExportsGlobalEntry, 'pageFilesExportNamesEager', 'object'));\n    assert(hasProp(virtualFileExportsGlobalEntry.pageFilesLazy, '.page'));\n    assert(hasProp(virtualFileExportsGlobalEntry.pageFilesLazy, '.page.client') ||\n        hasProp(virtualFileExportsGlobalEntry.pageFilesLazy, '.page.server'));\n    assert(hasProp(virtualFileExportsGlobalEntry, 'pageFilesList', 'string[]'));\n    assert(hasProp(virtualFileExportsGlobalEntry, 'pageConfigsSerialized'));\n    assert(hasProp(virtualFileExportsGlobalEntry, 'pageConfigGlobalSerialized'));\n    const { pageConfigsSerialized, pageConfigGlobalSerialized } = virtualFileExportsGlobalEntry;\n    assertPageConfigsSerialized(pageConfigsSerialized);\n    assertPageConfigGlobalSerialized(pageConfigGlobalSerialized);\n    const { pageConfigs, pageConfigGlobal } = parsePageConfigsSerialized(pageConfigsSerialized, pageConfigGlobalSerialized);\n    const pageFilesMap = {};\n    parseGlobResult(virtualFileExportsGlobalEntry.pageFilesLazy).forEach(({ filePath, pageFile, globValue }) => {\n        pageFile = pageFilesMap[filePath] = pageFilesMap[filePath] ?? pageFile;\n        const loadModule = globValue;\n        assertLoadModule(loadModule);\n        pageFile.loadFile = async () => {\n            if (!('fileExports' in pageFile)) {\n                pageFile.fileExports = await loadModule();\n                assertExportValues(pageFile);\n            }\n        };\n    });\n    parseGlobResult(virtualFileExportsGlobalEntry.pageFilesExportNamesLazy).forEach(({ filePath, pageFile, globValue }) => {\n        pageFile = pageFilesMap[filePath] = pageFilesMap[filePath] ?? pageFile;\n        const loadModule = globValue;\n        assertLoadModule(loadModule);\n        pageFile.loadExportNames = async () => {\n            if (!('exportNames' in pageFile)) {\n                const moduleExports = await loadModule();\n                assert(hasProp(moduleExports, 'exportNames', 'string[]'), pageFile.filePath);\n                pageFile.exportNames = moduleExports.exportNames;\n            }\n        };\n    });\n    // `pageFilesEager` contains `.page.route.js` files\n    parseGlobResult(virtualFileExportsGlobalEntry.pageFilesEager).forEach(({ filePath, pageFile, globValue }) => {\n        pageFile = pageFilesMap[filePath] = pageFilesMap[filePath] ?? pageFile;\n        const moduleExports = globValue;\n        assert(isObject(moduleExports));\n        pageFile.fileExports = moduleExports;\n    });\n    parseGlobResult(virtualFileExportsGlobalEntry.pageFilesExportNamesEager).forEach(({ filePath, pageFile, globValue }) => {\n        pageFile = pageFilesMap[filePath] = pageFilesMap[filePath] ?? pageFile;\n        const moduleExports = globValue;\n        assert(isObject(moduleExports));\n        assert(hasProp(moduleExports, 'exportNames', 'string[]'), pageFile.filePath);\n        pageFile.exportNames = moduleExports.exportNames;\n    });\n    virtualFileExportsGlobalEntry.pageFilesList.forEach((filePath) => {\n        pageFilesMap[filePath] = pageFilesMap[filePath] ?? getPageFileObject(filePath);\n    });\n    const pageFilesAll = Object.values(pageFilesMap);\n    pageFilesAll.forEach(({ filePath }) => {\n        assert(!filePath.includes('\\\\'));\n    });\n    return { pageFilesAll, pageConfigs, pageConfigGlobal };\n}\nfunction parseGlobResult(globObject) {\n    const ret = [];\n    Object.entries(globObject).forEach(([fileType, globFiles]) => {\n        cast(fileType);\n        assert(fileTypes.includes(fileType));\n        assert(isObject(globFiles));\n        Object.entries(globFiles).forEach(([filePath, globValue]) => {\n            const pageFile = getPageFileObject(filePath);\n            assert(pageFile.fileType === fileType);\n            ret.push({ filePath, pageFile, globValue });\n        });\n    });\n    return ret;\n}\nfunction assertLoadModule(globValue) {\n    assert(isCallable(globValue));\n}\nfunction assertPageConfigsSerialized(pageConfigsSerialized) {\n    assert(isArray(pageConfigsSerialized));\n    pageConfigsSerialized.forEach((pageConfigSerialized) => {\n        assert(isObject(pageConfigSerialized));\n        assert(hasProp(pageConfigSerialized, 'pageId', 'string'));\n        assert(hasProp(pageConfigSerialized, 'routeFilesystem'));\n        assert(hasProp(pageConfigSerialized, 'configValuesSerialized'));\n    });\n}\nfunction assertPageConfigGlobalSerialized(pageConfigGlobalSerialized) {\n    assert(hasProp(pageConfigGlobalSerialized, 'configValuesSerialized'));\n}\n","// TO-DO/soon/same-api: use public API internally?\n// TO-DO/soon/flat-pageContext: rename definedAt => definedBy\nexport { resolveGlobalConfigPublic };\nexport { resolvePageContextConfig };\nexport { resolveGlobalContextConfig };\nimport { assertDefaultExports, forbiddenDefaultExports } from '../getPageFiles/assert_exports_old_design.js';\nimport { getConfigDefinedAtOptional, getDefinedAtString } from './getConfigDefinedAt.js';\nimport { getConfigValueFilePathToShowToUser } from './helpers.js';\nimport { assert, isObject, assertWarning, assertUsage, makeLast, isBrowser, isScriptFile, isTemplateFile, objectDefineProperty, } from '../utils.js';\nimport pc from '@brillout/picocolors';\nfunction resolveGlobalConfigPublicPage(pageConfigGlobalValues, pageConfig, pageConfigValues) {\n    const pageConfigPublic_ = resolvePageConfigPublic({ pageConfigGlobalValues, pageConfigValues });\n    const pageConfigPublic = getPublicCopy(pageConfigPublic_);\n    const page = (() => {\n        if (!pageConfig.isErrorPage) {\n            const route = pageConfigPublic.config.route ?? pageConfig.routeFilesystem.routeString;\n            return {\n                ...pageConfigPublic,\n                route,\n            };\n        }\n        else {\n            return {\n                ...pageConfigPublic,\n                isErrorPage: true,\n            };\n        }\n    })();\n    return [pageConfig.pageId, page];\n}\nfunction getPublicCopy(configInternal) {\n    const configPublic = {\n        config: configInternal.config,\n        // TO-DO/soon/flat-pageContext: expose publicly?\n        _source: configInternal.source,\n        _sources: configInternal.sources,\n        _from: configInternal.from,\n    };\n    return configPublic;\n}\nfunction resolvePageConfigPublic({ pageConfigGlobalValues, pageConfigValues, }) {\n    const configValues = { ...pageConfigGlobalValues, ...pageConfigValues };\n    return resolveConfigPublic_V1Design({ configValues });\n}\nfunction resolvePageContextConfig(pageFiles, // V0.4 design\npageConfig, // V1 design\npageConfigGlobal) {\n    const config = {};\n    const configEntries = {}; // TO-DO/next-major-release: remove\n    const exportsAll = {}; // TO-DO/next-major-release: remove\n    // V0.4 design\n    // TO-DO/next-major-release: remove\n    pageFiles.forEach((pageFile) => {\n        const exportValues = getExportValues(pageFile);\n        exportValues.forEach(({ exportName, exportValue, isFromDefaultExport }) => {\n            assert(exportName !== 'default');\n            exportsAll[exportName] = exportsAll[exportName] ?? [];\n            exportsAll[exportName].push({\n                exportValue,\n                exportSource: `${pageFile.filePath} > ${isFromDefaultExport ? `\\`export default { ${exportName} }\\`` : `\\`export { ${exportName} }\\``}`,\n                filePath: pageFile.filePath,\n                _filePath: pageFile.filePath, // TO-DO/next-major-release: remove\n                _fileType: pageFile.fileType,\n                _isFromDefaultExport: isFromDefaultExport,\n            });\n        });\n    });\n    let source;\n    let sources;\n    let from;\n    if (pageConfig) {\n        const res = resolvePageConfigPublic({\n            pageConfigGlobalValues: pageConfigGlobal.configValues,\n            pageConfigValues: pageConfig.configValues,\n        });\n        source = res.source;\n        sources = res.sources;\n        from = res.from;\n        Object.assign(config, res.config);\n        Object.assign(configEntries, res.configEntries);\n        Object.assign(exportsAll, res.exportsAll);\n    }\n    else {\n        source = {};\n        sources = {};\n        from = {\n            configsStandard: {},\n            configsCumulative: {},\n            configsComputed: {},\n        };\n    }\n    const pageExports = {};\n    const exports = {};\n    Object.entries(exportsAll).forEach(([exportName, values]) => {\n        values.forEach(({ exportValue, _fileType, _isFromDefaultExport }) => {\n            exports[exportName] = exports[exportName] ?? exportValue;\n            // Legacy pageContext.pageExports\n            if (_fileType === '.page' && !_isFromDefaultExport) {\n                if (!(exportName in pageExports)) {\n                    pageExports[exportName] = exportValue;\n                }\n            }\n        });\n    });\n    assert(!('default' in exports));\n    assert(!('default' in exportsAll));\n    const pageContextAddendum = {\n        config: config,\n        from,\n        source,\n        sources,\n        // TO-DO/soon/flat-pageContext: deprecate every prop below\n        configEntries,\n        exports,\n        exportsAll,\n    };\n    // TO-DO/next-major-release: remove\n    objectDefineProperty(pageContextAddendum, 'pageExports', {\n        get: () => {\n            // We only show the warning in Node.js because when using Client Routing Vue integration uses `Object.assign(pageContextReactive, pageContext)` which will wrongully trigger the warning. There is no cross-browser way to catch whether the property accessor was initiated by an `Object.assign()` call.\n            if (!isBrowser()) {\n                assertWarning(false, 'pageContext.pageExports is outdated, use pageContext.exports instead', {\n                    onlyOnce: true,\n                    showStackTrace: true,\n                });\n            }\n            return pageExports;\n        },\n        enumerable: false,\n        configurable: true,\n    });\n    return pageContextAddendum;\n}\nfunction resolveGlobalContextConfig(pageConfigs, pageConfigGlobal) {\n    const globalContextAddendum = resolveGlobalConfigPublic(pageConfigs, pageConfigGlobal, (c) => c.configValues);\n    return globalContextAddendum;\n}\nfunction resolveGlobalConfigPublic(pageConfigs, pageConfigGlobal, getConfigValues) {\n    // global\n    const pageConfigGlobalValues = getConfigValues(pageConfigGlobal, true);\n    const globalConfigPublicBase_ = resolveConfigPublic_V1Design({ configValues: pageConfigGlobalValues });\n    const globalConfigPublicBase = getPublicCopy(globalConfigPublicBase_);\n    // pages\n    const pages = Object.fromEntries(pageConfigs.map((pageConfig) => {\n        const pageConfigValues = getConfigValues(pageConfig);\n        return resolveGlobalConfigPublicPage(pageConfigGlobalValues, pageConfig, pageConfigValues);\n    }));\n    const globalConfigPublic = {\n        ...globalConfigPublicBase,\n        pages,\n    };\n    return {\n        ...globalConfigPublic,\n        _globalConfigPublic: globalConfigPublic,\n    };\n}\n// V1 design\nfunction resolveConfigPublic_V1Design(pageConfig) {\n    const config = {};\n    const configEntries = {};\n    const exportsAll = {};\n    const source = {};\n    const sources = {};\n    const from = {\n        configsStandard: {},\n        configsCumulative: {},\n        configsComputed: {},\n    };\n    const addSrc = (src, configName) => {\n        source[configName] = src;\n        sources[configName] ?? (sources[configName] = []);\n        sources[configName].push(src);\n    };\n    const addLegacy = (configName, value, definedAtData) => {\n        const configValueFilePathToShowToUser = getConfigValueFilePathToShowToUser(definedAtData);\n        const configDefinedAt = getConfigDefinedAtOptional('Config', configName, definedAtData);\n        configEntries[configName] = configEntries[configName] ?? [];\n        configEntries[configName].push({\n            configValue: value,\n            configDefinedAt,\n            configDefinedByFile: configValueFilePathToShowToUser,\n        });\n        // TO-DO/next-major-release: remove\n        const exportName = configName;\n        exportsAll[exportName] = exportsAll[exportName] ?? [];\n        exportsAll[exportName].push({\n            exportValue: value,\n            exportSource: configDefinedAt,\n            filePath: configValueFilePathToShowToUser,\n            _filePath: configValueFilePathToShowToUser,\n            _fileType: null,\n            _isFromDefaultExport: null,\n        });\n    };\n    Object.entries(pageConfig.configValues).forEach(([configName, configValue]) => {\n        const { value } = configValue;\n        config[configName] = config[configName] ?? value;\n        if (configValue.type === 'standard') {\n            const src = {\n                type: 'configsStandard',\n                value: configValue.value,\n                definedAt: getDefinedAtString(configValue.definedAtData, configName),\n            };\n            addSrc(src, configName);\n            from.configsStandard[configName] = src;\n            addLegacy(configName, value, configValue.definedAtData);\n        }\n        if (configValue.type === 'cumulative') {\n            const src = {\n                type: 'configsCumulative',\n                definedAt: getDefinedAtString(configValue.definedAtData, configName),\n                values: configValue.value.map((value, i) => {\n                    const definedAtFile = configValue.definedAtData[i];\n                    assert(definedAtFile);\n                    const definedAt = getDefinedAtString(definedAtFile, configName);\n                    addLegacy(configName, value, definedAtFile);\n                    return {\n                        value,\n                        definedAt,\n                    };\n                }),\n            };\n            addSrc(src, configName);\n            from.configsCumulative[configName] = src;\n        }\n        if (configValue.type === 'computed') {\n            const src = {\n                type: 'configsComputed',\n                definedAt: 'Vike', // Vike currently doesn't support user-land computed configs => computed configs are always defined by Vike => there isn't any file path to show.\n                value: configValue.value,\n            };\n            addSrc(src, configName);\n            from.configsComputed[configName] = src;\n            addLegacy(configName, value, configValue.definedAtData);\n        }\n    });\n    return {\n        config: config,\n        configEntries,\n        exportsAll,\n        source,\n        sources,\n        from,\n    };\n}\n// V0.4 design\n// TO-DO/next-major-release: remove\nfunction getExportValues(pageFile) {\n    const { filePath, fileExports } = pageFile;\n    assert(fileExports); // assume pageFile.loadFile() was called\n    assert(isScriptFile(filePath));\n    const exportValues = [];\n    Object.entries(fileExports)\n        .sort(makeLast(([exportName]) => exportName === 'default')) // `export { bla }` should override `export default { bla }`\n        .forEach(([exportName, exportValue]) => {\n        let isFromDefaultExport = exportName === 'default';\n        if (isFromDefaultExport) {\n            if (isTemplateFile(filePath)) {\n                exportName = 'Page';\n            }\n            else {\n                assertUsage(isObject(exportValue), `The ${pc.cyan('export default')} of ${filePath} should be an object.`);\n                Object.entries(exportValue).forEach(([defaultExportName, defaultExportValue]) => {\n                    assertDefaultExports(defaultExportName, filePath);\n                    exportValues.push({\n                        exportName: defaultExportName,\n                        exportValue: defaultExportValue,\n                        isFromDefaultExport,\n                    });\n                });\n                return;\n            }\n        }\n        exportValues.push({\n            exportName,\n            exportValue,\n            isFromDefaultExport,\n        });\n    });\n    exportValues.forEach(({ exportName, isFromDefaultExport }) => {\n        assert(!(isFromDefaultExport && forbiddenDefaultExports.includes(exportName)));\n    });\n    return exportValues;\n}\n","export { createGlobalContextShared };\nexport { getGlobalContextSyncErrMsg };\nimport { assert, changeEnumerable, genPromise, objectAssign, objectReplace, unique } from './utils.js';\nimport { parseVirtualFileExportsGlobalEntry } from './getPageFiles/parseVirtualFileExportsGlobalEntry.js';\nimport { resolveGlobalContextConfig } from './page-configs/resolveVikeConfigPublic.js';\nimport { execHookGlobal } from './hooks/execHook.js';\nimport { prepareGlobalContextForPublicUsage, } from './prepareGlobalContextForPublicUsage.js';\nimport { getHookFromPageConfigGlobalCumulative } from './hooks/getHook.js';\nconst getGlobalContextSyncErrMsg = \"The global context isn't set yet, call getGlobalContextSync() later or use getGlobalContext() instead.\";\n// TO-DO/eventually use flat globalContext — like flat pageContext\nasync function createGlobalContextShared(virtualFileExportsGlobalEntry, globalObject, addGlobalContext, \n// TO-DO/next-major-release: we'll be able to remove addGlobalContextTmp after loadPageRoutes() is sync (it will be sync after we remove the old design)\naddGlobalContextTmp, addGlobalContextAsync) {\n    const { previousCreateGlobalContextPromise } = globalObject;\n    const { promise, resolve } = genPromise({\n        // Avoid this Cloudflare Worker error:\n        // ```console\n        // Error: Disallowed operation called within global scope. Asynchronous I/O (ex: fetch() or connect()), setting a timeout, and generating random values are not allowed within global scope. To fix this error, perform this operation within a handler.\n        // ```\n        timeout: null,\n    });\n    globalObject.previousCreateGlobalContextPromise = promise;\n    if (previousCreateGlobalContextPromise) {\n        assert(globalObject.globalContext);\n        await previousCreateGlobalContextPromise;\n    }\n    const globalContext = createGlobalContextBase(virtualFileExportsGlobalEntry);\n    let isNewGlobalContext;\n    if (!globalObject.globalContext) {\n        // We set globalObject.globalContext early and before any async operations, so that getGlobalContextSync() can be used early.\n        // - Required by vike-vercel\n        globalObject.globalContext = globalContext;\n        isNewGlobalContext = false;\n    }\n    else {\n        isNewGlobalContext = true;\n    }\n    if (addGlobalContext &&\n        // TO-DO/next-major-release: remove\n        globalContext._pageConfigs.length > 0) {\n        const globalContextAdded = addGlobalContext?.(globalContext);\n        objectAssign(globalContext, globalContextAdded);\n    }\n    else {\n        const globalContextAdded = await addGlobalContextTmp?.(globalContext);\n        objectAssign(globalContext, globalContextAdded);\n    }\n    {\n        const globalContextAddedAsync = await addGlobalContextAsync?.(globalContext);\n        objectAssign(globalContext, globalContextAddedAsync);\n    }\n    const onCreateGlobalContextHooks = getHookFromPageConfigGlobalCumulative(globalContext._pageConfigGlobal, 'onCreateGlobalContext');\n    let hooksCalled = false;\n    if (!hooksAreEqual(globalObject.onCreateGlobalContextHooks ?? [], onCreateGlobalContextHooks)) {\n        globalObject.onCreateGlobalContextHooks = onCreateGlobalContextHooks;\n        await execHookGlobal('onCreateGlobalContext', globalContext._pageConfigGlobal, null, globalContext, prepareGlobalContextForPublicUsage);\n        hooksCalled = true;\n    }\n    if (isNewGlobalContext) {\n        // Singleton: ensure all `globalContext` user-land references are preserved & updated.\n        if (hooksCalled) {\n            objectReplace(globalObject.globalContext, globalContext);\n        }\n        else {\n            // We don't use objectReplace() in order to keep user-land properties.\n            objectAssign(globalObject.globalContext, globalContext, true);\n        }\n    }\n    resolve();\n    return globalObject.globalContext;\n}\nfunction createGlobalContextBase(virtualFileExportsGlobalEntry) {\n    const { pageFilesAll, pageConfigs, pageConfigGlobal } = parseVirtualFileExportsGlobalEntry(virtualFileExportsGlobalEntry);\n    const allPageIds = getAllPageIds(pageFilesAll, pageConfigs);\n    const globalContextAddendum = resolveGlobalContextConfig(pageConfigs, pageConfigGlobal);\n    const globalContext = {\n        /**\n         * Useful for distinguishing `globalContext` from other objects and narrowing down TypeScript unions.\n         *\n         * https://vike.dev/globalContext#typescript\n         */\n        isGlobalContext: true,\n        _isOriginalObject: true,\n        _virtualFileExportsGlobalEntry: virtualFileExportsGlobalEntry,\n        _pageFilesAll: pageFilesAll,\n        _pageConfigs: pageConfigs,\n        _pageConfigGlobal: pageConfigGlobal,\n        _allPageIds: allPageIds,\n        ...globalContextAddendum,\n    };\n    changeEnumerable(globalContext, '_isOriginalObject', false);\n    return globalContext;\n}\nfunction getAllPageIds(pageFilesAll, pageConfigs) {\n    const fileIds = pageFilesAll.filter(({ isDefaultPageFile }) => !isDefaultPageFile).map(({ pageId }) => pageId);\n    const allPageIds = unique(fileIds);\n    const allPageIds2 = pageConfigs.map((p) => p.pageId);\n    return [...allPageIds, ...allPageIds2];\n}\nfunction hooksAreEqual(hooks1, hooks2) {\n    const hooksFn1 = hooks1.map((hook) => hook.hookFn);\n    const hooksFn2 = hooks2.map((hook) => hook.hookFn);\n    return (hooksFn1.every((hook) => hooksFn2.includes(hook)) &&\n        //\n        hooksFn2.every((hook) => hooksFn1.includes(hook)));\n}\n","// Public usage\nexport { getGlobalContext };\nexport { getGlobalContextSync };\nexport { setVirtualFileExportsGlobalEntry };\n// Internal usage\nexport { getGlobalContextClientInternalShared };\nimport { createGlobalContextShared, getGlobalContextSyncErrMsg } from '../../shared/createGlobalContextShared.js';\nimport { getGlobalContextSerializedInHtml } from './getJsonSerializedInHtml.js';\nimport { assert, assertUsage, genPromise, getGlobalObject, objectAssign, checkType } from './utils.js';\nconst globalObject = getGlobalObject('getGlobalContextClientInternalShared.ts', (() => {\n    const { promise: globalContextInitialPromise, resolve: globalContextInitialPromiseResolve } = genPromise();\n    return {\n        globalContextInitialPromise,\n        globalContextInitialPromiseResolve,\n    };\n})());\nasync function getGlobalContextClientInternalShared() {\n    // Get\n    if (globalObject.globalContextPromise) {\n        const globalContext = await globalObject.globalContextPromise;\n        return globalContext;\n    }\n    // Create\n    const globalContextPromise = createGlobalContextShared(globalObject.virtualFileExportsGlobalEntry, globalObject, () => {\n        const globalContextAddendum = {\n            /**\n             * Whether the environment is the client-side:\n             * - In the browser, the value is `true`.\n             * - Upon SSR and pre-rendering, the value is `false`.\n             *\n             * https://vike.dev/globalContext#isClientSide\n             */\n            isClientSide: true,\n        };\n        objectAssign(globalContextAddendum, getGlobalContextSerializedInHtml());\n        return globalContextAddendum;\n    });\n    globalObject.globalContextPromise = globalContextPromise;\n    const globalContext = await globalContextPromise;\n    assert(globalObject.globalContext === globalContext);\n    globalObject.globalContextInitialPromiseResolve();\n    // Return\n    return globalContext;\n}\nasync function getGlobalContext() {\n    await globalObject.globalContextInitialPromise;\n    const globalContext = await globalObject.globalContextPromise;\n    assert(globalContext);\n    checkType(globalContext);\n    return globalContext;\n}\nfunction getGlobalContextSync() {\n    const { globalContext } = globalObject;\n    assertUsage(globalContext, getGlobalContextSyncErrMsg);\n    checkType(globalContext);\n    return globalContext;\n}\nasync function setVirtualFileExportsGlobalEntry(virtualFileExportsGlobalEntry) {\n    // HMR => virtualFileExportsGlobalEntry differ\n    if (globalObject.virtualFileExportsGlobalEntry !== virtualFileExportsGlobalEntry) {\n        delete globalObject.globalContextPromise;\n        globalObject.virtualFileExportsGlobalEntry = virtualFileExportsGlobalEntry;\n        // Eagerly call +onCreateGlobalContext() hooks\n        await getGlobalContextClientInternalShared();\n    }\n}\n","// Unit tests at ./deduceRouteStringFromFilesystemPath.spec.ts\nimport { assert, higherFirst, slice } from './utils.js';\nexport { deduceRouteStringFromFilesystemPath };\n// TO-DO/next-major-release: remove this and whole filesystemRoot mechanism\nfunction deduceRouteStringFromFilesystemPath(pageId, filesystemRoots) {\n    // Handle Filesystem Routing Root\n    const filesystemRootsMatch = filesystemRoots\n        .filter(({ filesystemRoot }) => pageId.startsWith(filesystemRoot))\n        .sort(higherFirst(({ filesystemRoot }) => filesystemRoot.length));\n    const fsBase = filesystemRootsMatch[0];\n    let filesystemRoute;\n    if (fsBase) {\n        // Example values:\n        //  - `{\"pageId\":\"/pages/index\",\"filesystemRoot\":\"/\",\"urlRoot\":\"/client_portal\"}`\n        const { filesystemRoot, urlRoot } = fsBase;\n        const debugInfo = { pageId, filesystemRoot, urlRoot };\n        assert(urlRoot.startsWith('/') && pageId.startsWith('/') && filesystemRoot.startsWith('/'), debugInfo);\n        assert(pageId.startsWith(filesystemRoot), debugInfo);\n        if (filesystemRoot !== '/') {\n            assert(!filesystemRoot.endsWith('/'), debugInfo);\n            filesystemRoute = slice(pageId, filesystemRoot.length, 0);\n        }\n        else {\n            filesystemRoute = pageId;\n        }\n        assert(filesystemRoute.startsWith('/'), debugInfo);\n        filesystemRoute = urlRoot + (urlRoot.endsWith('/') ? '' : '/') + slice(filesystemRoute, 1, 0);\n    }\n    else {\n        filesystemRoute = pageId;\n    }\n    assert(filesystemRoute.startsWith('/'));\n    // Remove `pages/`, `index/, and `src/`, directories\n    filesystemRoute = filesystemRoute\n        .split('/')\n        .filter((dir) => dir !== 'pages' && dir !== 'src' && dir !== 'index')\n        .join('/');\n    // Handle `/index.page.*` suffix\n    assert(!filesystemRoute.includes('.page.'));\n    assert(!filesystemRoute.endsWith('.'));\n    if (filesystemRoute.endsWith('/index')) {\n        filesystemRoute = slice(filesystemRoute, 0, -'/index'.length);\n    }\n    if (filesystemRoute === '') {\n        filesystemRoute = '/';\n    }\n    assert(filesystemRoute.startsWith('/'));\n    assert(!filesystemRoute.endsWith('/') || filesystemRoute === '/');\n    return filesystemRoute;\n}\n","export { resolveRouteFunction };\nexport { assertRouteParams };\nexport { assertSyncRouting };\nexport { warnDeprecatedAllowKey };\nimport { execHookDirectSync } from '../hooks/execHook.js';\nimport { preparePageContextForPublicUsage } from '../preparePageContextForPublicUsage.js';\nimport { assert, assertUsage, assertWarning, hasProp, isPlainObject, isPromise } from './utils.js';\nimport pc from '@brillout/picocolors';\nasync function resolveRouteFunction(routeFunction, pageContext, routeFunctionFilePath) {\n    let { hookReturn: result } = execHookDirectSync({\n        hookFn: routeFunction,\n        hookFilePath: routeFunctionFilePath,\n        hookName: 'route',\n    }, pageContext, preparePageContextForPublicUsage);\n    assertSyncRouting(result, `The Route Function ${routeFunctionFilePath}`);\n    // TO-DO/next-major-release: make resolveRouteFunction() and route() sync\n    //* We disallow asynchronous routing, because we need to check whether a link is a Vike link in a synchronous fashion before calling ev.preventDefault() in the 'click' event listener\n    result = await result;\n    //*/\n    if (result === false) {\n        return null;\n    }\n    if (result === true) {\n        result = {};\n    }\n    assertUsage(isPlainObject(result), `The Route Function ${routeFunctionFilePath} should return a boolean or a plain JavaScript object (but it's ${pc.cyan(`typeof result === ${JSON.stringify(typeof result)}`)} instead)`);\n    // AFAICT this return interface is superfluous. Should we soft-deprecate it and remove it?\n    if ('match' in result) {\n        const { match } = result;\n        assertUsage(typeof match === 'boolean', `The ${pc.cyan('match')} value returned by the Route Function ${routeFunctionFilePath} should be a boolean.`);\n        if (!match) {\n            return null;\n        }\n    }\n    let precedence = null;\n    if ('precedence' in result) {\n        precedence = result.precedence;\n        assertUsage(typeof precedence === 'number', `The ${pc.cyan('precedence')} value returned by the Route Function ${routeFunctionFilePath} should be a number.`);\n    }\n    assertRouteParams(result, `The ${pc.cyan('routeParams')} object returned by the Route Function ${routeFunctionFilePath} should`);\n    const routeParams = result.routeParams || {};\n    assertUsage(!('pageContext' in result), `Providing ${pc.cyan('pageContext')} in Route Functions is prohibited, see https://vike.dev/route-function#cannot-provide-pagecontext`);\n    assert(isPlainObject(routeParams));\n    Object.keys(result).forEach((key) => {\n        assertUsage(key === 'match' || key === 'routeParams' || key === 'precedence', `The Route Function ${routeFunctionFilePath} returned an object with an unknown property ${pc.cyan(key)} (the known properties are ${pc.cyan('match')}, ${pc.cyan('routeParams')}, and ${pc.cyan('precedence')})`);\n    });\n    return {\n        precedence,\n        routeParams,\n    };\n}\n// TO-DO/next-major-release: remove, and make routing synchronous (enabling Vike to synchronously check whether a link is a Vike link before even calling ev.preventDefault())\nfunction assertSyncRouting(res, errPrefix) {\n    assertWarning(!isPromise(res), `${errPrefix} returned a promise, but asynchronous routing is deprecated and will be removed in the next major release, see https://vike.dev/route-function#async`, { onlyOnce: true });\n}\n// TO-DO/next-major-release: remove\nfunction warnDeprecatedAllowKey() {\n    const allowKey = pc.cyan('iKnowThePerformanceRisksOfAsyncRouteFunctions');\n    assertWarning(false, `${allowKey} is deprecated and will be removed in the next major release`, { onlyOnce: true });\n}\nfunction assertRouteParams(result, errPrefix) {\n    assert(errPrefix.endsWith(' should'));\n    if (!hasProp(result, 'routeParams')) {\n        return;\n    }\n    assert(errPrefix.endsWith(' should'));\n    assertUsage(hasProp(result, 'routeParams', 'string{}'), `${errPrefix} be an object holding string values.`);\n}\n","export { loadPageRoutes };\nexport { loadPageRoutesSync };\nimport { isErrorPageId } from '../error-page.js';\nimport { assert, assertUsage, hasProp, slice } from './utils.js';\nimport { deduceRouteStringFromFilesystemPath } from './deduceRouteStringFromFilesystemPath.js';\nimport { isArray, isCallable } from '../utils.js';\nimport { getConfigValueRuntime } from '../page-configs/getConfigValueRuntime.js';\nimport { getDefinedAtString } from '../page-configs/getConfigDefinedAt.js';\nimport { warnDeprecatedAllowKey } from './resolveRouteFunction.js';\nimport { getHookFromPageConfigGlobal, getHookTimeoutDefault } from '../hooks/getHook.js';\nasync function loadPageRoutes(\n// Remove all arguments and use GlobalContextServerInternal instead?\npageFilesAll, pageConfigs, pageConfigGlobal, allPageIds) {\n    // TO-DO/next-major-release: remove this line, remove this function, rename loadPageRoutesSync() to loadPageRoutes()\n    await Promise.all(pageFilesAll.filter((p) => p.fileType === '.page.route').map((p) => p.loadFile?.()));\n    return loadPageRoutesSync(pageFilesAll, pageConfigs, pageConfigGlobal, allPageIds);\n}\nfunction loadPageRoutesSync(\n// Remove all arguments and use GlobalContextServerInternal instead?\npageFilesAll, pageConfigs, pageConfigGlobal, allPageIds) {\n    const { onBeforeRouteHook, filesystemRoots } = getGlobalHooks(pageFilesAll, pageConfigs, pageConfigGlobal);\n    const pageRoutes = getPageRoutes(filesystemRoots, pageFilesAll, pageConfigs, allPageIds);\n    return { pageRoutes, onBeforeRouteHook };\n}\nfunction getPageRoutes(filesystemRoots, pageFilesAll, pageConfigs, allPageIds) {\n    const pageRoutes = [];\n    // V1 Design\n    if (pageConfigs.length > 0) {\n        assert(filesystemRoots === null);\n        const comesFromV1PageConfig = true;\n        pageConfigs\n            .filter((p) => !p.isErrorPage)\n            .forEach((pageConfig) => {\n            const pageId = pageConfig.pageId;\n            let pageRoute = null;\n            {\n                const configName = 'route';\n                const configValue = getConfigValueRuntime(pageConfig, configName);\n                if (configValue) {\n                    const route = configValue.value;\n                    assert(configValue.definedAtData);\n                    const definedAtString = getDefinedAtString(configValue.definedAtData, configName);\n                    if (typeof route === 'string') {\n                        pageRoute = {\n                            pageId,\n                            comesFromV1PageConfig,\n                            routeString: route,\n                            routeDefinedAtString: definedAtString,\n                            routeType: 'STRING',\n                        };\n                    }\n                    else {\n                        const { definedAtData } = configValue;\n                        assert(!isArray(definedAtData) && !definedAtData.definedBy);\n                        const { filePathToShowToUser } = definedAtData;\n                        assert(filePathToShowToUser);\n                        assert(isCallable(route));\n                        // TO-DO/next-major-release: remove\n                        if (getConfigValueRuntime(pageConfig, 'iKnowThePerformanceRisksOfAsyncRouteFunctions', 'boolean'))\n                            warnDeprecatedAllowKey();\n                        pageRoute = {\n                            pageId,\n                            comesFromV1PageConfig,\n                            routeFunction: route,\n                            routeFunctionFilePath: filePathToShowToUser,\n                            routeDefinedAtString: definedAtString,\n                            routeType: 'FUNCTION',\n                        };\n                    }\n                }\n            }\n            if (!pageRoute) {\n                const { routeFilesystem } = pageConfig;\n                assert(routeFilesystem);\n                const { routeString, definedAtLocation } = routeFilesystem;\n                assert(routeFilesystem.routeString.startsWith('/'));\n                pageRoute = {\n                    pageId,\n                    routeFilesystemDefinedBy: definedAtLocation,\n                    comesFromV1PageConfig,\n                    routeString,\n                    routeDefinedAtString: null,\n                    routeType: 'FILESYSTEM',\n                };\n            }\n            assert(pageRoute);\n            pageRoutes.push(pageRoute);\n        });\n    }\n    // Old design\n    // TO-DO/next-major-release: remove\n    if (pageConfigs.length === 0) {\n        assert(filesystemRoots);\n        const comesFromV1PageConfig = false;\n        allPageIds\n            .filter((pageId) => !isErrorPageId(pageId, false))\n            .forEach((pageId) => {\n            const pageRouteFile = pageFilesAll.find((p) => p.pageId === pageId && p.fileType === '.page.route');\n            if (!pageRouteFile || !('default' in pageRouteFile.fileExports)) {\n                const routeString = deduceRouteStringFromFilesystemPath(pageId, filesystemRoots);\n                assert(routeString.startsWith('/'));\n                assert(!routeString.endsWith('/') || routeString === '/');\n                pageRoutes.push({\n                    pageId,\n                    comesFromV1PageConfig,\n                    routeString,\n                    routeDefinedAtString: null,\n                    routeFilesystemDefinedBy: `${pageId}.page.*`,\n                    routeType: 'FILESYSTEM',\n                });\n            }\n            else {\n                const { filePath, fileExports } = pageRouteFile;\n                assert(fileExports.default);\n                if (hasProp(fileExports, 'default', 'string')) {\n                    const routeString = fileExports.default;\n                    assertUsage(routeString.startsWith('/'), `A Route String should start with a leading slash '/' but ${filePath} has \\`export default '${routeString}'\\`. Make sure to \\`export default '/${routeString}'\\` instead.`);\n                    pageRoutes.push({\n                        pageId,\n                        comesFromV1PageConfig,\n                        routeString,\n                        routeDefinedAtString: filePath,\n                        routeType: 'STRING',\n                    });\n                    return;\n                }\n                if (hasProp(fileExports, 'default', 'function')) {\n                    const routeFunction = fileExports.default;\n                    {\n                        const allowKey = 'iKnowThePerformanceRisksOfAsyncRouteFunctions';\n                        if (allowKey in fileExports) {\n                            warnDeprecatedAllowKey();\n                        }\n                    }\n                    pageRoutes.push({\n                        pageId,\n                        comesFromV1PageConfig,\n                        routeFunction,\n                        routeFunctionFilePath: filePath,\n                        routeDefinedAtString: filePath,\n                        routeType: 'FUNCTION',\n                    });\n                    return;\n                }\n                assertUsage(false, `The default export of ${filePath} should be a string or a function.`);\n            }\n        });\n    }\n    return pageRoutes;\n}\nfunction getGlobalHooks(pageFilesAll, pageConfigs, pageConfigGlobal) {\n    // V1 Design\n    if (pageConfigs.length > 0) {\n        const hook = getHookFromPageConfigGlobal(pageConfigGlobal, 'onBeforeRoute');\n        return { onBeforeRouteHook: hook, filesystemRoots: null };\n    }\n    // Old design\n    // TO-DO/next-major-release: remove\n    let onBeforeRouteHook = null;\n    const filesystemRoots = [];\n    pageFilesAll\n        .filter((p) => p.fileType === '.page.route' && p.isDefaultPageFile)\n        .forEach(({ filePath, fileExports }) => {\n        assert(fileExports);\n        if ('onBeforeRoute' in fileExports) {\n            assertUsage(hasProp(fileExports, 'onBeforeRoute', 'function'), `\\`export { onBeforeRoute }\\` of ${filePath} should be a function.`);\n            const { onBeforeRoute } = fileExports;\n            const hookName = 'onBeforeRoute';\n            onBeforeRouteHook = {\n                hookFilePath: filePath,\n                hookFn: onBeforeRoute,\n                hookName,\n                hookTimeout: getHookTimeoutDefault(hookName),\n            };\n        }\n        if ('filesystemRoutingRoot' in fileExports) {\n            assertUsage(hasProp(fileExports, 'filesystemRoutingRoot', 'string'), `\\`export { filesystemRoutingRoot }\\` of ${filePath} should be a string.`);\n            assertUsage(hasProp(fileExports, 'filesystemRoutingRoot', 'string'), `\\`export { filesystemRoutingRoot }\\` of ${filePath} is \\`'${fileExports.filesystemRoutingRoot}'\\` but it should start with a leading slash \\`/\\`.`);\n            filesystemRoots.push({\n                filesystemRoot: dirname(filePath),\n                urlRoot: fileExports.filesystemRoutingRoot,\n            });\n        }\n    });\n    return { onBeforeRouteHook, filesystemRoots };\n}\nfunction dirname(filePath) {\n    assert(filePath.startsWith('/'));\n    assert(!filePath.endsWith('/'));\n    const paths = filePath.split('/');\n    const dirPath = slice(paths, 0, -1).join('/') || '/';\n    assert(dirPath.startsWith('/'));\n    assert(!dirPath.endsWith('/') || dirPath === '/');\n    return dirPath;\n}\n","export { getGlobalContextClientInternal };\nimport { getGlobalContextClientInternalShared } from '../shared/getGlobalContextClientInternalShared.js';\nimport { loadPageRoutes } from '../../shared/route/loadPageRoutes.js';\nimport { objectAssign } from './utils.js';\nasync function getGlobalContextClientInternal() {\n    const globalContext = await getGlobalContextClientInternalShared();\n    objectAssign(globalContext, await addGlobalContext(globalContext));\n    return globalContext;\n}\n// TO-DO/next-major-release make this function sync\nasync function addGlobalContext(globalContext) {\n    const { pageRoutes, onBeforeRouteHook } = await loadPageRoutes(globalContext._pageFilesAll, globalContext._pageConfigs, globalContext._pageConfigGlobal, globalContext._allPageIds);\n    return {\n        _pageRoutes: pageRoutes,\n        _onBeforeRouteHook: onBeforeRouteHook,\n    };\n}\n","export { createPageContextClientSide };\nimport { createPageContextObject, createPageContextShared } from '../../shared/createPageContextShared.js';\nimport { getPageContextUrlComputed } from '../../shared/getPageContextUrlComputed.js';\nimport { getBaseServer } from './getBaseServer.js';\nimport { getGlobalContextClientInternal } from './getGlobalContextClientInternal.js';\nimport { assert, updateType, isBaseServer, objectAssign } from './utils.js';\nasync function createPageContextClientSide(urlOriginal) {\n    const globalContext = await getGlobalContextClientInternal();\n    const baseServer = getBaseServer();\n    assert(isBaseServer(baseServer));\n    const pageContextCreated = createPageContextObject();\n    objectAssign(pageContextCreated, {\n        isClientSide: true,\n        isPrerendering: false,\n        urlOriginal,\n        _globalContext: globalContext,\n        _pageFilesAll: globalContext._pageFilesAll, // TO-DO/next-major-release: remove\n        _urlHandler: null,\n        _urlRewrite: null,\n        _baseServer: baseServer,\n    });\n    const pageContextUrlComputed = getPageContextUrlComputed(pageContextCreated);\n    objectAssign(pageContextCreated, pageContextUrlComputed);\n    const pageContextAugmented = createPageContextShared(pageContextCreated, globalContext._globalConfigPublic);\n    updateType(pageContextCreated, pageContextAugmented);\n    return pageContextCreated;\n}\n","export { findPageConfig };\nimport { assert } from '../utils.js';\nfunction findPageConfig(pageConfigs, pageId) {\n    const result = pageConfigs.filter((p) => p.pageId === pageId);\n    assert(result.length <= 1);\n    const pageConfig = result[0] ?? null;\n    return pageConfig;\n}\n","export { loadAndParseVirtualFilePageEntry };\nimport { assert, objectAssign } from '../utils.js';\nimport { parseConfigValuesSerialized } from './serialize/parsePageConfigsSerialized.js';\nasync function loadAndParseVirtualFilePageEntry(pageConfig, isDev) {\n    if ('isPageEntryLoaded' in pageConfig &&\n        // We don't need to cache in dev, since Vite already caches the virtual module\n        !isDev) {\n        return pageConfig;\n    }\n    const { moduleId, moduleExportsPromise } = pageConfig.loadVirtualFilePageEntry();\n    const virtualFileExportsPageEntry = await moduleExportsPromise;\n    // `configValuesLoaded` is sometimes `undefined` https://github.com/vikejs/vike/discussions/2092\n    if (!virtualFileExportsPageEntry)\n        assert(false, { moduleExportsPromise, virtualFileExportsPageEntry, moduleId });\n    const configValues = parseVirtualFileExportsPageEntry(virtualFileExportsPageEntry);\n    Object.assign(pageConfig.configValues, configValues);\n    objectAssign(pageConfig, { isPageEntryLoaded: true });\n    return pageConfig;\n}\nfunction parseVirtualFileExportsPageEntry(virtualFileExportsPageEntry) {\n    const configValues = parseConfigValuesSerialized(virtualFileExportsPageEntry.configValuesSerialized);\n    return configValues;\n}\n","export { loadPageConfigsLazyClientSide };\nexport { isErrorFetchingStaticAssets };\nimport { getPageFilesClientSide } from '../../shared/getPageFiles.js';\nimport { resolvePageContextConfig } from '../../shared/page-configs/resolveVikeConfigPublic.js';\nimport { findPageConfig } from '../../shared/page-configs/findPageConfig.js';\nimport { loadAndParseVirtualFilePageEntry } from '../../shared/page-configs/loadAndParseVirtualFilePageEntry.js';\nimport { objectAssign } from '../runtime-server-routing/utils.js';\nconst errStamp = '_isAssetsError';\nasync function loadPageConfigsLazyClientSide(pageId, pageFilesAll, pageConfigs, pageConfigGlobal) {\n    const pageFilesClientSide = getPageFilesClientSide(pageFilesAll, pageId);\n    const pageConfig = findPageConfig(pageConfigs, pageId);\n    let pageConfigLoaded;\n    try {\n        // prettier-ignore\n        // biome-ignore format:\n        const result = await Promise.all([\n            pageConfig && loadAndParseVirtualFilePageEntry(pageConfig, import.meta.env.DEV),\n            ...pageFilesClientSide.map((p) => p.loadFile?.()),\n        ]);\n        pageConfigLoaded = result[0];\n    }\n    catch (err) {\n        if (isFetchError(err)) {\n            Object.assign(err, { [errStamp]: true });\n        }\n        else {\n            // Syntax error in user file\n        }\n        throw err;\n    }\n    const pageContextAddendum = {};\n    objectAssign(pageContextAddendum, resolvePageContextConfig(pageFilesClientSide, pageConfigLoaded, pageConfigGlobal));\n    objectAssign(pageContextAddendum, { _pageFilesLoaded: pageFilesClientSide });\n    return pageContextAddendum;\n}\nfunction isErrorFetchingStaticAssets(err) {\n    if (!err) {\n        return false;\n    }\n    return err[errStamp] === true;\n}\n// https://stackoverflow.com/questions/75928310/how-to-detect-that-import-some-url-failed-because-some-url-isnt-a-javasc\nfunction isFetchError(err) {\n    if (!(err instanceof Error))\n        return false;\n    // https://github.com/stacks-network/clarity-js-sdk/blob/e757666b59af00b5db04dd1bf0df016e3a459ea2/packages/clarity/src/providers/registry.ts#L40-L45\n    // https://github.com/modernweb-dev/web/blob/0a59b56e4c1b50af81fbf4588f36a1ceb71f3976/integration/test-runner/tests/test-failure/runTestFailureTest.ts#L11-L18\n    const FAILED_TO_FETCH_MESSAGES = [\n        // chromium\n        'Failed to fetch dynamically imported module',\n        // firefox\n        'error loading dynamically imported module',\n        // safari\n        'Importing a module script failed',\n        // ??\n        'error resolving module specifier',\n        // ??\n        'failed to resolve module',\n    ];\n    return FAILED_TO_FETCH_MESSAGES.some((s) => err.message.toLowerCase().includes(s.toLowerCase()));\n}\n","// TODO: rename_full skipLink isLinkSkipped\nexport { skipLink };\nexport { isLinkIgnored };\nexport { isSameAsCurrentUrl };\nimport { normalizeClientSideUrl } from '../shared/normalizeClientSideUrl.js';\nimport { getBaseServer } from './getBaseServer.js';\nimport { assert, parseUrl, isBaseServer, isUrl, isUrlExternal } from './utils.js';\nfunction skipLink(linkTag) {\n    const href = linkTag.getAttribute('href');\n    return (href === null ||\n        !isUrl(href) ||\n        href === '' ||\n        isUrlExternal(href) ||\n        isSamePageHashLink(href) ||\n        isNewTabLink(linkTag) ||\n        isLinkIgnored(linkTag) ||\n        !hasBaseServer(href) ||\n        // Purposely last because disableAutomaticLinkInterception will be removed in the next major release\n        !isVikeLink(linkTag));\n}\n// TO-DO/next-major-release: remove this in favor of synchronously checking whether URL matches the route of a page (possible since Async Route Functions will be deprecated)\nfunction isVikeLink(linkTag) {\n    const disableAutomaticLinkInterception = isDisableAutomaticLinkInterception();\n    if (!disableAutomaticLinkInterception) {\n        return true;\n    }\n    else {\n        // TODO: rename target attrVal\n        const target = linkTag.getAttribute('data-vike-link');\n        return target !== null && target !== 'false';\n    }\n}\n// TODO rename\nfunction isNewTabLink(linkTag) {\n    const target = linkTag.getAttribute('target');\n    const rel = linkTag.getAttribute('rel');\n    return target === '_blank' || target === '_external' || rel === 'external' || linkTag.hasAttribute('download');\n}\nfunction isLinkIgnored(linkTag) {\n    return linkTag.getAttribute('data-vike') === 'false';\n}\n// TODO refactor both functions below?\nfunction isSamePageHashLink(href) {\n    if (href.startsWith('#'))\n        return true;\n    // TODO: remove?\n    if (href.includes('#') &&\n        normalizeClientSideUrl(href, { withoutHash: true }) ===\n            normalizeClientSideUrl(window.location.href, { withoutHash: true })) {\n        return true;\n    }\n    return false;\n}\nfunction isSameAsCurrentUrl(href) {\n    if (href.startsWith('#'))\n        return href === window.location.hash;\n    return normalizeClientSideUrl(href) === normalizeClientSideUrl(window.location.href);\n}\nfunction hasBaseServer(href) {\n    const baseServer = getBaseServer();\n    assert(isBaseServer(baseServer));\n    const { isBaseMissing } = parseUrl(href, baseServer);\n    return !isBaseMissing;\n}\nfunction isDisableAutomaticLinkInterception() {\n    // @ts-ignore\n    return !!window._disableAutomaticLinkInterception;\n    /* globalObject should be used if we want to make disableAutomaticLinkInterception a page-by-page setting\n    return globalObject.disableAutomaticLinkInterception ?? false\n    */\n}\n","export { getExportNames };\nimport { assert } from '../../utils.js';\nfunction getExportNames(p) {\n    if (p.fileType === '.css') {\n        return [];\n    }\n    if (p.exportNames) {\n        return p.exportNames;\n    }\n    assert(p.fileExports, p.filePath);\n    const exportNames = Object.keys(p.fileExports);\n    return exportNames;\n}\n","export { analyzeExports };\nimport { getExportNames } from './getExportNames.js';\nimport { assertUsage } from '../../utils.js';\n// TO-DO/next-major-release: remove\nfunction analyzeExports({ pageFilesClientSide, pageFilesServerSide, pageId, }) {\n    return { isHtmlOnly: isHtmlOnly(), isClientRouting: isClientRouting() };\n    function isHtmlOnly() {\n        {\n            const hasPageIdIsmrphFile = pageFilesServerSide.some((p) => p.pageId === pageId && p.fileType === '.page');\n            if (hasPageIdIsmrphFile) {\n                assertClientSideRenderHook();\n                return false;\n            }\n        }\n        {\n            const hasPageIdServerFile = pageFilesServerSide.some((p) => p.pageId === pageId && p.fileType === '.page.server');\n            if (!hasPageIdServerFile) {\n                return false;\n            }\n        }\n        {\n            const definesClientRenderer = pageFilesClientSide.some((p) => p.pageId === pageId && p.fileType === '.page.client' && getExportNames(p).includes('render'));\n            if (definesClientRenderer) {\n                return false;\n            }\n        }\n        return true;\n    }\n    function assertClientSideRenderHook() {\n        const hasClientSideRenderHook = pageFilesClientSide.some((p) => {\n            return getExportNames(p).includes('render');\n        });\n        assertUsage(hasClientSideRenderHook, [\n            'No client-side `render()` hook found.',\n            'See https://vike.dev/render-modes for more information.',\n            [\n                'Loaded client-side page files (none of them `export { render }`):',\n                ...pageFilesClientSide.map((p, i) => ` (${i + 1}): ${p.filePath}`),\n            ].join('\\n'),\n        ].join(' '));\n    }\n    function isClientRouting() {\n        const hasClientRoutingExport = pageFilesClientSide.some((p) => {\n            return getExportNames(p).includes('clientRouting');\n        });\n        return hasClientRoutingExport;\n    }\n}\n","// TO-DO/next-major-release: remove\nexport { determineClientEntry };\nexport { getVikeClientEntry };\nfunction determineClientEntry({ pageFilesClientSide, pageFilesServerSide, isHtmlOnly, isClientRouting, }) {\n    let clientEntries = [];\n    const pageFilesServerSideOnly = pageFilesServerSide.filter((p) => !pageFilesClientSide.includes(p));\n    const clientDependencies = [];\n    clientDependencies.push(...pageFilesClientSide.map((p) => ({ id: p.filePath, onlyAssets: false, eagerlyImported: false })));\n    // CSS & assets\n    clientDependencies.push(...pageFilesServerSideOnly.map((p) => ({ id: p.filePath, onlyAssets: true, eagerlyImported: false })));\n    // Handle SPA & SSR pages.\n    if (isHtmlOnly) {\n        clientEntries = pageFilesClientSide.map((p) => p.filePath);\n    }\n    else {\n        // Add the vike client entry\n        const clientEntry = getVikeClientEntry(isClientRouting);\n        clientDependencies.push({ id: clientEntry, onlyAssets: false, eagerlyImported: false });\n        clientEntries = [clientEntry];\n    }\n    // console.log(pageFilesClientSide, pageFilesServerSide, clientDependencies, clientEntry)\n    return { clientEntries, clientDependencies };\n}\nfunction getVikeClientEntry(isClientRouting) {\n    return isClientRouting\n        ? '@@vike/dist/esm/client/runtime-client-routing/entry.js'\n        : '@@vike/dist/esm/client/runtime-server-routing/entry.js';\n}\n","export { analyzePageClientSide };\nexport { analyzePageClientSideInit };\nimport { analyzeExports } from './analyzePageClientSide/analyzeExports.js';\nimport { determineClientEntry } from './analyzePageClientSide/determineClientEntry.js';\nimport { getPageFilesClientSide } from './getAllPageIdFiles.js';\nimport { getPageFilesServerSide } from './getAllPageIdFiles.js';\nimport { assert } from '../utils.js';\nimport { getExportNames } from './analyzePageClientSide/getExportNames.js';\n// TO-DO/next-major-release: remove analyzePageClientSide(), use analyzeClientSide() instead\nfunction analyzePageClientSide(pageFilesAll, pageId) {\n    let pageFilesClientSide = getPageFilesClientSide(pageFilesAll, pageId);\n    const pageFilesServerSide = getPageFilesServerSide(pageFilesAll, pageId);\n    const { isHtmlOnly, isClientRouting } = analyzeExports({ pageFilesClientSide, pageFilesServerSide, pageId });\n    if (isHtmlOnly) {\n        // HTML-only pages don't need any client-side `render()` hook. For apps that have both HTML-only and SSR/SPA pages, we skip the `.page.client.js` file that defines `render()` for HTML-only pages.\n        pageFilesClientSide = pageFilesClientSide.filter((p) => p.isEnv('CLIENT_ONLY') && !getExportNames(p).includes('render'));\n        pageFilesClientSide = removeOverriddenPageFiles(pageFilesClientSide);\n    }\n    const { clientEntries, clientDependencies } = determineClientEntry({\n        pageFilesClientSide,\n        pageFilesServerSide,\n        isHtmlOnly,\n        isClientRouting,\n    });\n    return { isHtmlOnly, isClientRouting, clientEntries, clientDependencies, pageFilesClientSide, pageFilesServerSide };\n}\n// TO-DO/next-major-release: remove\nasync function analyzePageClientSideInit(pageFilesAll, pageId, { sharedPageFilesAlreadyLoaded }) {\n    const pageFilesClientSide = getPageFilesClientSide(pageFilesAll, pageId);\n    await Promise.all(pageFilesClientSide.map(async (p) => {\n        assert(p.isEnv('CLIENT_ONLY') || p.isEnv('CLIENT_AND_SERVER'));\n        if (sharedPageFilesAlreadyLoaded && p.isEnv('CLIENT_AND_SERVER')) {\n            return;\n        }\n        await p.loadExportNames?.();\n        /*\n        if (pageFile.exportNames) {\n          return pageFile.exportNames.includes(clientRouting)\n        }\n        if (pageFile.fileExports) {\n          return Object.keys(pageFile.fileExports).includes(clientRouting)\n        }\n        */\n    }));\n}\n// [WIP] Just an experiment needed by https://vike.dev/banner\n//  - Not sure I want to make something like a public API: the CSS of `_default.page.server.js` are still loaded -> weird DX.\nfunction removeOverriddenPageFiles(pageFilesClientSide) {\n    const pageFilesClientSide_ = [];\n    for (const p of pageFilesClientSide) {\n        pageFilesClientSide_.push(p);\n        if (getExportNames(p).includes('overrideDefaultPages')) {\n            break;\n        }\n    }\n    return pageFilesClientSide_;\n}\n","export { analyzeClientSide };\nimport { getConfigValueRuntime } from '../page-configs/getConfigValueRuntime.js';\nimport { analyzePageClientSide } from './analyzePageClientSide.js';\nfunction analyzeClientSide(pageConfig, pageFilesAll, pageId) {\n    // V1 design\n    if (pageConfig) {\n        const isClientRouting = getConfigValueRuntime(pageConfig, 'clientRouting', 'boolean')?.value ?? false;\n        const isClientRuntimeLoaded = getConfigValueRuntime(pageConfig, 'isClientRuntimeLoaded', 'boolean')?.value ?? false;\n        return { isClientRuntimeLoaded, isClientRouting };\n    }\n    else {\n        // TO-DO/next-major-release: remove\n        // V0.4 design\n        const { isHtmlOnly, isClientRouting } = analyzePageClientSide(pageFilesAll, pageId);\n        return { isClientRuntimeLoaded: !isHtmlOnly, isClientRouting };\n    }\n}\n","export { isClientSideRoutable };\nimport { analyzePageClientSideInit } from '../../shared/getPageFiles/analyzePageClientSide.js';\nimport { findPageConfig } from '../../shared/page-configs/findPageConfig.js';\nimport { analyzeClientSide } from '../../shared/getPageFiles/analyzeClientSide.js';\n// TO-DO/next-major-release: make it sync\nasync function isClientSideRoutable(pageId, pageContext) {\n    await analyzePageClientSideInit(pageContext._pageFilesAll, pageId, {\n        sharedPageFilesAlreadyLoaded: false,\n    });\n    const pageConfig = findPageConfig(pageContext._globalContext._pageConfigs, pageId);\n    const { isClientRuntimeLoaded, isClientRouting } = analyzeClientSide(pageConfig, pageContext._pageFilesAll, pageId);\n    return isClientRuntimeLoaded && isClientRouting;\n}\n","export { resolveRouteString };\nexport { getUrlFromRouteString };\nexport { isStaticRouteString };\nexport { analyzeRouteString };\nexport { assertRouteString };\nexport { getRouteStringParameterList };\nimport { assertWarning, isBrowser, escapeRegex } from '../utils.js';\nimport { assert, assertUsage } from './utils.js';\nimport pc from '@brillout/picocolors';\nconst PARAM_TOKEN_NEW = '@';\n// TO-DO/next-major-release: remove\nconst PARAM_TOKEN_OLD = ':';\nfunction assertRouteString(routeString, errPrefix = 'Invalid') {\n    let errPrefix2 = `${errPrefix} Route String ${highlight(routeString)}`;\n    assertUsage(routeString !== '', `${errPrefix2} (empty string): set it to ${highlight('/')} instead`);\n    assertUsage(['/', '*'].includes(routeString[0]), `${errPrefix2}: it should start with ${highlight('/')} or ${highlight('*')}`);\n    assertUsage(!routeString.includes('**'), `${errPrefix2}: set it to ${highlight(routeString.split('**').join('*'))} instead`);\n}\nfunction resolveRouteString(routeString, urlPathname) {\n    assertRouteString(routeString);\n    const segments = parseRouteString(routeString);\n    const routeRegexStrInner = segments\n        .map((segment) => {\n        if (segment.param) {\n            return '[^/]+';\n        }\n        if (segment.glob) {\n            return '.*';\n        }\n        // segment.static\n        return escapeRegex(segment.static);\n    })\n        .map((s) => `(${s})`)\n        .join('');\n    const routeRegex = new RegExp(`^${routeRegexStrInner}/?$`);\n    const routeRegexMatch = urlPathname.match(routeRegex);\n    /* DEBUG\n    console.log()\n    console.log('routeString', routeString)\n    console.log('urlPathname', urlPathname)\n    console.log('routeSegments', segments)\n    console.log('routeRegex', routeRegex)\n    console.log('routeRegexMatch', routeRegexMatch)\n    //*/\n    if (!routeRegexMatch)\n        return null;\n    const routeParams = {};\n    const [_, ...segmentsValue] = routeRegexMatch;\n    let globIdx = 0;\n    const hasMultipleGlobs = segments.filter((segment) => segment.glob).length > 1;\n    segments.forEach((segment, i) => {\n        let val = segmentsValue[i];\n        if (segment.param) {\n            routeParams[segment.param] = val;\n        }\n        if (segment.glob) {\n            const param = `*${hasMultipleGlobs ? ++globIdx : ''}`;\n            routeParams[param] = val;\n        }\n    });\n    return { routeParams };\n}\nfunction parseRouteString(routeString) {\n    const segments = [];\n    const pushStatic = (s) => {\n        const segmentLast = segments[segments.length - 1];\n        if (segmentLast?.static) {\n            segmentLast.static += s;\n        }\n        else {\n            segments.push({ static: s });\n        }\n    };\n    const parts = routeString.split('/');\n    parts.forEach((s, i) => {\n        if (i !== 0)\n            pushStatic('/');\n        if (isParam(s)) {\n            assertWarning(!s.startsWith(PARAM_TOKEN_OLD), `Outdated Route String ${highlight(routeString)}, use ${highlight(routeString.split(PARAM_TOKEN_OLD).join(PARAM_TOKEN_NEW))} instead`, { onlyOnce: true });\n            segments.push({ param: s.slice(1) });\n        }\n        else {\n            if (s === '*' && i === parts.length - 1 && routeString !== '*' && routeString !== '/*') {\n                segments.push({ glob: true });\n            }\n            else {\n                s.split('*').forEach((s, i) => {\n                    if (i !== 0)\n                        segments.push({ glob: true });\n                    if (s !== '') {\n                        pushStatic(s);\n                    }\n                });\n            }\n        }\n    });\n    return segments;\n}\nfunction getRouteStringParameterList(routeString) {\n    const routeParameterList = [];\n    const segments = parseRouteString(routeString);\n    segments.forEach((segment) => {\n        if (segment.param)\n            routeParameterList.push(segment.param);\n    });\n    return routeParameterList;\n}\nfunction getUrlFromRouteString(routeString) {\n    if (isStaticRouteString(routeString)) {\n        const url = routeString;\n        return url;\n    }\n    return null;\n}\nfunction analyzeRouteString(routeString) {\n    const segments = parseRouteString(routeString);\n    const countStaticParts = (s) => s?.split('/').filter(Boolean).length || 0;\n    let numberOfStaticPartsBeginning = 0;\n    for (const segment of segments) {\n        if (!segment.static)\n            break;\n        numberOfStaticPartsBeginning += countStaticParts(segment.static);\n    }\n    const numberOfStaticParts = segments.map((s) => countStaticParts(s.static)).reduce((sum, a) => sum + a, 0);\n    const numberOfParams = segments.filter((s) => s.param).length;\n    const numberOfGlobs = segments.filter((s) => s.glob).length;\n    return { numberOfStaticPartsBeginning, numberOfStaticParts, numberOfParams, numberOfGlobs };\n}\nfunction isParam(routeSegment) {\n    return routeSegment.startsWith(PARAM_TOKEN_NEW) || routeSegment.startsWith(PARAM_TOKEN_OLD);\n}\nfunction isStaticRouteString(routeString) {\n    const url = routeString;\n    const match = resolveRouteString(routeString, url);\n    assert(match);\n    return Object.keys(match.routeParams).length === 0;\n}\nfunction highlight(routeString) {\n    if (isBrowser()) {\n        return `'${routeString}'`;\n    }\n    else {\n        if (routeString === '') {\n            routeString = \"''\";\n        }\n        return pc.cyan(routeString);\n    }\n}\n","export { resolvePrecedence };\n// export type { RouteMatch }\nimport { analyzeRouteString } from './resolveRouteString.js';\nimport { higherFirst, lowerFirst } from './utils.js';\nimport { makeFirst } from './utils.js';\nimport { isStaticRouteString } from './resolveRouteString.js';\n// See https://vike.dev/route-function#precedence\nfunction resolvePrecedence(routeMatches) {\n    // prettier-ignore\n    // biome-ignore format:\n    routeMatches\n        .sort(sortMatches)\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'FUNCTION' && !!routeMatch.precedence && routeMatch.precedence < 0))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'STRING' && isStaticRouteString(routeMatch.routeString) === false))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'FUNCTION' && !routeMatch.precedence))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'STRING' && isStaticRouteString(routeMatch.routeString) === true))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'FILESYSTEM'))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'FUNCTION' && !!routeMatch.precedence && routeMatch.precedence > 0));\n}\n// -1 => routeMatch1 higher precedence\n// +1 => routeMatch2 higher precedence\nfunction sortMatches(routeMatch1, routeMatch2) {\n    {\n        const precedence1 = routeMatch1.precedence ?? 0;\n        const precedence2 = routeMatch2.precedence ?? 0;\n        if (precedence1 !== precedence2) {\n            return precedence1 > precedence2 ? -1 : 1;\n        }\n    }\n    if (!routeMatch2.routeString) {\n        return 0;\n    }\n    if (!routeMatch1.routeString) {\n        return 0;\n    }\n    /* DEBUG\n    console.log('routeMatch1.routeString', routeMatch1.routeString)\n    console.log('routeMatch2.routeString', routeMatch2.routeString)\n    console.log('parseRouteString(routeMatch1.routeString)', parseRouteString(routeMatch1.routeString))\n    console.log('parseRouteString(routeMatch2.routeString)', parseRouteString(routeMatch2.routeString))\n    //*/\n    // Return route with highest number of static path segments at beginning first\n    {\n        const getValue = (routeString) => analyzeRouteString(routeString).numberOfStaticPartsBeginning;\n        const result = higherFirst(getValue)(routeMatch1.routeString, routeMatch2.routeString);\n        if (result !== 0) {\n            /* DEBUG\n            console.log('analyzeRouteString(routeMatch1.routeString).numberOfStaticPartsBeginning', getValue(routeMatch1.routeString))\n            console.log('analyzeRouteString(routeMatch2.routeString).numberOfStaticPartsBeginning', getValue(routeMatch2.routeString))\n            //*/\n            return result;\n        }\n    }\n    // Return route with highest number of static path segments in total first\n    {\n        const getValue = (routeString) => analyzeRouteString(routeString).numberOfStaticParts;\n        const result = higherFirst(getValue)(routeMatch1.routeString, routeMatch2.routeString);\n        if (result !== 0) {\n            /* DEBUG\n            console.log('analyzeRouteString(routeMatch1.routeString).numberOfStaticParts', getValue(routeMatch1.routeString))\n            console.log('analyzeRouteString(routeMatch2.routeString).numberOfStaticParts', getValue(routeMatch2.routeString))\n            //*/\n            return result;\n        }\n    }\n    // Return route with least amount of globs first\n    {\n        const getValue = (routeString) => analyzeRouteString(routeString).numberOfGlobs;\n        const result = lowerFirst(getValue)(routeMatch1.routeString, routeMatch2.routeString);\n        if (result !== 0) {\n            /* DEBUG\n            console.log('analyzeRouteString(routeMatch1.routeString).numberOfGlobs', getValue(routeMatch1.routeString))\n            console.log('analyzeRouteString(routeMatch2.routeString).numberOfGlobs', getValue(routeMatch2.routeString))\n            //*/\n            return result;\n        }\n    }\n    // Return route with highest number of parameters first\n    {\n        const getValue = (routeString) => analyzeRouteString(routeString).numberOfParams;\n        const result = higherFirst(getValue)(routeMatch1.routeString, routeMatch2.routeString);\n        if (result !== 0) {\n            /* DEBUG\n            console.log('analyzeRouteString(routeMatch1.routeString).numberOfParams', getValue(routeMatch1.routeString))\n            console.log('analyzeRouteString(routeMatch2.routeString).numberOfParams', getValue(routeMatch2.routeString))\n            //*/\n            return result;\n        }\n    }\n    return 0;\n}\n","export { execHookOnBeforeRoute };\nimport { assertPageContextProvidedByUser } from '../assertPageContextProvidedByUser.js';\nimport { assertUsage, hasProp, isObjectWithKeys, objectAssign, assertWarning, assertUsageUrlAbsolute, joinEnglish, assert, } from './utils.js';\nimport { assertRouteParams, assertSyncRouting } from './resolveRouteFunction.js';\nimport pc from '@brillout/picocolors';\nimport { execHookDirectSync } from '../hooks/execHook.js';\nimport { preparePageContextForPublicUsage, } from '../preparePageContextForPublicUsage.js';\nasync function execHookOnBeforeRoute(pageContext) {\n    const pageContextFromOnBeforeRouteHook = {};\n    if (!pageContext._globalContext._onBeforeRouteHook)\n        return null;\n    const pageContextFromHook = await getPageContextFromHook(pageContext._globalContext._onBeforeRouteHook, pageContext);\n    if (pageContextFromHook) {\n        objectAssign(pageContextFromOnBeforeRouteHook, pageContextFromHook);\n        if (hasProp(pageContextFromOnBeforeRouteHook, 'pageId', 'string') ||\n            hasProp(pageContextFromOnBeforeRouteHook, 'pageId', 'null')) {\n            // We bypass Vike's routing\n            if (!hasProp(pageContextFromOnBeforeRouteHook, 'routeParams')) {\n                objectAssign(pageContextFromOnBeforeRouteHook, { routeParams: {} });\n            }\n            else {\n                assert(hasProp(pageContextFromOnBeforeRouteHook, 'routeParams', 'object'));\n            }\n            objectAssign(pageContextFromOnBeforeRouteHook, {\n                _routingProvidedByOnBeforeRouteHook: true,\n            });\n            return pageContextFromOnBeforeRouteHook;\n        }\n    }\n    objectAssign(pageContextFromOnBeforeRouteHook, {\n        _routingProvidedByOnBeforeRouteHook: false,\n    });\n    return pageContextFromOnBeforeRouteHook;\n}\nasync function getPageContextFromHook(onBeforeRouteHook, pageContext) {\n    let { hookReturn } = execHookDirectSync(onBeforeRouteHook, pageContext, preparePageContextForPublicUsage);\n    assertSyncRouting(hookReturn, `The onBeforeRoute() hook ${onBeforeRouteHook.hookFilePath}`);\n    // TO-DO/next-major-release: make execHookOnBeforeRoute() and route() sync\n    hookReturn = await hookReturn;\n    const errPrefix = `The onBeforeRoute() hook defined by ${onBeforeRouteHook.hookFilePath}`;\n    assertUsage(hookReturn === null ||\n        hookReturn === undefined ||\n        (isObjectWithKeys(hookReturn, ['pageContext']) && hasProp(hookReturn, 'pageContext')), `${errPrefix} should return ${pc.cyan('null')}, ${pc.cyan('undefined')}, or a plain JavaScript object ${pc.cyan('{ pageContext: { /* ... */ } }')}`);\n    if (hookReturn === null || hookReturn === undefined) {\n        return null;\n    }\n    assertUsage(hasProp(hookReturn, 'pageContext', 'object'), `${errPrefix} returned ${pc.cyan('{ pageContext }')} but pageContext should be a plain JavaScript object.`);\n    if (hasProp(hookReturn.pageContext, 'pageId') && !hasProp(hookReturn.pageContext, 'pageId', 'null')) {\n        const errPrefix2 = `${errPrefix} returned ${pc.cyan('{ pageContext: { pageId } }')} but ${pc.cyan('pageId')} should be`;\n        assertUsage(hasProp(hookReturn.pageContext, 'pageId', 'string'), `${errPrefix2} a string or null`);\n        assertUsage(pageContext._globalContext._allPageIds.includes(hookReturn.pageContext.pageId), `${errPrefix2} ${joinEnglish(pageContext._globalContext._allPageIds.map((s) => pc.cyan(s)), 'or')}`);\n    }\n    if (hasProp(hookReturn.pageContext, 'routeParams')) {\n        assertRouteParams(hookReturn.pageContext, `${errPrefix} returned ${pc.cyan('{ pageContext: { routeParams } }')} but routeParams should`);\n    }\n    const deprecatedReturn = (prop) => `${errPrefix} returned ${pc.cyan(`{ pageContext: { ${prop} } }`)} which is deprecated. Return ${pc.cyan('{ pageContext: { urlLogical } }')} instead.`;\n    if (hasProp(hookReturn.pageContext, 'url')) {\n        assertWarning(false, deprecatedReturn('url'), { onlyOnce: true });\n        hookReturn.pageContext.urlLogical = hookReturn.pageContext.url;\n        delete hookReturn.pageContext.url;\n    }\n    if (hasProp(hookReturn.pageContext, 'urlOriginal')) {\n        assertWarning(false, deprecatedReturn('urlOriginal'), { onlyOnce: true });\n        hookReturn.pageContext.urlLogical = hookReturn.pageContext.urlOriginal;\n        delete hookReturn.pageContext.urlOriginal;\n    }\n    if (hasProp(hookReturn.pageContext, 'urlLogical')) {\n        assertUsageUrlAbsolute(\n        // We type-cast instead of assertUsage() validation in order to save client-side KBs\n        hookReturn.pageContext.urlLogical, `${errPrefix} returned ${pc.cyan('{ pageContext: { urlLogical } }')} and ${pc.cyan('urlLogical')}`);\n    }\n    assertPageContextProvidedByUser(hookReturn.pageContext, {\n        hookFilePath: onBeforeRouteHook.hookFilePath,\n        hookName: 'onBeforeRoute',\n    });\n    const pageContextAddendumHook = {};\n    objectAssign(pageContextAddendumHook, hookReturn.pageContext);\n    return pageContextAddendumHook;\n}\n","export { route };\n// Ensure we don't bloat runtime of Server Routing\nimport { assertClientRouting } from '../../utils/assertRoutingType.js';\nimport { isBrowser } from '../../utils/isBrowser.js';\nif (isBrowser()) {\n    assertClientRouting();\n}\nimport { assert, assertUsage, isPlainObject, objectAssign, debug } from './utils.js';\nimport { resolvePrecedence } from './resolvePrecedence.js';\nimport { resolveRouteString } from './resolveRouteString.js';\nimport { resolveRouteFunction } from './resolveRouteFunction.js';\nimport { execHookOnBeforeRoute } from './execHookOnBeforeRoute.js';\nimport pc from '@brillout/picocolors';\n// TO-DO/next-major-release: make it sync\nasync function route(pageContext, skipOnBeforeRouteHook) {\n    const pageContextFromRoute = {};\n    if (\n    // Tree-shaking to save client-side KBs\n    !globalThis.__VIKE__IS_CLIENT ||\n        globalThis.__VIKE__IS_DEBUG) {\n        debug('vike:routing', 'Pages routes:', pageContext._globalContext._pageRoutes);\n    }\n    // onBeforeRoute()\n    if (!skipOnBeforeRouteHook) {\n        const pageContextFromOnBeforeRouteHook = await execHookOnBeforeRoute(pageContext);\n        if (pageContextFromOnBeforeRouteHook) {\n            if (pageContextFromOnBeforeRouteHook._routingProvidedByOnBeforeRouteHook) {\n                assert(pageContextFromOnBeforeRouteHook.pageId);\n                return pageContextFromOnBeforeRouteHook;\n            }\n            else {\n                objectAssign(pageContextFromRoute, pageContextFromOnBeforeRouteHook);\n            }\n        }\n        // We take into account pageContext.urlLogical set by onBeforeRoute()\n        objectAssign(pageContext, pageContextFromOnBeforeRouteHook);\n    }\n    // Vike's routing\n    const allPageIds = pageContext._globalContext._allPageIds;\n    assertUsage(allPageIds.length > 0, 'No page found. You must create at least one page.');\n    assert(pageContext._globalContext._pageFilesAll.length > 0 || pageContext._globalContext._pageConfigs.length > 0);\n    const { urlPathname } = pageContext;\n    assert(urlPathname.startsWith('/'));\n    const routeMatches = [];\n    await Promise.all(pageContext._globalContext._pageRoutes.map(async (pageRoute) => {\n        const { pageId, routeType } = pageRoute;\n        // Filesystem Routing\n        if (pageRoute.routeType === 'FILESYSTEM') {\n            const { routeString } = pageRoute;\n            const match = resolveRouteString(routeString, urlPathname);\n            if (match) {\n                const { routeParams } = match;\n                routeMatches.push({ pageId, routeParams, routeString, routeType });\n            }\n            return;\n        }\n        // Route String defined in `.page.route.js`\n        if (pageRoute.routeType === 'STRING') {\n            const { routeString } = pageRoute;\n            const match = resolveRouteString(routeString, urlPathname);\n            if (match) {\n                const { routeParams } = match;\n                assert(routeType === 'STRING');\n                routeMatches.push({\n                    pageId,\n                    routeString,\n                    routeParams,\n                    routeType,\n                });\n            }\n            return;\n        }\n        // Route Function defined in `.page.route.js`\n        if (pageRoute.routeType === 'FUNCTION') {\n            const { routeFunction, routeFunctionFilePath } = pageRoute;\n            const match = await resolveRouteFunction(routeFunction, pageContext, routeFunctionFilePath);\n            if (match) {\n                const { routeParams, precedence } = match;\n                routeMatches.push({ pageId, precedence, routeParams, routeType });\n            }\n            return;\n        }\n        assert(false);\n    }));\n    resolvePrecedence(routeMatches);\n    const winner = routeMatches[0] ?? null;\n    if (\n    // Tree-shaking to save client-side KBs\n    !globalThis.__VIKE__IS_CLIENT ||\n        globalThis.__VIKE__IS_DEBUG) {\n        debug('vike:routing', `Route matches for URL ${pc.cyan(urlPathname)} (in precedence order):`, routeMatches);\n    }\n    // For vite-plugin-vercel https://github.com/magne4000/vite-plugin-vercel/blob/main/packages/vike-integration/vike.ts#L173\n    objectAssign(pageContextFromRoute, { _routeMatch: winner });\n    if (!winner) {\n        objectAssign(pageContextFromRoute, {\n            pageId: null,\n            routeParams: {},\n        });\n        return pageContextFromRoute;\n    }\n    {\n        const { routeParams } = winner;\n        assert(isPlainObject(routeParams));\n        objectAssign(pageContextFromRoute, {\n            pageId: winner.pageId,\n            routeParams: winner.routeParams,\n        });\n    }\n    return pageContextFromRoute;\n}\n","export { setPageContextCurrent };\nexport { getPageContextCurrent };\nimport { getGlobalObject } from './utils.js';\nconst globalObject = getGlobalObject('runtime-client-routing/getPageContextCurrent.ts', {\n    pageContextCurrent: null,\n});\nfunction getPageContextCurrent() {\n    const { pageContextCurrent } = globalObject;\n    return pageContextCurrent;\n}\nfunction setPageContextCurrent(pageContextCurrent) {\n    globalObject.pageContextCurrent = pageContextCurrent;\n}\n","// TO-DO/pageContext-prefetch: rename this file to getPrefetchSettingResolved.ts\nexport { getPrefetchSettings };\nexport { PAGE_CONTEXT_MAX_AGE_DEFAULT };\nimport { assertUsage, assertInfo } from '../utils.js';\n// TO-DO/pageContext-prefetch: Make it `Infinity` for pre-rendered pages.\nconst PAGE_CONTEXT_MAX_AGE_DEFAULT = 5000;\nconst prefetchSettingTrue = {\n    staticAssets: 'hover',\n    pageContext: PAGE_CONTEXT_MAX_AGE_DEFAULT,\n};\nconst prefetchSettingFalse = {\n    staticAssets: 'hover',\n    pageContext: false,\n};\n// TO-DO/eventually: change to `prefetchSettingTrue`\nconst prefetchSettingDefault = prefetchSettingFalse;\nfunction getPrefetchSettings(pageContext, linkTag) {\n    let prefetchSetting = prefetchSettingDefault;\n    // TO-DO/next-major-release: remove\n    if ('prefetchLinks' in pageContext.exports) {\n        assertUsage(false, '`export { prefetchLinks }` is deprecated, use `export { prefetchStaticAssets }` instead.');\n    }\n    // TO-DO/next-major-release: remove\n    if ('prefetchStaticAssets' in pageContext.exports) {\n        const prefetchStaticAssets = pageContext.exports.prefetchStaticAssets;\n        /* TO-DO/pageContext-prefetch: uncomment\n        const msg = `The 'prefetchStaticAssets' setting is deprecated in favor of the 'prefetch' setting, see https://vike.dev/prefetch`\n        assertWarning(false, msg, { onlyOnce: true })\n        assertUsage(\n          prefetchStaticAssets === false || prefetchStaticAssets === 'hover' || prefetchStaticAssets === 'viewport',\n          msg\n        )\n        //*/\n        prefetchSetting.staticAssets = prefetchStaticAssets;\n    }\n    if ('prefetch' in pageContext.exports) {\n        const { prefetch } = pageContext.exports;\n        if (prefetch === true)\n            prefetchSetting = prefetchSettingTrue;\n        if (prefetch === false)\n            prefetchSetting = prefetchSettingFalse;\n        // No validation in order to save client-side KBs\n        Object.assign(prefetchSetting, prefetch);\n        if (prefetchSetting.pageContext === true) {\n            prefetchSetting.pageContext = PAGE_CONTEXT_MAX_AGE_DEFAULT;\n        }\n    }\n    if (prefetchSetting.staticAssets === 'viewport' && import.meta.env.DEV) {\n        assertInfo(false, 'Viewport prefetching is disabled in development', { onlyOnce: true });\n        prefetchSetting.staticAssets = 'hover';\n    }\n    if (linkTag) {\n        {\n            let attr = linkTag.getAttribute('data-prefetch');\n            if (attr !== null) {\n                if (attr === '')\n                    attr = 'true';\n                if (attr === 'true')\n                    prefetchSetting = prefetchSettingTrue;\n                if (attr === 'false')\n                    prefetchSetting = prefetchSettingFalse;\n            }\n        }\n        {\n            let attr = linkTag.getAttribute('data-prefetch-static-assets');\n            if (attr !== null) {\n                if (attr === 'false')\n                    prefetchSetting.staticAssets = false;\n                // No validation in order to save client-side KBs\n                prefetchSetting.staticAssets = attr;\n            }\n        }\n        {\n            let attr = linkTag.getAttribute('data-prefetch-page-context');\n            if (attr !== null) {\n                if (attr === '')\n                    attr = 'true';\n                if (attr === 'true')\n                    prefetchSetting.pageContext = PAGE_CONTEXT_MAX_AGE_DEFAULT;\n                if (attr === 'false')\n                    prefetchSetting.pageContext = false;\n                const n = parseInt(attr, 10);\n                if (!Number.isNaN(n))\n                    prefetchSetting.pageContext = n;\n                // No validation in order to save client-side KBs\n            }\n        }\n    }\n    return prefetchSetting;\n}\n","export { prefetch };\nexport { getPageContextPrefetched };\nexport { initLinkPrefetchHandlers };\nexport { populatePageContextPrefetchCache };\nexport { addLinkPrefetchHandlers };\nexport { addLinkPrefetchHandlers_watch };\nexport { addLinkPrefetchHandlers_unwatch };\nimport { assert, assertClientRouting, assertUsage, assertWarning, checkIfClientRouting, getGlobalObject, hasProp, objectAssign, } from './utils.js';\nimport { isErrorFetchingStaticAssets, loadPageConfigsLazyClientSide } from '../shared/loadPageConfigsLazyClientSide.js';\nimport { skipLink } from './skipLink.js';\nimport { disableClientRouting } from './renderPageClientSide.js';\nimport { isClientSideRoutable } from './isClientSideRoutable.js';\nimport { createPageContextClientSide } from './createPageContextClientSide.js';\nimport { route } from '../../shared/route/index.js';\nimport { noRouteMatch } from '../../shared/route/noRouteMatch.js';\nimport { getPageContextFromServerHooks } from './getPageContextFromHooks.js';\nimport { getPageContextCurrent } from './getPageContextCurrent.js';\nimport { PAGE_CONTEXT_MAX_AGE_DEFAULT, getPrefetchSettings, } from './prefetch/getPrefetchSettings.js';\nimport pc from '@brillout/picocolors';\nimport { normalizeUrlArgument } from './normalizeUrlArgument.js';\nassertClientRouting();\nconst globalObject = getGlobalObject('runtime-client-routing/prefetch.ts', {\n    linkPrefetchHandlerAdded: new WeakSet(),\n    addLinkPrefetchHandlers_debounce: null,\n    mutationObserver: new MutationObserver(addLinkPrefetchHandlers),\n    // `linkTags` [is automatically updated](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection#:~:text=An%20HTMLCollection%20in%20the%20HTML%20DOM%20is%20live%3B%20it%20is%20automatically%20updated%20when%20the%20underlying%20document%20is%20changed.)\n    linkTags: document.getElementsByTagName('A'),\n    prefetchedPageContexts: {},\n});\nfunction getPageContextPrefetched(pageContext) {\n    const prefetchSettings = getPrefetchSettings(pageContext, null);\n    // TO-DO/pageContext-prefetch: I guess we need linkTag to make this condition work\n    if (!prefetchSettings.pageContext)\n        return null;\n    const key = getCacheKey(pageContext.urlPathname);\n    const found = globalObject.prefetchedPageContexts[key];\n    if (!found || found.result.is404ServerSideRouted || isExpired(found))\n        return null;\n    const pageContextPrefetched = found.result.pageContextFromServerHooks;\n    /* TO-DO/pageContext-prefetch: make it work for when resultMaxAge is Infinity.\n    // We discard the prefetched pageContext whenever we use it, so that the user always sees fresh data upon naivgating.\n    delete globalObject.prefetchedPageContexts[key]\n    */\n    return pageContextPrefetched;\n}\nasync function prefetchAssets(pageContextLink) {\n    try {\n        await loadPageConfigsLazyClientSide(pageContextLink.pageId, pageContextLink._pageFilesAll, pageContextLink._globalContext._pageConfigs, pageContextLink._globalContext._pageConfigGlobal);\n    }\n    catch (err) {\n        if (isErrorFetchingStaticAssets(err)) {\n            disableClientRouting(err, true);\n        }\n        else {\n            throw err;\n        }\n    }\n}\nasync function prefetchPageContextFromServerHooks(pageContextLink, resultMaxAge) {\n    const result = await getPageContextFromServerHooks(pageContextLink, false);\n    setPageContextPrefetchCache(pageContextLink, result, resultMaxAge);\n}\nfunction populatePageContextPrefetchCache(pageContext /*& PageContextConfig*/, result) {\n    // TO-DO/pageContext-prefetch: replace with using pageContext.config.prerender instead. (For being able to do that: eager configs need to be accessible without have to use PageContextConfig as it isn't available here.)\n    if (!isBrilloutDocpress())\n        return;\n    setPageContextPrefetchCache(pageContext, result, null);\n}\nfunction setPageContextPrefetchCache(pageContext, result, resultMaxAge) {\n    if (resultMaxAge === null)\n        resultMaxAge = getResultMaxAge();\n    const key = getCacheKey(pageContext.urlPathname);\n    assert(isBrilloutDocpress()); // Ensure this API isn't used by anyone else\n    globalObject.prefetchedPageContexts[key] = {\n        resultFetchedAt: Date.now(),\n        resultMaxAge,\n        result,\n    };\n}\nfunction getResultMaxAge() {\n    const pageContextCurrent = getPageContextCurrent();\n    // TO-DO/pageContext-prefetch: remove this dirty hack used by @brillout/docpress and, instead, use Vike's default if pageContextCurrent isn't defined yet.\n    if (!pageContextCurrent)\n        return Infinity;\n    const prefetchSettings = getPrefetchSettings(pageContextCurrent, null);\n    const resultMaxAge = typeof prefetchSettings.pageContext === 'number' ? prefetchSettings.pageContext : PAGE_CONTEXT_MAX_AGE_DEFAULT;\n    return resultMaxAge;\n}\n/**\n * Programmatically prefetch client assets.\n *\n * https://vike.dev/prefetch\n *\n * @param url - The URL of the page you want to prefetch.\n */\nasync function prefetch(url, \n/* TO-DO/pageContext-prefetch:\noptions?: {\n  pageContext?: boolean\n  staticAssets?: boolean\n}\n*/\noptions_) {\n    const options = {\n        staticAssets: true,\n        pageContext: options_?.pageContext ?? false,\n    };\n    assertUsage(checkIfClientRouting(), 'prefetch() only works with Client Routing, see https://vike.dev/prefetch', {\n        showStackTrace: true,\n    });\n    url = normalizeUrlArgument(url, 'prefetch');\n    const pageContextLink = await getPageContextLink(url);\n    if (!pageContextLink?.pageId) {\n        assertWarning(false, `[prefetch(url)] ${pc.string(url)} ${noRouteMatch}`, {\n            showStackTrace: true,\n            onlyOnce: false,\n        });\n        return;\n    }\n    assert(hasProp(pageContextLink, 'pageId', 'string')); // help TypeScript\n    await Promise.all([\n        (async () => {\n            if (options?.staticAssets !== false) {\n                await prefetchAssets(pageContextLink);\n            }\n        })(),\n        (async () => {\n            if (options?.pageContext !== false) {\n                assertUsage(isBrilloutDocpress(), \"prefetching pageContext isn't supported yet\");\n                const resultMaxAge = typeof options?.pageContext === 'number' ? options.pageContext : null;\n                await prefetchPageContextFromServerHooks(pageContextLink, resultMaxAge);\n            }\n        })(),\n    ]);\n}\n// Lazy execution logic copied from: https://github.com/withastro/astro/blob/2594eb088d53a98181ac820243bcb1a765856ecf/packages/astro/src/runtime/client/dev-toolbar/apps/audit/index.ts#L53-L72\nfunction addLinkPrefetchHandlers() {\n    if (globalObject.addLinkPrefetchHandlers_debounce)\n        clearTimeout(globalObject.addLinkPrefetchHandlers_debounce);\n    globalObject.addLinkPrefetchHandlers_debounce = setTimeout(() => {\n        // Wait for the next idle period, as it is less likely to interfere with any other work the browser is doing post-mutation.\n        if ('requestIdleCallback' in window) {\n            requestIdleCallback(addLinkPrefetchHandlers_apply, { timeout: 300 });\n        }\n        else {\n            // Fallback for old versions of Safari, we'll assume that things are less likely to be busy after 150ms.\n            setTimeout(addLinkPrefetchHandlers_apply, 150);\n        }\n    }, 250);\n}\nfunction initLinkPrefetchHandlers() {\n    addLinkPrefetchHandlers();\n}\nfunction addLinkPrefetchHandlers_watch() {\n    // Notes about performance:\n    // - https://stackoverflow.com/questions/31659567/performance-of-mutationobserver-to-detect-nodes-in-entire-dom/39332340#39332340\n    // - https://news.ycombinator.com/item?id=15274211\n    //   - https://github.com/kubetail-org/sentineljs\n    // - https://stackoverflow.com/questions/55046093/listening-for-changes-in-htmlcollection-or-achieving-a-similar-effect\n    globalObject.mutationObserver.observe(document.body, {\n        childList: true,\n        subtree: true,\n    });\n}\nfunction addLinkPrefetchHandlers_unwatch() {\n    globalObject.mutationObserver.disconnect();\n}\nfunction addLinkPrefetchHandlers_apply() {\n    for (let linkTag of globalObject.linkTags) {\n        if (globalObject.linkPrefetchHandlerAdded.has(linkTag))\n            continue;\n        globalObject.linkPrefetchHandlerAdded.add(linkTag);\n        if (skipLink(linkTag))\n            continue;\n        linkTag.addEventListener('mouseover', () => {\n            prefetchOnEvent(linkTag, 'hover');\n        }, { passive: true });\n        linkTag.addEventListener('touchstart', () => {\n            prefetchOnEvent(linkTag, 'hover');\n        }, { passive: true });\n        const observer = new IntersectionObserver((entries) => {\n            entries.forEach((entry) => {\n                if (entry.isIntersecting) {\n                    prefetchOnEvent(linkTag, 'viewport');\n                }\n            });\n        });\n        observer.observe(linkTag);\n    }\n}\nasync function prefetchOnEvent(linkTag, event) {\n    let prefetchSettings;\n    const pageContextCurrent = getPageContextCurrent();\n    if (pageContextCurrent) {\n        prefetchSettings = getPrefetchSettings(pageContextCurrent, linkTag);\n    }\n    else {\n        if (isBrilloutDocpress()) {\n            // TO-DO/pageContext-prefetch: remove this dirty hack used by @brillout/docpress and, instead, use Vike's default if pageContextCurrent isn't defined yet.\n            prefetchSettings = { staticAssets: 'hover', pageContext: Infinity };\n        }\n        else {\n            // TO-DO/pageContext-prefetch: consider pageContextLink\n            return;\n        }\n    }\n    // Check again in case DOM was manipulated since last check\n    if (skipLink(linkTag))\n        return;\n    const urlOfLink = linkTag.getAttribute('href');\n    const pageContextLink = await getPageContextLink(urlOfLink);\n    if (!pageContextLink?.pageId)\n        return;\n    assert(hasProp(pageContextLink, 'pageId', 'string')); // help TypeScript\n    if (!(await isClientSideRoutable(pageContextLink.pageId, pageContextLink)))\n        return;\n    await Promise.all([\n        (async () => {\n            if (prefetchSettings.staticAssets === event) {\n                await prefetchAssets(pageContextLink);\n            }\n        })(),\n        (async () => {\n            if (event !== 'viewport' && prefetchSettings.pageContext) {\n                const key = getCacheKey(urlOfLink);\n                const found = globalObject.prefetchedPageContexts[key];\n                if (!found || isExpired(found)) {\n                    // TO-DO/pageContext-prefetch: move this logic in getPrefetchSettings()\n                    const resultMaxAge = prefetchSettings.pageContext;\n                    await prefetchPageContextFromServerHooks(pageContextLink, resultMaxAge);\n                }\n            }\n        })(),\n    ]);\n}\nfunction isExpired(found) {\n    return Date.now() - found.resultFetchedAt > found.resultMaxAge;\n}\n// TO-DO/next-major-release: make it sync\nasync function getPageContextLink(urlOfLink) {\n    const pageContextLink = await createPageContextClientSide(urlOfLink);\n    let pageContextFromRoute;\n    try {\n        pageContextFromRoute = await route(pageContextLink);\n    }\n    catch {\n        // If a route() hook has a bug or `throw render()` / `throw redirect()`\n        return null;\n    }\n    objectAssign(pageContextLink, pageContextFromRoute);\n    return pageContextLink;\n}\nfunction getCacheKey(url) {\n    if (url.startsWith('#'))\n        url = '/';\n    assert(url.startsWith('/'), { urlPathname: url });\n    const key = url.split('#')[0];\n    return key;\n}\n// TO-DO/pageContext-prefetch: remove\nfunction isBrilloutDocpress() {\n    return '_isBrilloutDocpress' in window;\n}\n","export { execHookOnRenderClient };\nimport { assert, assertUsage } from '../runtime-server-routing/utils.js';\nimport { getHookFromPageContext } from '../../shared/hooks/getHook.js';\nimport { execHookDirectSingle } from '../../shared/hooks/execHook.js';\nasync function execHookOnRenderClient(pageContext, prepareForPublicUsage) {\n    let hook = null;\n    {\n        const renderHook = getHookFromPageContext(pageContext, 'render');\n        hook = renderHook;\n    }\n    {\n        const renderHook = getHookFromPageContext(pageContext, 'onRenderClient');\n        if (renderHook) {\n            hook = renderHook;\n        }\n    }\n    if (!hook) {\n        const urlToShowToUser = getUrlToShowToUser(pageContext);\n        assert(urlToShowToUser);\n        if (pageContext._globalContext._pageConfigs.length > 0) {\n            // V1 design\n            assertUsage(false, `No onRenderClient() hook defined for URL '${urlToShowToUser}', but it's needed, see https://vike.dev/onRenderClient`);\n        }\n        else {\n            // TO-DO/next-major-release: remove\n            // V0.4 design\n            const pageClientsFilesLoaded = pageContext._pageFilesLoaded.filter((p) => p.fileType === '.page.client');\n            let errMsg;\n            if (pageClientsFilesLoaded.length === 0) {\n                errMsg = 'No file `*.page.client.*` found for URL ' + urlToShowToUser;\n            }\n            else {\n                errMsg =\n                    'One of the following files should export a render() hook: ' +\n                        pageClientsFilesLoaded.map((p) => p.filePath).join(' ');\n            }\n            assertUsage(false, errMsg);\n        }\n    }\n    // We don't use a try-catch wrapper because rendering errors are usually handled by the UI framework. (E.g. React's Error Boundaries.)\n    await execHookDirectSingle(hook, pageContext, prepareForPublicUsage);\n}\nfunction getUrlToShowToUser(pageContext) {\n    let url;\n    // try/catch to avoid passToClient assertUsage() (although: this may not be needed anymore, since we're now accessing pageContext and not pageContextForPublicUsage)\n    try {\n        url =\n            // Client Routing\n            pageContext.urlPathname ??\n                // Server Routing\n                pageContext.urlOriginal;\n    }\n    catch { }\n    url = url ?? window.location.href;\n    return url;\n}\n","export { pushHistoryState };\nexport { replaceHistoryStateOriginal };\nexport { onPopStateBegin };\nexport { saveScrollPosition };\nexport { initHistory };\nimport { getCurrentUrl } from '../shared/getCurrentUrl.js';\nimport { assert, assertUsage, getGlobalObject, isObject, deepEqual, cast } from './utils.js';\nconst globalObject = getGlobalObject('history.ts', {\n    monkeyPatched: false,\n    previous: undefined,\n});\ninitHistory(); // we redundantly call initHistory() to ensure it's called early\nglobalObject.previous = getHistoryInfo();\n// `window.history.state === null` when:\n// - The very first render\n// - Click on `<a href=\"#some-hash\" />`\n// - `location.hash = 'some-hash'`\nfunction enhanceHistoryState() {\n    if (isVikeEnhanced(window.history.state))\n        return;\n    const stateVikeEnhanced = enhance(window.history.state);\n    replaceHistoryState(stateVikeEnhanced);\n}\nfunction enhance(stateNotEnhanced) {\n    const timestamp = getTimestamp();\n    const scrollPosition = getScrollPosition();\n    const triggeredBy = 'browser';\n    let stateVikeEnhanced;\n    if (!stateNotEnhanced) {\n        stateVikeEnhanced = {\n            timestamp,\n            scrollPosition,\n            triggeredBy,\n            _isVikeEnhanced: true,\n        };\n    }\n    else {\n        // State information may be incomplete if `window.history.state` is set by an old Vike version. (E.g. `state.timestamp` was introduced for `pageContext.isBackwardNavigation` in `0.4.19`.)\n        cast(stateNotEnhanced);\n        stateVikeEnhanced = {\n            timestamp: stateNotEnhanced.timestamp ?? timestamp,\n            scrollPosition: stateNotEnhanced.scrollPosition ?? scrollPosition,\n            triggeredBy: stateNotEnhanced.triggeredBy ?? triggeredBy,\n            _isVikeEnhanced: true,\n        };\n    }\n    assertIsVikeEnhanced(stateVikeEnhanced);\n    return stateVikeEnhanced;\n}\nfunction getState() {\n    const state = window.history.state;\n    // *Every* state added to the history needs to go through Vike.\n    // - Otherwise Vike's `popstate` listener won't work. (Because, for example, if globalObject.previous is outdated => isHashNavigation faulty => client-side navigation is wrongfully skipped.)\n    // - Therefore, we have to monkey patch history.pushState() and history.replaceState()\n    // - Therefore, we need the assert() below to ensure history.state has been enhanced by Vike\n    //   - If users stumble upon this assert() then let's make it a assertUsage()\n    assertIsVikeEnhanced(state);\n    return state;\n}\nfunction getScrollPosition() {\n    const scrollPosition = { x: window.scrollX, y: window.scrollY };\n    return scrollPosition;\n}\nfunction getTimestamp() {\n    return new Date().getTime();\n}\nfunction saveScrollPosition() {\n    const scrollPosition = getScrollPosition();\n    const state = getState();\n    replaceHistoryState({ ...state, scrollPosition });\n}\nfunction pushHistoryState(url, overwriteLastHistoryEntry) {\n    if (!overwriteLastHistoryEntry) {\n        const state = {\n            timestamp: getTimestamp(),\n            // I don't remember why I set it to `null`, maybe because setting it now would be too early? (Maybe there is a delay between renderPageClientSide() is finished and the browser updating the scroll position.) Anyways, it seems like autoSaveScrollPosition() is enough.\n            scrollPosition: null,\n            triggeredBy: 'vike',\n            _isVikeEnhanced: true,\n        };\n        // Calling the monkey patched history.pushState() (and not the original) so that other tools (e.g. user tracking) can listen to Vike's pushState() calls.\n        // - https://github.com/vikejs/vike/issues/1582\n        window.history.pushState(state, '', url);\n    }\n    else {\n        replaceHistoryState(getState(), url);\n    }\n}\nfunction replaceHistoryState(state, url) {\n    const url_ = url ?? null; // Passing `undefined` chokes older Edge versions.\n    window.history.replaceState(state, '', url_);\n    assertIsVikeEnhanced(window.history.state);\n}\nfunction replaceHistoryStateOriginal(state, url) {\n    // Bypass all monkey patches.\n    // - Useful, for example, to avoid other tools listening to history.replaceState() calls\n    History.prototype.replaceState.bind(window.history)(state, '', url);\n}\n// Monkey patch:\n// - history.pushState()\n// - history.replaceState()\nfunction monkeyPatchHistoryAPI() {\n    if (globalObject.monkeyPatched)\n        return;\n    globalObject.monkeyPatched = true;\n    ['pushState', 'replaceState'].forEach((funcName) => {\n        const funcOriginal = window.history[funcName].bind(window.history);\n        window.history[funcName] = (stateOriginal = {}, ...rest) => {\n            assertUsage(stateOriginal === undefined || stateOriginal === null || isObject(stateOriginal), `history.${funcName}(state) argument state must be an object`);\n            const stateEnhanced = isVikeEnhanced(stateOriginal)\n                ? stateOriginal\n                : {\n                    _isVikeEnhanced: true,\n                    scrollPosition: getScrollPosition(),\n                    timestamp: getTimestamp(),\n                    triggeredBy: 'user',\n                    ...stateOriginal,\n                };\n            assertIsVikeEnhanced(stateEnhanced);\n            funcOriginal(stateEnhanced, ...rest);\n            assert(deepEqual(stateEnhanced, window.history.state));\n            globalObject.previous = getHistoryInfo();\n            // Workaround https://github.com/vikejs/vike/issues/2504#issuecomment-3149764736\n            queueMicrotask(() => {\n                if (deepEqual(stateEnhanced, window.history.state))\n                    return;\n                Object.assign(stateEnhanced, window.history.state);\n                assertIsVikeEnhanced(stateEnhanced);\n                replaceHistoryStateOriginal(stateEnhanced, rest[1]);\n                assert(deepEqual(stateEnhanced, window.history.state));\n            });\n        };\n    });\n}\nfunction isVikeEnhanced(state) {\n    if (isObject(state) && '_isVikeEnhanced' in state) {\n        /* We don't use the assert() below to save client-side KBs.\n        assert(hasProp(state, '_isVikeEnhanced', 'true'))\n        assert(hasProp(state, 'timestamp', 'number'))\n        assert(hasProp(state, 'scrollPosition'))\n        if (state.scrollPosition !== null) {\n          assert(hasProp(state, 'scrollPosition', 'object'))\n          assert(hasProp(state.scrollPosition, 'x', 'number') && hasProp(state.scrollPosition, 'y', 'number'))\n        }\n        //*/\n        return true;\n    }\n    return false;\n}\nfunction assertIsVikeEnhanced(state) {\n    if (isVikeEnhanced(state))\n        return;\n    assert(false, { state });\n}\nfunction getHistoryInfo() {\n    return {\n        url: getCurrentUrl(),\n        state: getState(),\n    };\n}\nfunction onPopStateBegin() {\n    const { previous } = globalObject;\n    const isHistoryStateEnhanced = window.history.state !== null;\n    if (!isHistoryStateEnhanced)\n        enhanceHistoryState();\n    assertIsVikeEnhanced(window.history.state);\n    const current = getHistoryInfo();\n    globalObject.previous = current;\n    return { isHistoryStateEnhanced, previous, current };\n}\nfunction initHistory() {\n    monkeyPatchHistoryAPI(); // the earlier we call it the better (Vike can workaround erroneous library monkey patches if Vike is the last one in the monkey patch chain)\n    enhanceHistoryState(); // enhance very first window.history.state which is `null`\n}\n","export { setScrollPosition };\nexport { autoSaveScrollPosition };\nexport { scrollToHashOrTop };\nimport { assert, onPageHide, sleep, throttle } from './utils.js';\nimport { replaceHistoryStateOriginal, saveScrollPosition } from './history.js';\nfunction setScrollPosition(scrollTarget, url) {\n    if (!scrollTarget && url && hasTextFragment(url)) {\n        scrollToTextFragment(url);\n        return;\n    }\n    if (scrollTarget && 'x' in scrollTarget) {\n        setScroll(scrollTarget);\n        return;\n    }\n    if (scrollTarget?.preserveScroll) {\n        return;\n    }\n    const hash = getUrlHash();\n    scrollToHashOrTop(hash);\n}\n// https://github.com/vikejs/vike/issues/2114\n// https://github.com/WICG/scroll-to-text-fragment/issues/261\nfunction scrollToTextFragment(url) {\n    const stateOriginal = window.history.state;\n    replaceHistoryStateOriginal(null, url);\n    // We need `history.state===null` before location.replace() so that our 'popstate' handling is correct\n    assert(window.history.state === null);\n    // - Chrome's location.replace() keeps the current state (`history.state===stateOriginal`)\n    // - Firefox's location.replace() replaces the current state with `null` (`history.state===null`)\n    window.location.replace(url);\n    replaceHistoryStateOriginal(stateOriginal, url);\n}\nfunction hasTextFragment(url) {\n    return url.includes('#') && url.includes(':~:text');\n}\n// Replicates the browser's native behavior\nfunction scrollToHashOrTop(hash) {\n    if (!hash) {\n        scrollToTop();\n    }\n    else {\n        const id = decodeURIComponent(hash);\n        const hashTarget = document.getElementById(id) || document.getElementsByName(id)[0];\n        if (hashTarget) {\n            hashTarget.scrollIntoView();\n            // Is this standard? We just copied SvelteKit: https://github.com/sveltejs/kit/blob/94c45b9372a9ed2b80e21cdca3f235c45edaa5b0/packages/kit/src/runtime/client/client.js#L2132\n            hashTarget.focus();\n        }\n        else if (hash === 'top') {\n            scrollToTop();\n        }\n    }\n}\nfunction scrollToTop() {\n    setScroll({ x: 0, y: 0 });\n}\n/**\n * Change the browser's scroll position, in a way that works during a repaint.\n *\n * I don't remember exactly why I implemented this and what I meant with \"repaint\"\n * - https://github.com/vikejs/vike/commit/fd70fadb0bcea8d922f961f1c88713994e0aaf34\n * - I guess scrolling doesn't work during a page rendering? So we have to re-scroll until the scroll position is correct?\n * - Do other frameworks implement this? SvelteKit doesn't seem to.\n * - Let's remove it and see if users complain?\n */\nfunction setScroll(scrollPosition) {\n    const scroll = () => {\n        // `window.scrollTo()` respects the CSS `scroll-behavior: smooth` property\n        window.scrollTo(scrollPosition.x, scrollPosition.y);\n    };\n    const done = () => {\n        return window.scrollX === scrollPosition.x && window.scrollY === scrollPosition.y;\n    };\n    // In principle, this `done()` call should force the repaint to be finished, but that doesn't seem to be the case with `Firefox 97.0.1`.\n    if (done())\n        return;\n    scroll();\n    // Because `done()` doesn't seem to always force the repaint to be finished, we potentially need to retry again.\n    if (done())\n        return;\n    requestAnimationFrame(() => {\n        scroll();\n        if (done())\n            return;\n        setTimeout(async () => {\n            scroll();\n            if (done())\n                return;\n            // In principle, `requestAnimationFrame() -> setTimeout(, 0)` should be enough.\n            //  - https://stackoverflow.com/questions/61281139/waiting-for-repaint-in-javascript\n            //  - But it's not enough for `Firefox 97.0.1`.\n            //  - The following strategy is very aggressive. It doesn't need to be that aggressive for Firefox. But we do it to be safe.\n            const start = new Date().getTime();\n            while (true) {\n                await sleep(10);\n                scroll();\n                if (done())\n                    return;\n                const millisecondsElapsed = new Date().getTime() - start;\n                if (millisecondsElapsed > 100)\n                    return;\n            }\n        }, 0);\n    });\n}\nfunction getUrlHash() {\n    let { hash } = window.location;\n    if (hash === '')\n        return null;\n    assert(hash.startsWith('#'));\n    hash = hash.slice(1);\n    return hash;\n}\n// Save scroll position (needed for back-/forward navigation)\nfunction autoSaveScrollPosition() {\n    // Safari cannot handle more than 100 `history.replaceState()` calls within 30 seconds (https://github.com/vikejs/vike/issues/46)\n    window.addEventListener('scroll', throttle(saveScrollPosition, Math.ceil(1000 / 3)), { passive: true });\n    onPageHide(saveScrollPosition);\n}\n","export { scrollRestoration_init };\nexport { scrollRestoration_initialRenderIsDone };\n// Using `window.history.scrollRestoration` to recover scroll position when user reloads the page or Cmd-Shift-T back to it.\n// We let the browser do it because it's fast.\n// - Alternatively we could inject an inline script `<script>scrollTo(history.state.scrollPosition)</script>` early, which seems to be equally fast. (See for example https://vike.dev/usePageContext which sets the main scroll position and the navigation scroll position equally fast.)\n// - Firefox doesn't restore the scroll position upon page reload but does upon Cmd-Shift-T\n// See also: https://github.com/cyco130/knave/blob/e9e1bc7687848504293197f1b314b7d12ad0d228/design.md#scroll-restoration\nimport { getGlobalObject, onPageHide, onPageShow } from './utils.js';\nconst globalObject = getGlobalObject('runtime-client-routing/scrollRestoration.ts', {});\nfunction scrollRestoration_init() {\n    // Use the native scroll restoration mechanism only for the first render\n    scrollRestoration_enable();\n    onPageHide(scrollRestoration_enable);\n    onPageShow(() => globalObject.initialRenderIsDone && scrollRestoration_disable());\n}\nfunction scrollRestoration_initialRenderIsDone() {\n    globalObject.initialRenderIsDone = true;\n    scrollRestoration_disable();\n}\nfunction scrollRestoration_disable() {\n    if ('scrollRestoration' in window.history) {\n        window.history.scrollRestoration = 'manual';\n    }\n}\nfunction scrollRestoration_enable() {\n    if ('scrollRestoration' in window.history) {\n        // Use the browser's native scroll restoration mechanism\n        window.history.scrollRestoration = 'auto';\n    }\n}\n","export { logErrorClient };\nimport { isObject } from './utils.js';\nfunction logErrorClient(err) {\n    if (isObject(err) &&\n        // Set by vike-react\n        // https://github.com/vikejs/vike-react/blob/195a208c6b77e7f34496e1f637278a36c60fbe07/packages/vike-react/src/integration/onRenderClient.tsx#L109\n        err.isAlreadyLogged) {\n        return;\n    }\n    console.error(err);\n}\n","export { renderPageClientSide };\nexport { getRenderCount };\nexport { disableClientRouting };\nexport { firstRenderStartPromise };\nexport { getPageContextClient };\nimport { assert, objectAssign, redirectHard, getGlobalObject, hasProp, updateType, genPromise, isCallable, catchInfiniteLoop, } from './utils.js';\nimport { getPageContextFromClientHooks, getPageContextFromServerHooks, getPageContextFromHooks_isHydration, getPageContextFromHooks_serialized, setPageContextInitIsPassedToClient, } from './getPageContextFromHooks.js';\nimport { createPageContextClientSide } from './createPageContextClientSide.js';\nimport { addLinkPrefetchHandlers, addLinkPrefetchHandlers_unwatch, addLinkPrefetchHandlers_watch, getPageContextPrefetched, populatePageContextPrefetchCache, } from './prefetch.js';\nimport { assertInfo, assertWarning, isReact } from './utils.js';\nimport { execHookOnRenderClient } from '../shared/execHookOnRenderClient.js';\nimport { isErrorFetchingStaticAssets, loadPageConfigsLazyClientSide, } from '../shared/loadPageConfigsLazyClientSide.js';\nimport { pushHistoryState } from './history.js';\nimport { assertNoInfiniteAbortLoop, getPageContextFromAllRewrites, isAbortError, logAbortErrorHandled, } from '../../shared/route/abort.js';\nimport { route } from '../../shared/route/index.js';\nimport { isClientSideRoutable } from './isClientSideRoutable.js';\nimport { setScrollPosition } from './setScrollPosition.js';\nimport { scrollRestoration_initialRenderIsDone } from './scrollRestoration.js';\nimport { getErrorPageId, isErrorPage } from '../../shared/error-page.js';\nimport { setPageContextCurrent } from './getPageContextCurrent.js';\nimport { getRouteStringParameterList } from '../../shared/route/resolveRouteString.js';\nimport { getCurrentUrl } from '../shared/getCurrentUrl.js';\nimport { execHookDirect, execHook } from '../../shared/hooks/execHook.js';\nimport { preparePageContextForPublicUsageClient, } from './preparePageContextForPublicUsageClient.js';\nimport { getHookFromPageContextNew } from '../../shared/hooks/getHook.js';\nimport { preparePageContextForPublicUsageClientMinimal } from '../shared/preparePageContextForPublicUsageClientShared.js';\nimport { logErrorClient } from './logErrorClient.js';\nconst globalObject = getGlobalObject('runtime-client-routing/renderPageClientSide.ts', (() => {\n    const { promise: firstRenderStartPromise, resolve: firstRenderStartPromiseResolve } = genPromise();\n    return {\n        renderCounter: 0,\n        firstRenderStartPromise,\n        firstRenderStartPromiseResolve,\n    };\n})());\nconst { firstRenderStartPromise } = globalObject;\nasync function renderPageClientSide(renderArgs) {\n    catchInfiniteLoop('renderPageClientSide()');\n    const { urlOriginal = getCurrentUrl(), overwriteLastHistoryEntry = false, isBackwardNavigation, pageContextsFromRewrite = [], redirectCount = 0, doNotRenderIfSamePage, isClientSideNavigation = true, pageContextInitClient, } = renderArgs;\n    let { scrollTarget } = renderArgs;\n    const { previousPageContext } = globalObject;\n    addLinkPrefetchHandlers_unwatch();\n    const { isRenderOutdated, setHydrationCanBeAborted, isFirstRender } = getIsRenderOutdated();\n    assertNoInfiniteAbortLoop(pageContextsFromRewrite.length, redirectCount);\n    const pageContextBeginArgs = {\n        urlOriginal,\n        isBackwardNavigation,\n        pageContextsFromRewrite,\n        isClientSideNavigation,\n        pageContextInitClient,\n        isFirstRender,\n    };\n    if (globalObject.clientRoutingIsDisabled) {\n        redirectHard(urlOriginal);\n        return;\n    }\n    globalObject.firstRenderStartPromiseResolve();\n    if (isRenderOutdated())\n        return;\n    return await renderPageNominal();\n    async function renderPageNominal() {\n        const onError = async (err) => {\n            await handleError({ err });\n        };\n        const pageContext = await getPageContextBegin(false, pageContextBeginArgs);\n        if (isRenderOutdated())\n            return;\n        // onPageTransitionStart()\n        if (globalObject.isFirstRenderDone) {\n            assert(previousPageContext);\n            // We use the hook of the previous page in order to be able to call onPageTransitionStart() before fetching the files of the next page.\n            // https://github.com/vikejs/vike/issues/1560\n            if (!globalObject.isTransitioning) {\n                globalObject.isTransitioning = true;\n                const hooks = getHookFromPageContextNew('onPageTransitionStart', previousPageContext);\n                try {\n                    await execHookDirect(hooks, pageContext, preparePageContextForPublicUsageClientMinimal);\n                }\n                catch (err) {\n                    await onError(err);\n                    return;\n                }\n                if (isRenderOutdated())\n                    return;\n            }\n        }\n        // Get pageContext serialized in <script id=\"vike_pageContext\" type=\"application/json\">\n        if (isFirstRender) {\n            const pageContextSerialized = getPageContextFromHooks_serialized();\n            // TO-DO/eventually: create helper assertPageContextFromHook()\n            assert(!('urlOriginal' in pageContextSerialized));\n            objectAssign(pageContext, pageContextSerialized);\n            // TO-DO/pageContext-prefetch: remove or change, because this only makes sense for a pre-rendered page\n            populatePageContextPrefetchCache(pageContext, { pageContextFromServerHooks: pageContextSerialized });\n        }\n        // Route\n        // - We must also run it upon hydration to call the onBeforeRoute() hook, which is needed for i18n URL locale extraction.\n        {\n            let pageContextFromRoute;\n            try {\n                pageContextFromRoute = await route(pageContext);\n            }\n            catch (err) {\n                await onError(err);\n                return;\n            }\n            if (isRenderOutdated())\n                return;\n            // TO-DO/eventually: create helper assertPageContextFromHook()\n            assert(!('urlOriginal' in pageContextFromRoute));\n            if (isFirstRender) {\n                // Set pageContext properties set by onBeforeRoute()\n                // - But we skip pageId and routeParams because routing may have been aborted by a server-side `throw render()`\n                const { pageId, routeParams, ...rest } = pageContextFromRoute;\n                objectAssign(pageContext, rest);\n                assert(hasProp(pageContext, 'routeParams', 'string{}')); // Help TS\n            }\n            else {\n                objectAssign(pageContext, pageContextFromRoute);\n            }\n            if (!isFirstRender) {\n                if (!pageContextFromRoute.pageId) {\n                    /*\n                    // We don't use the client router to render the 404 page:\n                    //  - So that the +redirects setting (https://vike.dev/redirects) can be applied.\n                    //    - This is the main argument.\n                    //    - See also failed CI: https://github.com/vikejs/vike/pull/1871\n                    //  - So that server-side error tracking can track 404 links?\n                    //    - We do use the client router for rendering the error page, so I don't think this is much of an argument.\n                    await renderErrorPage({ is404: true })\n                    */\n                    redirectHard(urlOriginal);\n                    return;\n                }\n                const isClientRoutable = await isClientSideRoutable(pageContextFromRoute.pageId, pageContext);\n                if (isRenderOutdated())\n                    return;\n                if (!isClientRoutable) {\n                    redirectHard(urlOriginal);\n                    return;\n                }\n                const isSamePage = pageContextFromRoute.pageId &&\n                    previousPageContext?.pageId &&\n                    pageContextFromRoute.pageId === previousPageContext.pageId;\n                if (doNotRenderIfSamePage && isSamePage) {\n                    // Skip's Vike's rendering; let the user handle the navigation\n                    return;\n                }\n            }\n        }\n        assert(hasProp(pageContext, 'pageId', 'string')); // Help TS\n        const res = await loadPageConfigsLazyClientSideAndExecHook(pageContext, isFirstRender, isRenderOutdated);\n        /* Already called inside loadPageConfigsLazyClientSideAndExecHook()\n        if (isRenderOutdated()) return\n        */\n        if (res.skip)\n            return;\n        if ('err' in res) {\n            await onError(res.err);\n            return;\n        }\n        updateType(pageContext, res.pageContext);\n        setPageContextCurrent(pageContext);\n        // Set global hydrationCanBeAborted\n        if (pageContext.exports.hydrationCanBeAborted) {\n            setHydrationCanBeAborted();\n        }\n        else {\n            assertWarning(!isReact(), 'You seem to be using React; we recommend setting hydrationCanBeAborted to true, see https://vike.dev/hydrationCanBeAborted', { onlyOnce: true });\n        }\n        // There wasn't any `await` but the isRenderOutdated() return value may have changed because we called setHydrationCanBeAborted()\n        if (isRenderOutdated())\n            return;\n        // Get pageContext from hooks (fetched from server, and/or directly called on the client-side)\n        if (isFirstRender) {\n            assert(hasProp(pageContext, '_hasPageContextFromServer', 'true'));\n            let pageContextAugmented;\n            try {\n                pageContextAugmented = await getPageContextFromHooks_isHydration(pageContext);\n            }\n            catch (err) {\n                await onError(err);\n                return;\n            }\n            if (isRenderOutdated())\n                return;\n            updateType(pageContext, pageContextAugmented);\n            // Render page view\n            return await renderPageView(pageContext);\n        }\n        else {\n            // Fetch pageContext from server-side hooks\n            let pageContextFromServerHooks;\n            const pageContextPrefetched = getPageContextPrefetched(pageContext);\n            if (pageContextPrefetched) {\n                pageContextFromServerHooks = pageContextPrefetched;\n            }\n            else {\n                try {\n                    const result = await getPageContextFromServerHooks(pageContext, false);\n                    if (result.is404ServerSideRouted)\n                        return;\n                    pageContextFromServerHooks = result.pageContextFromServerHooks;\n                    // TO-DO/pageContext-prefetch: remove or change, because this only makes sense for a pre-rendered page\n                    populatePageContextPrefetchCache(pageContext, result);\n                }\n                catch (err) {\n                    await onError(err);\n                    return;\n                }\n            }\n            if (isRenderOutdated())\n                return;\n            // TO-DO/eventually: create helper assertPageContextFromHook()\n            assert(!('urlOriginal' in pageContextFromServerHooks));\n            objectAssign(pageContext, pageContextFromServerHooks);\n            // Get pageContext from client-side hooks\n            let pageContextFromClientHooks;\n            try {\n                pageContextFromClientHooks = await getPageContextFromClientHooks(pageContext, false);\n            }\n            catch (err) {\n                await onError(err);\n                return;\n            }\n            if (isRenderOutdated())\n                return;\n            updateType(pageContext, pageContextFromClientHooks);\n            return await renderPageView(pageContext);\n        }\n    }\n    // When the normal page threw an error:\n    // - Can be a URL rewrite upon `throw render('/some-url')`\n    // - Can be rendering the error page\n    // - Can be rendering Vike's generic error page (if no error page is defined, or if the error page throws an error)\n    async function handleError(args) {\n        const { err } = args;\n        assert(err);\n        // Logging\n        if (!isAbortError(err)) {\n            // We don't swallow 404 errors:\n            //  - On the server-side, Vike swallows / doesn't show any 404 error log because it's expected that a user may go to some random non-existent URL. (We don't want to flood the app's error tracking with 404 logs.)\n            //  - On the client-side, if the user navigates to a 404 then it means that the UI has a broken link. (It isn't expected that users can go to some random URL using the client-side router, as it would require, for example, the user to manually change the URL of a link by manually manipulating the DOM which highly unlikely.)\n            logErrorClient(err);\n        }\n        else {\n            // We swallow throw redirect()/render() called by client-side hooks onBeforeRender()/data()/guard()\n            // We handle the abort error down below.\n        }\n        // pageContext\n        const pageContext = await getPageContextBegin(true, pageContextBeginArgs);\n        if (isRenderOutdated())\n            return;\n        objectAssign(pageContext, {\n            errorWhileRendering: err,\n        });\n        // throw redirect()/render()\n        let pageContextAbort;\n        if (isAbortError(err)) {\n            const res = await handleAbortError(err, pageContext);\n            if (res.skip)\n                return;\n            pageContextAbort = res.pageContextAbort;\n        }\n        // Render error page\n        await renderErrorPage(pageContext, args, pageContextAbort);\n    }\n    async function renderErrorPage(pageContext, args, pageContextAbort) {\n        const onError = (err) => {\n            /* When we can't render the error page, we prefer showing a blank page over letting the server-side try because otherwise:\n               - We risk running into an infinite loop of reloads which would overload the server.\n               - An infinite reloading page is a even worse UX than a blank page.\n            redirectHard(urlOriginal)\n            */\n            logErrorClient(err);\n        };\n        const errorPageId = getErrorPageId(pageContext._pageFilesAll, pageContext._globalContext._pageConfigs);\n        if (!errorPageId)\n            throw new Error('No error page defined.');\n        objectAssign(pageContext, {\n            pageId: errorPageId,\n            routeParams: {},\n        });\n        // throw render(statusCode)\n        if (pageContextAbort) {\n            assert(pageContextAbort.abortStatusCode);\n            assert(!('urlOriginal' in pageContextAbort));\n            objectAssign(pageContext, pageContextAbort);\n            objectAssign(pageContext, { is404: pageContextAbort.abortStatusCode === 404 });\n        }\n        else {\n            objectAssign(pageContext, { is404: false });\n        }\n        const isClientRoutable = await isClientSideRoutable(pageContext.pageId, pageContext);\n        if (isRenderOutdated())\n            return;\n        if (!isClientRoutable) {\n            redirectHard(urlOriginal);\n            return;\n        }\n        if (import.meta.env.DEV || globalThis.__VIKE__IS_DEBUG) {\n            assertInfo(false, `Rendering error page ${errorPageId}`, { onlyOnce: false });\n        }\n        const res = await loadPageConfigsLazyClientSideAndExecHook(pageContext, isFirstRender, isRenderOutdated);\n        /* Already called inside loadPageConfigsLazyClientSideAndExecHook()\n        if (isRenderOutdated()) return\n        */\n        if (res.skip)\n            return;\n        if ('err' in res) {\n            onError(res.err);\n            return;\n        }\n        updateType(pageContext, res.pageContext);\n        setPageContextCurrent(pageContext);\n        let pageContextFromServerHooks;\n        try {\n            const result = await getPageContextFromServerHooks(pageContext, true);\n            if (result.is404ServerSideRouted)\n                return;\n            pageContextFromServerHooks = result.pageContextFromServerHooks;\n        }\n        catch (err) {\n            onError(err);\n            return;\n        }\n        if (isRenderOutdated())\n            return;\n        // TO-DO/eventually: create helper assertPageContextFromHook()\n        assert(!('urlOriginal' in pageContextFromServerHooks));\n        objectAssign(pageContext, pageContextFromServerHooks);\n        let pageContextFromClientHooks;\n        try {\n            pageContextFromClientHooks = await getPageContextFromClientHooks(pageContext, true);\n        }\n        catch (err) {\n            onError(err);\n            return;\n        }\n        if (isRenderOutdated())\n            return;\n        updateType(pageContext, pageContextFromClientHooks);\n        await renderPageView(pageContext, args);\n    }\n    async function handleAbortError(err, pageContext) {\n        const errAbort = err;\n        logAbortErrorHandled(err, !import.meta.env.DEV, pageContext);\n        const pageContextAbort = errAbort._pageContextAbort;\n        // throw render('/some-url')\n        if (pageContextAbort._urlRewrite) {\n            await renderPageClientSide({\n                ...renderArgs,\n                scrollTarget: undefined,\n                pageContextsFromRewrite: [...pageContextsFromRewrite, pageContextAbort],\n            });\n            return { skip: true };\n        }\n        // throw redirect('/some-url')\n        if (pageContextAbort._urlRedirect) {\n            const urlRedirect = pageContextAbort._urlRedirect.url;\n            if (!urlRedirect.startsWith('/')) {\n                // External redirection\n                redirectHard(urlRedirect);\n                return { skip: true };\n            }\n            else {\n                await renderPageClientSide({\n                    ...renderArgs,\n                    scrollTarget: undefined,\n                    urlOriginal: urlRedirect,\n                    overwriteLastHistoryEntry: false,\n                    isBackwardNavigation: false,\n                    redirectCount: redirectCount + 1,\n                });\n            }\n            return { skip: true };\n        }\n        // throw render(statusCode)\n        return { pageContextAbort };\n    }\n    async function renderPageView(pageContext, isErrorPage) {\n        const onError = async (err) => {\n            if (!isErrorPage) {\n                await handleError({ err });\n            }\n            else {\n                logErrorClient(err);\n            }\n        };\n        // We use globalObject.onRenderClientPreviousPromise in order to ensure that there is never two concurrent onRenderClient() calls\n        if (globalObject.onRenderClientPreviousPromise) {\n            // Make sure that the previous render has finished\n            await globalObject.onRenderClientPreviousPromise;\n            assert(globalObject.onRenderClientPreviousPromise === undefined);\n            if (isRenderOutdated())\n                return;\n        }\n        changeUrl(urlOriginal, overwriteLastHistoryEntry);\n        globalObject.previousPageContext = pageContext;\n        assert(globalObject.onRenderClientPreviousPromise === undefined);\n        const onRenderClientPromise = (async () => {\n            let onRenderClientError;\n            try {\n                await execHookOnRenderClient(pageContext, preparePageContextForPublicUsageClient);\n            }\n            catch (err) {\n                assert(err);\n                onRenderClientError = err;\n            }\n            globalObject.onRenderClientPreviousPromise = undefined;\n            globalObject.isFirstRenderDone = true;\n            return onRenderClientError;\n        })();\n        globalObject.onRenderClientPreviousPromise = onRenderClientPromise;\n        const onRenderClientError = await onRenderClientPromise;\n        assert(globalObject.onRenderClientPreviousPromise === undefined);\n        if (onRenderClientError) {\n            await onError(onRenderClientError);\n            if (!isErrorPage)\n                return;\n        }\n        /* We don't abort in order to ensure that onHydrationEnd() is called: we abort only after onHydrationEnd() is called.\n        if (isRenderOutdated(true)) return\n        */\n        // onHydrationEnd()\n        if (isFirstRender && !onRenderClientError) {\n            try {\n                await execHook('onHydrationEnd', pageContext, preparePageContextForPublicUsageClient);\n            }\n            catch (err) {\n                await onError(err);\n                if (!isErrorPage)\n                    return;\n            }\n            if (isRenderOutdated(true))\n                return;\n        }\n        // We purposely abort *after* onHydrationEnd() is called (see comment above).\n        if (isRenderOutdated(true))\n            return;\n        // onPageTransitionEnd()\n        if (globalObject.isTransitioning) {\n            globalObject.isTransitioning = undefined;\n            assert(previousPageContext);\n            const hooks = getHookFromPageContextNew('onPageTransitionEnd', previousPageContext);\n            try {\n                await execHookDirect(hooks, pageContext, preparePageContextForPublicUsageClient);\n            }\n            catch (err) {\n                await onError(err);\n                if (!isErrorPage)\n                    return;\n            }\n            if (isRenderOutdated(true))\n                return;\n        }\n        if (!scrollTarget && previousPageContext) {\n            const keepScrollPositionPrev = getKeepScrollPositionSetting(previousPageContext);\n            const keepScrollPositionNext = getKeepScrollPositionSetting(pageContext);\n            if (keepScrollPositionNext !== false &&\n                keepScrollPositionPrev !== false &&\n                areKeysEqual(keepScrollPositionNext, keepScrollPositionPrev)) {\n                scrollTarget = { preserveScroll: true };\n            }\n        }\n        // Page scrolling\n        setScrollPosition(scrollTarget, urlOriginal);\n        scrollRestoration_initialRenderIsDone();\n        if (pageContext._hasPageContextFromServer)\n            setPageContextInitIsPassedToClient(pageContext);\n        // Add link prefetch handlers\n        addLinkPrefetchHandlers_watch();\n        addLinkPrefetchHandlers();\n        globalObject.renderedPageContext = pageContext;\n        stampFinished(urlOriginal);\n        return pageContext;\n    }\n}\nasync function getPageContextBegin(isForErrorPage, { urlOriginal, isBackwardNavigation, pageContextsFromRewrite, isClientSideNavigation, pageContextInitClient, isFirstRender, }) {\n    const previousPageContext = globalObject.previousPageContext ?? null;\n    const pageContext = await createPageContextClientSide(urlOriginal);\n    objectAssign(pageContext, {\n        isBackwardNavigation,\n        isClientSideNavigation,\n        isHydration: isFirstRender && !isForErrorPage,\n        previousPageContext,\n        ...pageContextInitClient,\n    });\n    // TO-DO/next-major-release: remove\n    Object.defineProperty(pageContext, '_previousPageContext', {\n        get() {\n            assertWarning(false, 'pageContext._previousPageContext has been renamed pageContext.previousPageContext', {\n                showStackTrace: true,\n                onlyOnce: true,\n            });\n            return previousPageContext;\n        },\n        enumerable: false,\n    });\n    {\n        const pageContextFromAllRewrites = getPageContextFromAllRewrites(pageContextsFromRewrite);\n        assert(!('urlOriginal' in pageContextFromAllRewrites));\n        objectAssign(pageContext, pageContextFromAllRewrites);\n    }\n    return pageContext;\n}\n// For Vike tests (but also potentially for Vike users)\n// https://github.com/vikejs/vike/blob/ffbc5cf16407bcc075f414447e50d997c87c0c94/test/playground/pages/nested-layout/e2e-test.ts#L59\nfunction stampFinished(urlOriginal) {\n    window._vike ?? (window._vike = {});\n    window._vike.fullyRenderedUrl = urlOriginal;\n}\nfunction changeUrl(url, overwriteLastHistoryEntry) {\n    if (getCurrentUrl() === url)\n        return;\n    pushHistoryState(url, overwriteLastHistoryEntry);\n}\nfunction disableClientRouting(err, log) {\n    globalObject.clientRoutingIsDisabled = true;\n    assert(isErrorFetchingStaticAssets(err));\n    if (log) {\n        // We purposely don't use console.error() to avoid flooding error trackers such as Sentry\n        console.log(err);\n    }\n    assertInfo(false, [\n        'Failed to fetch static asset.',\n        import.meta.env.PROD ? 'This usually happens when a new frontend is deployed.' : null,\n        'Falling back to Server Routing.',\n        '(The next page navigation will use Server Routing instead of Client Routing.)',\n    ]\n        .filter(Boolean)\n        .join(' '), { onlyOnce: true });\n}\nfunction getIsRenderOutdated() {\n    const renderNumber = ++globalObject.renderCounter;\n    assert(renderNumber >= 1);\n    let hydrationCanBeAborted = false;\n    const setHydrationCanBeAborted = () => {\n        hydrationCanBeAborted = true;\n    };\n    /** Whether the rendering should be aborted because a new rendering has started. We should call this after each `await`. */\n    const isRenderOutdated = (isRenderCleanup) => {\n        // Never abort first render if `hydrationCanBeAborted` isn't `true`\n        {\n            const isFirstRender = renderNumber === 1;\n            if (isFirstRender && !hydrationCanBeAborted && !isRenderCleanup) {\n                return false;\n            }\n        }\n        // If there is a newer rendering, we should abort all previous renderings\n        return renderNumber !== globalObject.renderCounter;\n    };\n    return {\n        isRenderOutdated,\n        setHydrationCanBeAborted,\n        isFirstRender: renderNumber === 1,\n    };\n}\nfunction getRenderCount() {\n    return globalObject.renderCounter;\n}\nfunction getKeepScrollPositionSetting(pageContext) {\n    const c = pageContext.from.configsStandard.keepScrollPosition;\n    if (!c)\n        return false;\n    let val = c.value;\n    const configDefinedAt = c.definedAt;\n    assert(configDefinedAt);\n    const routeParameterList = getRouteStringParameterList(configDefinedAt);\n    if (isCallable(val))\n        val = val(pageContext, {\n            configDefinedAt: c.definedAt,\n            /* We don't pass routeParameterList because it's useless: the user knows the parameter list.\n            routeParameterList\n            */\n        });\n    if (val === true) {\n        return [\n            configDefinedAt,\n            ...routeParameterList.map((param) => {\n                const val = pageContext.routeParams[param];\n                assert(val);\n                return val;\n            }),\n        ];\n    }\n    // We skip validation and type-cast instead of assertUsage() in order to save client-side KBs\n    return val;\n}\nfunction areKeysEqual(key1, key2) {\n    if (key1 === key2)\n        return true;\n    if (!Array.isArray(key1) || !Array.isArray(key2))\n        return false;\n    return key1.length === key2.length && key1.every((_, i) => key1[i] === key2[i]);\n}\n/**\n * Get the `pageContext` object on the client-side.\n *\n * https://vike.dev/getPageContextClient\n */\nfunction getPageContextClient() {\n    return globalObject.renderedPageContext ?? null;\n}\nasync function loadPageConfigsLazyClientSideAndExecHook(pageContext, isFirstRender, isRenderOutdated) {\n    let hasErr = false;\n    let err;\n    let pageContextAddendum;\n    try {\n        pageContextAddendum = await loadPageConfigsLazyClientSide(pageContext.pageId, pageContext._pageFilesAll, pageContext._globalContext._pageConfigs, pageContext._globalContext._pageConfigGlobal);\n    }\n    catch (err_) {\n        err = err_;\n        hasErr = true;\n        if (handleErrorFetchingStaticAssets(err, pageContext, isFirstRender)) {\n            return { skip: true };\n        }\n        else {\n            // Syntax error in user file\n        }\n    }\n    if (isRenderOutdated())\n        return { skip: true };\n    if (hasErr)\n        return { err };\n    objectAssign(pageContext, pageContextAddendum);\n    try {\n        await execHook('onCreatePageContext', pageContext, preparePageContextForPublicUsageClient);\n    }\n    catch (err_) {\n        err = err;\n        hasErr = true;\n    }\n    if (isRenderOutdated())\n        return { skip: true };\n    if (hasErr)\n        return { err };\n    return { pageContext };\n}\nfunction handleErrorFetchingStaticAssets(err, pageContext, isFirstRender) {\n    if (!isErrorFetchingStaticAssets(err)) {\n        return false;\n    }\n    if (isFirstRender) {\n        disableClientRouting(err, false);\n        // This may happen if the frontend was newly deployed during hydration.\n        // Ideally: re-try a couple of times by reloading the page (not entirely trivial to implement since `localStorage` is needed.)\n        throw err;\n    }\n    else {\n        disableClientRouting(err, true);\n    }\n    redirectHard(pageContext.urlOriginal);\n    return true;\n}\n// [HMR] If error page is shown => re-render whole page\nif (import.meta.env.DEV && import.meta.hot)\n    import.meta.hot.on('vite:afterUpdate', () => {\n        const pageContext = globalObject.renderedPageContext;\n        if (pageContext?.pageId && isErrorPage(pageContext.pageId, pageContext._globalContext._pageConfigs)) {\n            renderPageClientSide({\n                scrollTarget: { preserveScroll: false },\n                urlOriginal: getCurrentUrl(),\n                overwriteLastHistoryEntry: true,\n                isBackwardNavigation: false,\n            });\n        }\n    });\n"],"names":["slice","thing","from","to","sliceArray","list","listSlice","start","assert","end","el","parseUrl","url","baseServer","isUrl","hashOriginal","urlWithoutHash","extractHash","hash","decodeSafe","searchOriginal","urlWithoutHashNorSearch","extractSearch","searchString","baseURI","getBaseURI","search","searchAll","key","val","protocol","origin","pathnameAbsoluteWithBase","getPathnameAbsoluteWithBase","pathnameOriginal","pathname","isBaseMissing","removeBaseServer","href","createUrlFromComponents","host","hostname","port","parseHost","decodePathname","withoutHash","parts","withoutSearch","urlComponent","urlPathname","dir","parseOrigin","base","resolveUrlPathnameRelative","isUrlWithWebProtocol","uriWithoutProtocol","parseProtocol","rest","ret","uri","before","after","SEP2","isWebUrlProtocol","pathnameRelative","stack","baseRestoreTrailingSlash","i","p","pathnameAbsolute","isBaseServer","baseServerNormalized","isUrlAbsolute","isUrlRelative","isUrlPathAbsolute","c","isUrlExternal","assertUsageUrlAbsolute","errPrefix","assertUsage","getErrMsg","allowProtocol","allowUri","errMsg","pc","objectAssign","obj","objAddendum","objAddendumCanBeOriginalObject","objectReplace","objOld","objNew","except","higherFirst","getValue","element1","element2","val1","val2","lowerFirst","makeFirst","makeLast","element","isBrowser","isArrayOfStrings","isArray","v","isObjectOfStrings","isObject","hasProp","prop","type","propValue","isCallable","isPlainObject","value","compareString","str1","str2","isNullish","isNotNullish","stringifyStringArray","stringList","str","isPropertyGetter","descriptor","isPromise","getValuePrintable","escapeRegex","changeEnumerable","enumerable","objectDefineProperty","get","args","extJs","extTs","extJsOrTs","extJsx","extTsx","extJsxOrTsx","extTemplates","scriptFileExtensionList","isScriptFile","filePath","ext","isTemplateFile","getPropAccessNotation","isKeyDotNotationCompatible","timeoutSecondsDefault","genPromise","timeoutSeconds","resolve","reject","finished","promise_internal","resolve_","reject_","timeoutClear","timeouts","t","promise","target","err","assertWarning","removeStackErrorPrefix","errStack","errorPrefix","getExportPath","fileExportPathToShowToUser","configName","exportName","exportObjectPath","prefix","suffix","getConfigDefinedAt","sentenceBegin","definedAtData","begin","getDefinedAtString","getConfigDefinedAtOptional","files","definedAt","getDefinedByString","filePathToShowToUser","exportPath","definedBy","getConfigValueTyped","configValue","assertConfigValueType","typeActual","valuePrintable","problem","getConfigValueRuntime","pageConfig","addIs404ToPageProps","pageContext","addIs404","pageProps","NOT_SERIALIZABLE","getProxyForPublicUsage","objName","skipOnInternalProp","fallback","_","getProp","propStr","onNotSerializable","propName","prepareGlobalContextForPublicUsage","globalContext","preparePageContextForPublicUsage","sortPageContext","globalContextPublic","descriptors","key1","key2","assertPropertyGetters","normalizeClientSideUrl","options","urlCurrent","getCurrentUrl","state","getGlobalObject","assertClientRouting","assertNoContradiction","checkIfClientRouting","noContradiction","onLoad","isReact","isReact1","isReact2","isReact3","redirectHard","sleep","milliseconds","r","throttle","func","waitTime","isQueued","onPageHide","listener","onPageShow","trackers","catchInfiniteLoop","functionName","maxNumberOfCalls","withinSeconds","now","tracker","createTracker","msg","deepEqual","x","y","ok","tx","types","pattern","flags","serializer","parser","parse","parseTransform","reviver","res","match","deserialize","htmlElementId_pageContext","htmlElementId_globalContext","getPageContextSerializedInHtml","pageContextSerializedInHtml","findAndParseJson","getGlobalContextSerializedInHtml","id","elem","jsonStr","_key","getPageFilesClientSide","pageFilesAll","pageId","determine","getPageFilesServerSide","envIsClient","env","pageFilesRelevant","getPageFilesSorter","getPageIdFile","iso","pageIdFile","pageIdFileEnv","pageIdFileIso","getRendererFile","rendererFileEnv","rendererFileIso","defaultFilesNonRenderer","e1First","e2First","noOrder","e1","e2","e1_isRenderer","e2_isRenderer","e1_distance","getPathDistance","e2_distance","pathA","pathB","idx","pathAWithoutCommon","pathBWithoutCommon","distanceA","distanceB","analyzePageServerSide","pageFilesServerSideOnly","exportNames","BUILT_IN_CLIENT_ROUTER","BUILT_IN_CLIENT","removeBuiltInOverrides","urlToFile","fileExtension","doNotCreateExtraDirectory","hasTrailingSlash","pathnameModified","pageContextJsonFileExtension","getPageContextRequestUrl","assertPageContextProvidedByUser","pageContextProvidedByUser","hookName","hookFilePath","assertHookReturnedObject","keysExpected","keysUnknown","keys","assertOnBeforeRenderHookReturn","hookReturnValue","isObjectWithKeys","joinEnglish","arr","conjunction","colorizer","s","firsts","last","lastComma","DEBUG","getDEBUG","isDebug","assertFlagsActivated","flagsActivated","getFlagsActivated","flag","f","isAll","isGlobal","define_process_env_default","errIntro","execHookGuard","prepareForPublicUsage","hook","findPageGuard","getHookFromPageContext","execHookDirectSingle","pageRouteFile","fileExports","hookFn","hookTimeout","getHookTimeoutDefault","AbortRender","pageContextAbort","stamp","isAbortError","isAbortPageContext","getPageContextFromAllRewrites","pageContextsFromRewrite","assertNoInfiniteLoop","pageContextFromAllRewrites","pageContextFromRewrite","urlRewrites","urlRewrite","loop","assertNoInfiniteAbortLoop","rewriteCount","redirectCount","abortCalls","pageContextInitIsPassedToClient","isServerSideError","preparePageContextForPublicUsageClientShared","Page","supportVueReactiviy","preparePageContextForPublicUsageClientMinimal","resolveGetters","preparePageContextForPublicUsageClient","globalObject","getPageContextFromHooks_serialized","pageContextSerialized","processPageContextFromServer","getPageContextFromHooks_isHydration","hookClientOnlyExists","execHookDataLike","getPageContextFromServerHooks","isErrorPage","pageContextFromServerHooks","hasPageContextServer","fetchPageContextFromServer","pageContextFromServer","getPageContextFromClientHooks","dataHookExecuted","dataHookEnv","getHookEnv","execHookClient","execHook","pageContextFromHook","execHookData","execHookOnBeforeRender","hookReturn","pageContextFromOnBeforeRender","setPageContextInitIsPassedToClient","isOldDesign","hasOnBeforeRenderServerSideOnlyHook","hasServerOnlyHook","getPageConfig","hookEnv","pageContextUrl","response","contentType","contentTypeCorrect","isCorrect","responseText","getProjectError","createPageContextShared","pageContextCreated","globalConfigPublic","createPageContextObject","getPageContextUrlComputed","pageContextUrlComputed","urlPathnameGetter","urlGetter","urlParsedGetter","getUrlParsed","urlResolved","isBaseToBeRemoved","urlHandler","urlParsed","hashIsAvailable","warnHashNotAvailable","urlParsedEnhanced","getBaseServer","enforceTrue","assertExportValues","pageFile","explainer","forbiddenDefaultExports","assertDefaultExports","defaultExportName","determinePageIdOld","pageSuffix","getErrorPageId","pageConfigs","errorPageConfigs","errorPageIds","unique","isErrorPageId","_isV1Design","determineFileType","suffix2","getPageFileObject","isRelevant","isRendererFilePath","isAncestorDefaultPage","fileType","isDefaultFilePath","defaultPageFilePath","defaultPageDir","filePathSegment","SIDE_EXPORTS_TOLERATE","SIDE_EXPORTS_DO_NOT_CHECK","assertPlusFileExport","isValid","exportNamesValid","exportDefault","exportNamed","exportNamesInvalid","e","exportInvalid","parsePageConfigsSerialized","pageConfigsSerialized","pageConfigGlobalSerialized","pageConfigSerialized","configValues","parseConfigValuesSerialized","assertRouteConfigValue","pageConfigGlobal","configValueType","configDefinedAt","configValuesSerialized","configValueSeriliazed","valueSerialized","common","valueSerializedElement","sideExports","parseValueSerialized","addSideExports","sideExport","getDefinedAtFile","definedAtFile","exportValues","exportValue","parseVirtualFileExportsGlobalEntry","virtualFileExportsGlobalEntry","assertPageConfigsSerialized","assertPageConfigGlobalSerialized","pageFilesMap","parseGlobResult","globValue","loadModule","moduleExports","globObject","globFiles","resolveGlobalConfigPublicPage","pageConfigGlobalValues","pageConfigValues","pageConfigPublic_","resolvePageConfigPublic","pageConfigPublic","getPublicCopy","page","route","configInternal","resolveConfigPublic_V1Design","resolvePageContextConfig","pageFiles","config","configEntries","exportsAll","getExportValues","isFromDefaultExport","source","sources","pageExports","exports","values","_fileType","_isFromDefaultExport","pageContextAddendum","resolveGlobalContextConfig","resolveGlobalConfigPublic","getConfigValues","globalConfigPublicBase_","globalConfigPublicBase","pages","addSrc","src","addLegacy","configValueFilePathToShowToUser","getConfigValueFilePathToShowToUser","defaultExportValue","createGlobalContextShared","addGlobalContext","addGlobalContextTmp","addGlobalContextAsync","previousCreateGlobalContextPromise","createGlobalContextBase","isNewGlobalContext","globalContextAdded","globalContextAddedAsync","onCreateGlobalContextHooks","getHookFromPageConfigGlobalCumulative","hooksCalled","hooksAreEqual","execHookGlobal","allPageIds","getAllPageIds","globalContextAddendum","fileIds","isDefaultPageFile","allPageIds2","hooks1","hooks2","hooksFn1","hooksFn2","globalContextInitialPromise","globalContextInitialPromiseResolve","getGlobalContextClientInternalShared","globalContextPromise","setVirtualFileExportsGlobalEntry","deduceRouteStringFromFilesystemPath","filesystemRoots","fsBase","filesystemRoot","filesystemRoute","urlRoot","debugInfo","resolveRouteFunction","routeFunction","routeFunctionFilePath","result","execHookDirectSync","assertSyncRouting","precedence","assertRouteParams","routeParams","warnDeprecatedAllowKey","allowKey","loadPageRoutes","loadPageRoutesSync","onBeforeRouteHook","getGlobalHooks","getPageRoutes","pageRoutes","pageRoute","definedAtString","routeFilesystem","routeString","definedAtLocation","getHookFromPageConfigGlobal","onBeforeRoute","dirname","paths","dirPath","getGlobalContextClientInternal","createPageContextClientSide","urlOriginal","findPageConfig","loadAndParseVirtualFilePageEntry","isDev","moduleId","moduleExportsPromise","virtualFileExportsPageEntry","parseVirtualFileExportsPageEntry","errStamp","loadPageConfigsLazyClientSide","pageFilesClientSide","pageConfigLoaded","isFetchError","isErrorFetchingStaticAssets","skipLink","linkTag","isSamePageHashLink","isNewTabLink","isLinkIgnored","hasBaseServer","isVikeLink","isDisableAutomaticLinkInterception","rel","isSameAsCurrentUrl","getExportNames","analyzeExports","pageFilesServerSide","isHtmlOnly","isClientRouting","assertClientSideRenderHook","hasClientSideRenderHook","determineClientEntry","clientEntries","clientDependencies","clientEntry","getVikeClientEntry","analyzePageClientSide","removeOverriddenPageFiles","analyzePageClientSideInit","sharedPageFilesAlreadyLoaded","pageFilesClientSide_","analyzeClientSide","isClientSideRoutable","isClientRuntimeLoaded","PARAM_TOKEN_NEW","PARAM_TOKEN_OLD","assertRouteString","errPrefix2","highlight","resolveRouteString","segments","parseRouteString","routeRegexStrInner","segment","routeRegex","routeRegexMatch","segmentsValue","globIdx","hasMultipleGlobs","param","pushStatic","segmentLast","isParam","getRouteStringParameterList","routeParameterList","analyzeRouteString","countStaticParts","numberOfStaticPartsBeginning","numberOfStaticParts","sum","a","numberOfParams","numberOfGlobs","routeSegment","isStaticRouteString","resolvePrecedence","routeMatches","sortMatches","routeMatch","routeMatch1","routeMatch2","precedence1","precedence2","execHookOnBeforeRoute","pageContextFromOnBeforeRouteHook","getPageContextFromHook","deprecatedReturn","pageContextAddendumHook","skipOnBeforeRouteHook","pageContextFromRoute","routeType","winner","getPageContextCurrent","pageContextCurrent","setPageContextCurrent","PAGE_CONTEXT_MAX_AGE_DEFAULT","prefetchSettingTrue","prefetchSettingFalse","prefetchSettingDefault","getPrefetchSettings","prefetchSetting","prefetchStaticAssets","prefetch","attr","n","addLinkPrefetchHandlers","getPageContextPrefetched","getCacheKey","found","isExpired","prefetchAssets","pageContextLink","disableClientRouting","prefetchPageContextFromServerHooks","resultMaxAge","setPageContextPrefetchCache","populatePageContextPrefetchCache","isBrilloutDocpress","getResultMaxAge","prefetchSettings","addLinkPrefetchHandlers_apply","initLinkPrefetchHandlers","addLinkPrefetchHandlers_watch","addLinkPrefetchHandlers_unwatch","prefetchOnEvent","entries","entry","event","urlOfLink","getPageContextLink","execHookOnRenderClient","renderHook","urlToShowToUser","getUrlToShowToUser","pageClientsFilesLoaded","initHistory","getHistoryInfo","enhanceHistoryState","isVikeEnhanced","stateVikeEnhanced","enhance","replaceHistoryState","stateNotEnhanced","timestamp","getTimestamp","scrollPosition","getScrollPosition","triggeredBy","getState","saveScrollPosition","pushHistoryState","overwriteLastHistoryEntry","url_","replaceHistoryStateOriginal","monkeyPatchHistoryAPI","funcName","funcOriginal","stateOriginal","stateEnhanced","onPopStateBegin","previous","isHistoryStateEnhanced","current","setScrollPosition","scrollTarget","hasTextFragment","scrollToTextFragment","setScroll","getUrlHash","scrollToHashOrTop","scrollToTop","hashTarget","scroll","done","autoSaveScrollPosition","scrollRestoration_init","scrollRestoration_enable","scrollRestoration_disable","scrollRestoration_initialRenderIsDone","logErrorClient","firstRenderStartPromise","firstRenderStartPromiseResolve","renderPageClientSide","renderArgs","isBackwardNavigation","doNotRenderIfSamePage","isClientSideNavigation","pageContextInitClient","previousPageContext","isRenderOutdated","setHydrationCanBeAborted","isFirstRender","getIsRenderOutdated","pageContextBeginArgs","renderPageNominal","onError","handleError","getPageContextBegin","hooks","getHookFromPageContextNew","execHookDirect","isClientRoutable","isSamePage","loadPageConfigsLazyClientSideAndExecHook","pageContextAugmented","renderPageView","pageContextPrefetched","pageContextFromClientHooks","handleAbortError","renderErrorPage","errorPageId","urlRedirect","changeUrl","onRenderClientPromise","onRenderClientError","keepScrollPositionPrev","getKeepScrollPositionSetting","keepScrollPositionNext","areKeysEqual","stampFinished","isForErrorPage","log","assertInfo","renderNumber","hydrationCanBeAborted","isRenderCleanup","getRenderCount","hasErr","err_","handleErrorFetchingStaticAssets"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107]}